//Cashius, 10-04-2015, 18:54:19
"use strict";Function.prototype.bind||(Function.prototype.bind=function(a){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var b=Array.prototype.slice.call(arguments,1),c=this,d=function(){},e=function(){return c.apply(this instanceof d&&a?this:a,b.concat(Array.prototype.slice.call(arguments)))};return d.prototype=this.prototype,e.prototype=new d,e}),"function"!=typeof Object.create&&!function(){var a=function(){};Object.create=function(b){if(arguments.length>1)throw Error("Second argument not supported");if(null===b)throw Error("Cannot set a null [[Prototype]]");if("object"!=typeof b)throw TypeError("Argument must be an object");return a.prototype=b,new a}}(),window.requestAnimationFrame||(window.requestAnimationFrame=window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){return window.setTimeout(function(){a()},1e3/60)});var App=App||{};App.MathUtils={rgbToHex:function(a,b,c){return((1<<24)+(a<<16)+(b<<8)+c).toString(16).slice(1)},hexToRgb:function(a,b){var c=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;a=a.replace(c,function(a,b,c,d){return b+b+c+c+d+d});var d=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a);return d?b?(b.r=parseInt(d[1],16),b.g=parseInt(d[2],16),b.b=parseInt(d[3],16),b):{r:parseInt(d[1],16),g:parseInt(d[2],16),b:parseInt(d[3],16)}:null},rgbToHsl:function(a,b,c,d){a/=255,b/=255,c/=255;var e,f,g=Math.max(a,b,c),h=Math.min(a,b,c),i=(g+h)/2;if(g==h)e=f=0;else{var j=g-h;switch(f=i>.5?j/(2-g-h):j/(g+h),g){case a:e=(b-c)/j+(c>b?6:0);break;case b:e=(c-a)/j+2;break;case c:e=(a-b)/j+4}e/=6}return d?(d.h=e,d.s=f,d.l=i,d):{h:e,s:f,l:i}},hslToRgb:function(a,b,c,d){var e=c,f=c,g=c;if(0!==b){var h=.5>c?c*(1+b):c+b-c*b,i=2*c-h;e=this._hueToRgb(i,h,a+1/3),f=this._hueToRgb(i,h,a),g=this._hueToRgb(i,h,a-1/3)}return d?(d.r=255*e,d.g=255*f,d.b=255*g,d):{r:255*e,g:255*f,b:255*g}},rgbToHsv:function(a,b,c,d){a/=255,b/=255,c/=255;var e=Math.max(a,b,c),f=Math.min(a,b,c),g=e-f,h=0===e?0:g/e,i=0;if(e!==f){switch(e){case a:i=(b-c)/g+(c>b?6:0);break;case b:i=(c-a)/g+2;break;case c:i=(a-b)/g+4}i/=6}return d?(d.h=i,d.s=h,d.v=e,d):{h:i,s:h,v:e}},hsvToRgb:function(a,b,c,d){var e=Math.floor(6*a),f=6*a-e,g=c*(1-b),h=c*(1-f*b),i=c*(1-(1-f)*b),j=0,k=0,l=0;switch(e%6){case 0:j=c,k=i,l=g;break;case 1:j=h,k=c,l=g;break;case 2:j=g,k=c,l=i;break;case 3:j=g,k=h,l=c;break;case 4:j=i,k=g,l=c;break;case 5:j=c,k=g,l=h}return d?(d.r=255*j,d.g=255*k,d.b=255*l,d):{r:255*j,g:255*k,b:255*l}},_hueToRgb:function(a,b,c){return 0>c&&(c+=1),c>1&&(c-=1),1/6>c?a+6*(b-a)*c:.5>c?b:2/3>c?a+(b-a)*(2/3-c)*6:a}},App.DateUtils={_daysInMonth:[31,28,31,30,31,30,31,31,30,31,30,31],_monthLabels:["January","February","March","April","May","June","July","August","September","October","November","December"],_dayLabels:["S","M","T","W","T","F","S"],getMonthLabel:function(a){return this._monthLabels[a]},getDayLabels:function(a){for(var b=a;b;)this._dayLabels.push(this._dayLabels.shift()),b--;return this._dayLabels},getMonth:function(a,b){var c=a.getFullYear(),d=a.getMonth(),e=d?d-1:11,f=this.getDaysInMonth(c,d),g=this.getDaysInMonth(c,e),h=new Date(c,d,1).getDay(),i=h>=b?h-b:7+h-b,j=8-i,k=[],l=null,m=0,n=42,o=0,p=0;for(1!==j&&(j=g+1-i,m=1);n>o;o++)j>g&&1===m&&(j=1,m=0),j>f&&0===m&&(j=1,m=1),o%7===0&&(l=new Array(14),k[k.length]=l,p=0),l[p++]=j++,l[p++]=m;return k},getDaysInMonth:function(a,b){return 1!==b||a%400!==0&&a%4!==0?this._daysInMonth[b]:29},getMilitaryTime:function(a){var b=App.StringUtils.pad;return b(a.getHours())+":"+b(a.getMinutes())}},App.Device={TOUCH_SUPPORTED:"ontouchstart"in window||window.navigator.msPointerEnabled&&window.navigator.msMaxTouchPoints>0||window.navigator.pointerEnabled&&window.navigator.maxTouchPoints>0},App.GraphicUtils={drawRect:function(a,b,c,d,e,f,g){a.clear(),a.beginFill(b,c),a.drawRect(d,e,f,g),a.endFill()},drawRects:function(a,b,c,d,e,f){e&&a.clear(),a.beginFill(b,c);for(var g=0,h=d.length;h>g;)a.drawRect(d[g++],d[g++],d[g++],d[g++]);f&&a.endFill()},drawRoundedRect:function(a,b,c,d,e,f,g,h){a.clear(),a.beginFill(b,c),a.drawRoundedRect(d,e,f,g,h),a.endFill()},drawArc:function(a,b,c,d,e,f,g,h,i,j,k,l,m){f-=90,g-=90;var n=f,o=(g-f)/h,p=Math.PI/180,q=n*p,r=c/2,s=d/2,t=b.x,u=b.y,v=0;for(a.clear(),a.lineStyle(k,i,j),a.beginFill(l,m),a.moveTo(t+Math.cos(q)*r,u+Math.sin(q)*s);h>v;)n=f+o*v++,q=n*p,a.lineTo(t+Math.cos(q)*r,u+Math.sin(q)*s);for(q=g*p,a.lineTo(t+Math.cos(q)*r,u+Math.sin(q)*s),v=h;v>=0;)n=f+o*v--,q=n*p,a.lineTo(t+Math.cos(q)*(r-e),u+Math.sin(q)*(s-e));a.endFill()}},App.LayoutUtils={update:function(a,b,c){var d=0,e=a.length,f=null,g=c||0,h=App.Direction;if(b===h.X)for(;e>d;)f=a[d++],f.x=g,g=Math.round(g+f.boundingBox.width);else if(b===h.Y)for(;e>d;)f=a[d++],f.y=g,g=Math.round(g+f.boundingBox.height)}},App.StringUtils={_threeCharPattern:/.{1,3}/g,encode:function(a){return encodeURIComponent(a).replace(/[!'()*]/g,function(a){return"%"+a.charCodeAt(0).toString(16)})},pad:function(a){return 10>a?"0"+a:a},formatNumber:function(a,b,c){var d=String(a.toFixed(b)),e=d.split("."),f=e[0],g=f.split("").reverse().join(""),h=g.length>3?g.match(this._threeCharPattern).join(c):g;return h.split("").reverse().join("")+"."+e[1]}},App.EventType={CHANGE_SCREEN:"CHANGE_SCREEN",CHANGE_TRANSACTION:"CHANGE_TRANSACTION",CHANGE_ACCOUNT:"CHANGE_ACCOUNT",CHANGE_CATEGORY:"CHANGE_CATEGORY",CHANGE_SUB_CATEGORY:"CHANGE_SUB_CATEGORY",CHANGE_CURRENCY_PAIR:"CHANGE_CURRENCY_PAIR",CREATE:"CREATE",CANCEL:"CANCEL",CONFIRM:"CONFIRM",COPY:"COPY",DELETE:"DELETE",START:"START",COMPLETE:"COMPLETE",UPDATE:"UPDATE",PROGRESS:"PROGRESS",ERROR:"ERROR",CHANGE:"change",LAYOUT_UPDATE:"LAYOUT_UPDATE",TICK:"TICK",ADDED:"ADDED",REMOVED:"REMOVED",RESIZE:"resize",MOUSE_ENTER:"mouseenter",MOUSE_LEAVE:"mouseleave",MOUSE_DOWN:"mousedown",MOUSE_UP:"mouseup",MOUSE_MOVE:"mousemove",CLICK:"click",FOCUS:"focus",BLUR:"blur",KEY_PRESS:"keypress",PASTE:"paste",TEXT_INPUT:"textInput",INPUT:"input"},App.ModelName={TICKER:0,EVENT_LISTENER_POOL:1,PAYMENT_METHODS:2,CURRENCY_PAIRS:3,CURRENCY_SYMBOLS:4,SUB_CATEGORIES:5,CATEGORIES:6,ACCOUNTS:7,TRANSACTIONS:8,SETTINGS:9,ICONS:10,CHANGE_SCREEN_DATA_POOL:11,SCREEN_HISTORY:12},App.ViewName={APPLICATION_VIEW:0,HEADER:1,SCREEN_STACK:2,ACCOUNT_BUTTON_POOL:3,CATEGORY_BUTTON_EXPAND_POOL:4,CATEGORY_BUTTON_EDIT_POOL:5,SUB_CATEGORY_BUTTON_POOL:6,TRANSACTION_BUTTON_POOL:7,SKIN:8},App.InteractiveState={OVER:"OVER",OUT:"OUT",DRAGGING:"DRAGGING",SCROLLING:"SCROLLING",SNAPPING:"SNAPPING",SWIPING:"SWIPING"},App.TransitionState={SHOWING:"SHOWING",SHOWN:"SHOWN",HIDING:"HIDING",HIDDEN:"HIDDEN",OPEN:"OPEN",OPENING:"OPENING",CLOSED:"CLOSED",CLOSING:"CLOSING"},App.ScrollPolicy={ON:"ON",OFF:"OFF",AUTO:"AUTO"},App.Direction={X:"x",Y:"y",LEFT:"LEFT",RIGHT:"RIGHT"},App.ScreenName={BACK:-1,ACCOUNT:0,CATEGORY:1,SELECT_TIME:2,EDIT_CATEGORY:3,TRANSACTIONS:4,REPORT:5,ADD_TRANSACTION:6,EDIT:7,CURRENCY_PAIRS:8,EDIT_CURRENCY_RATE:9,CURRENCIES:10,SETTINGS:11,MENU:12},App.HeaderAction={NONE:-1,MENU:1,CANCEL:2,CONFIRM:3,ADD_TRANSACTION:4},App.TransactionType={EXPENSE:1,INCOME:2,toString:function(a){return a===App.TransactionType.INCOME?"Income":"Expense"}},App.ScreenMode={DEFAULT:1,ADD:2,EDIT:3,SELECT:4},App.ScreenTitle={MENU:"Menu",ACCOUNTS:"Accounts",EDIT_ACCOUNT:"Edit Account",ADD_ACCOUNT:"Add Account",SELECT_ACCOUNT:"Select Account",CATEGORIES:"Categories",SELECT_CATEGORY:"Select Category",ADD_CATEGORY:"Add Category",EDIT_CATEGORY:"Edit Category",EDIT_SUB_CATEGORY:"Edit SubCategory",ADD_SUB_CATEGORY:"Add SubCategory",SELECT_TIME:"Select Time & Date",TRANSACTIONS:"Transactions",ADD_TRANSACTION:"Add Transaction",EDIT_TRANSACTION:"Edit Transaction",REPORT:"Report",CURRENCY_RATES:"Currency Rates",SELECT_CURRENCY:"Select Currency",EDIT_CURRENCY_RATE:"Edit Currency Rate",SETTINGS:"Settings"},App.EventLevel={NONE:0,LEVEL_1:1,LEVEL_2:2},App.LifeCycleState={CREATED:1,ACTIVE:2,DELETED:3},App.EventListener=function(a){this.allocated=!1,this.poolIndex=a,this.type=null,this.scope=null,this.handler=null},App.EventListener.prototype.reset=function(){this.allocated=!1,this.type=null,this.scope=null,this.handler=null},App.EventDispatcher=function(a){this._listeners=[],this._listenersPool=a},App.EventDispatcher.prototype.addEventListener=function(a,b,c){if(!this.hasEventListener(a,b,c)){var d=this._listenersPool.allocate();d.type=a,d.scope=b,d.handler=c,this._listeners[this._listeners.length]=d}},App.EventDispatcher.prototype.hasEventListener=function(a,b,c){for(var d=0,e=this._listeners.length,f=null;e>d;)if(f=this._listeners[d++],f.type===a&&f.scope===b&&f.handler===c)return f=null,!0;return f=null,!1},App.EventDispatcher.prototype.removeEventListener=function(a,b,c){for(var d=0,e=this._listeners.length,f=null;e>d;d++)if(f=this._listeners[d],f.type===a&&f.scope===b&&f.handler===c){this._listenersPool.release(f),f.reset(),this._listeners.splice(d,1);break}f=null},App.EventDispatcher.prototype.removeAllListeners=function(){for(var a=0,b=this._listeners.length,c=null;b>a;a++)c=this._listeners[a],this._listenersPool.release(c),c.reset(),this._listeners.splice(a,1);c=null,this._listeners.length=0},App.EventDispatcher.prototype.dispatchEvent=function(a,b){for(var c=0,d=this._listeners.length,e=null;d>c;)e=this._listeners[c++],e&&e.type===a&&e.handler.call(e.scope,b,a);e=null},App.EventDispatcher.prototype.pipe=function(a,b){a.addEventListener(b,this,this._pipeListener)},App.EventDispatcher.prototype.unPipe=function(a,b){a.removeEventListener(b,this,this._pipeListener)},App.EventDispatcher.prototype._pipeListener=function(a,b){this.dispatchEvent(b,a)},App.EventDispatcher.prototype.destroy=function(){this.removeAllListeners(),this._listeners.length=0,this._listeners=null,this._listenersPool=null},App.Rectangle=function(a,b,c,d){this.x=a||0,this.y=b||0,this.width=c||0,this.height=d||0},App.Stack=function(){this._source=[],this._top=0},App.Stack.prototype.push=function(a){this._source[this._top++]=a},App.Stack.prototype.pop=function(){var a=this._source[this._top-1];return a&&(this._source[--this._top]=null),a},App.Stack.prototype.peek=function(a){return a||(a=1),this._source[this._top-a]},App.Stack.prototype.length=function(){return this._top},App.Stack.prototype.clear=function(){this._top=0},App.ChangeScreenData=function(a){this.allocated=!1,this.poolIndex=a,this.screenName=App.ScreenName.ADD_TRANSACTION,this.screenMode=App.ScreenMode.ADD,this.updateData=null,this.headerLeftAction=App.HeaderAction.CANCEL,this.headerRightAction=App.HeaderAction.CONFIRM,this.headerName=App.ScreenTitle.ADD_TRANSACTION,this.backSteps=1,this.updateBackScreen=!1},App.ChangeScreenData.prototype.update=function(a,b,c,d,e,f,g,h){return this.screenName=isNaN(a)?App.ScreenName.ADD_TRANSACTION:a,this.screenMode=b||App.ScreenMode.ADD,this.updateData=c,this.headerLeftAction=d||App.HeaderAction.CANCEL,this.headerRightAction=e||App.HeaderAction.CONFIRM,this.headerName=f||App.ScreenTitle.ADD_TRANSACTION,this.backSteps=g||1,this.updateBackScreen=h,this},App.ModelLocator={_proxies:{},init:function(a){for(var b=0,c=a.length;c>b;)this._proxies[a[b++]]=a[b++]},addProxy:function(a,b){if(this._proxies[a])throw Error("Proxy "+a+" already exist");this._proxies[a]=b},hasProxy:function(a){return this._proxies[a]},getProxy:function(a){return this._proxies[a]}},App.ObjectPool=function(a,b,c){this._objectClass=a,this._size=b,this._constructorData=c,this._items=[],this._freeItems=[]},App.ObjectPool.prototype.preAllocate=function(){var a=this._items.length,b=a+this._size,c=a;for(this._items.length=b;b>c;c++)this._items[c]=new this._objectClass(c,this._constructorData),this._freeItems.push(c)},App.ObjectPool.prototype.allocate=function(){0===this._freeItems.length&&this.preAllocate();var a=this._freeItems.shift(),b=this._items[a];return b.allocated=!0,b},App.ObjectPool.prototype.release=function(a){a.allocated=!1,this._freeItems.push(a.poolIndex)},App.Collection=function(a,b,c,d){if(App.EventDispatcher.call(this,d),a){var e=0,f=a.length;for(this._items=new Array(f);f>e;e++)this._items[e]=new b(a[e],this,c,d)}this._items||(this._items=[]),this._currentItem=null,this._currentIndex=-1},App.Collection.prototype=Object.create(App.EventDispatcher.prototype),App.Collection.prototype.addItem=function(a){this._items[this._items.length]=a,this.dispatchEvent(App.EventType.ADDED,a)},App.Collection.prototype.setCurrent=function(a,b){(a!==this._currentItem||b)&&(this._currentItem=a,this._updateCurrentIndex(),this.dispatchEvent(App.EventType.CHANGE))},App.Collection.prototype.getCurrent=function(){return this._currentItem},App.Collection.prototype.getItemAt=function(a){return this._items[a]},App.Collection.prototype.copySource=function(){return this._items.concat()},App.Collection.prototype.filter=function(a,b){if(a){var c=0,d=this._items.length,e=[];if(b)for(;d>c;c++)a.indexOf(this._items[c][b])>-1&&e.push(this._items[c]);else for(;d>c;c++)a.indexOf(this._items[c])>-1&&e.push(this._items[c]);return e}return this._items},App.Collection.prototype.find=function(a,b){for(var c=0,d=this._items.length;d>c;c++)if(this._items[c][a]===b)return this._items[c];return null},App.Collection.prototype.previous=function(){var a=this._currentIndex;return-1===a&&(a=0),0>=a?a=this._items.length-1:a-=1,this._items[a]},App.Collection.prototype.next=function(){var a=this._currentIndex;return-1===a||a>=this._items.length-1?a=0:a+=1,this._items[a]},App.Collection.prototype.other=function(a){var b=this._items.length;return this._items[this._currentIndex+b+a]%b},App.Collection.prototype.hasItem=function(a){return this.indexOf(a)>-1},App.Collection.prototype.removeItem=function(a){return this.removeItemAt(this.indexOf(a))},App.Collection.prototype.removeItemAt=function(a){var b=this._items.splice(a,1)[0];return this._updateCurrentIndex(),-1===this._currentIndex&&(this._currentItem=null),this.dispatchEvent(App.EventType.REMOVED,b),b},App.Collection.prototype._updateCurrentIndex=function(){this._currentIndex=this.indexOf(this._currentItem)},App.Collection.prototype.indexOf=function(a){for(var b=8,c=0,d=Math.floor(this._items.length/b)*b;d>c;){if(this._items[c++]===a)return c-1;if(this._items[c++]===a)return c-1;if(this._items[c++]===a)return c-1;if(this._items[c++]===a)return c-1;if(this._items[c++]===a)return c-1;if(this._items[c++]===a)return c-1;if(this._items[c++]===a)return c-1;if(this._items[c++]===a)return c-1}for(d=this._items.length;d>c;)if(this._items[c++]===a)return c-1;return-1},App.Collection.prototype.index=function(){return this._currentIndex},App.Collection.prototype.length=function(){return this._items.length},App.Settings=function(a){this._data=a,this._startOfWeek=a[0],this.baseCurrency=a[1]||"USD",this.defaultCurrencyQuote=a[2]||"USD",this._defaultAccount=null,this._defaultCategory=null,this._defaultSubCategory=null,this._defaultPaymentMethod=null},Object.defineProperty(App.Settings.prototype,"startOfWeek",{get:function(){return this._startOfWeek},set:function(a){a>=0&&6>=a&&(this.startOfWeek=a)}}),Object.defineProperty(App.Settings.prototype,"defaultAccount",{get:function(){return this._defaultAccount||(this._defaultAccount=this._data?App.ModelLocator.getProxy(App.ModelName.ACCOUNTS).find("id",this._data[3]):App.ModelLocator.getProxy(App.ModelName.ACCOUNTS).getItemAt(0)),this._defaultAccount},set:function(a){this._defaultAccount=a}}),Object.defineProperty(App.Settings.prototype,"defaultCategory",{get:function(){return this._defaultCategory||(this._defaultCategory=this._data?App.ModelLocator.getProxy(App.ModelName.CATEGORIES).find("id",this._data[4]):App.ModelLocator.getProxy(App.ModelName.CATEGORIES).getItemAt(0)),this._defaultCategory},set:function(a){this._defaultCategory=a}}),Object.defineProperty(App.Settings.prototype,"defaultSubCategory",{get:function(){return this._defaultSubCategory||(this._defaultSubCategory=this._data?App.ModelLocator.getProxy(App.ModelName.SUB_CATEGORIES).find("id",this._data[5]):App.ModelLocator.getProxy(App.ModelName.SUB_CATEGORIES).getItemAt(0)),this._defaultSubCategory},set:function(a){this._defaultSubCategory=a}}),Object.defineProperty(App.Settings.prototype,"defaultPaymentMethod",{get:function(){return this._defaultPaymentMethod||(this._defaultPaymentMethod=this._data?App.ModelLocator.getProxy(App.ModelName.PAYMENT_METHODS).find("id",this._data[6]):App.ModelLocator.getProxy(App.ModelName.PAYMENT_METHODS).getItemAt(0)),this._defaultPaymentMethod},set:function(a){this._defaultPaymentMethod=a}}),App.PaymentMethod=function(a){this.id=App.PaymentMethod._ID++,this.name=a},App.PaymentMethod._ID=1,App.PaymentMethod.CASH="Cash",App.PaymentMethod.CREDIT_CARD="Credit-Card",App.CurrencyPair=function(a){this.id=a[0],this.base=a[1],this.symbol=a[2],this.rate=a[3]},App.CurrencyPairCollection=function(a,b){App.Collection.call(this,a,App.CurrencyPair,null,b)},App.CurrencyPairCollection.prototype=Object.create(App.Collection.prototype),App.CurrencyPairCollection.prototype.findRate=function(a,b){for(var c=null,d=null,e=null,f=0,g=this._items.length;g>f;)if(c=this._items[f++],a===c.base&&b===c.symbol||a===c.symbol&&b===c.base){if(a===c.base&&b===c.symbol)return c.rate;if(a===c.symbol&&b===c.base)return 1/c.rate}for(f=0;g>f;)c=this._items[f++],"EUR"===c.base&&(c.symbol===a&&(d=c),c.symbol===b&&(e=c));return d&&e?e.rate/d.rate:1},App.CurrencySymbol=function(a){this.symbol=a},App.Transaction=function(a){a?(this._data=a,this.amount=a[0],this.type=a[1],this.pending=1===a[2],this.repeat=1===a[3],this._account=null,this._category=null,this._subCategory=null,this._method=null,this._date=null,this._currencyBase=null,this._currencyQuote=null,this.note=a[8]?decodeURI(a[8]):""):(this._data=null,this.amount="",this.type=App.TransactionType.EXPENSE,this.pending=!1,this.repeat=!1,this._account=null,this._category=null,this._subCategory=null,this._method=null,this._date=null,this._currencyBase=null,this._currencyQuote=null,this.note="")},App.Transaction.prototype.destroy=function(){this._account=null,this._category=null,this._subCategory=null,this._method=null,this._date=null},App.Transaction.prototype.isSaved=function(){return this._data},App.Transaction.prototype.save=function(){this._data=this.serialize()},App.Transaction.prototype.revokeState=function(){this._data&&(this.amount=this._data[0],this.type=this._data[1],this.pending=1===this._data[2],this.repeat=1===this._data[3],this._account=null,this._category=null,this._subCategory=null,this._method=null,this._date=null,this._currencyBase=null,this._currencyQuote=null,this.note=this._data[8]?decodeURI(data[8]):"")},App.Transaction.prototype.serialize=function(){var a=this.currencyBase,b=this.currencyQuote,c=a===b?b:a+"/"+b+"@"+App.ModelLocator.getProxy(App.ModelName.CURRENCY_PAIRS).findRate(a,b),d=[parseFloat(this.amount),this.type,this.pending?1:0,this.repeat?1:0,this.account.id+"."+this.category.id+"."+this.subCategory.id,this.method.id,this.date.getTime(),c];return this.note&&this.note.length&&d.push(App.StringUtils.encode(this.note)),d},App.Transaction.prototype.copy=function a(){var a=new App.Transaction;return a.amount=this.amount,a.type=this.type,a.pending=this.pending,a.repeat=this.repeat,a.account=this.account,a.category=this.category,a.subCategory=this.subCategory,a.method=this.method,a.date=this.date,a.currencyBase=this.currencyBase,a.currencyQuote=this.currencyQuote,a.note=this.note,a},Object.defineProperty(App.Transaction.prototype,"savedAmount",{get:function(){return this._data?this._data[0]:0}}),Object.defineProperty(App.Transaction.prototype,"savedType",{get:function(){return this._data?this._data[1]:1}}),Object.defineProperty(App.Transaction.prototype,"savedPending",{get:function(){return this._data?1===this._data[2]:!1}}),Object.defineProperty(App.Transaction.prototype,"savedSubCategory",{get:function(){return App.ModelLocator.getProxy(App.ModelName.SUB_CATEGORIES).find("id",this._data[4].split(".")[2])}}),Object.defineProperty(App.Transaction.prototype,"savedCurrencyBase",{get:function(){return-1===this._data[7].indexOf("@")?this._data[7]:this._data[7].split("@")[0].split("/")[0]}}),Object.defineProperty(App.Transaction.prototype,"savedCurrencyQuote",{get:function(){return-1===this._data[7].indexOf("@")?this._data[7]:this._data[7].split("@")[0].split("/")[1]}}),Object.defineProperty(App.Transaction.prototype,"savedCurrencyRate",{get:function(){return-1===this._data[7].indexOf("@")?null:parseFloat(this._data[7].split("@")[1])}}),Object.defineProperty(App.Transaction.prototype,"account",{get:function(){return this._account||(this._account=this._data?App.ModelLocator.getProxy(App.ModelName.ACCOUNTS).find("id",this._data[4].split(".")[0]):App.ModelLocator.getProxy(App.ModelName.SETTINGS).defaultAccount),this._account},set:function(a){this._account=a}}),Object.defineProperty(App.Transaction.prototype,"category",{get:function(){if(!this._category)if(this._data){var a=App.ModelLocator,b=App.ModelName,c=this._data[4].split(".");this._category=a.getProxy(b.CATEGORIES).find("id",c[1]),this._subCategory=a.getProxy(b.SUB_CATEGORIES).find("id",c[2])}else this._category=App.ModelLocator.getProxy(App.ModelName.SETTINGS).defaultCategory,this._subCategory=App.ModelLocator.getProxy(App.ModelName.SETTINGS).defaultSubCategory;return this._category},set:function(a){this._category=a}}),Object.defineProperty(App.Transaction.prototype,"subCategory",{get:function(){return this._subCategory||(this._subCategory=this._data?this.savedSubCategory:App.ModelLocator.getProxy(App.ModelName.SETTINGS).defaultSubCategory),this._subCategory},set:function(a){this._subCategory=a}}),Object.defineProperty(App.Transaction.prototype,"method",{get:function(){return this._method||(this._method=this._data?App.ModelLocator.getProxy(App.ModelName.PAYMENT_METHODS).find("id",this._data[5]):App.ModelLocator.getProxy(App.ModelName.SETTINGS).defaultPaymentMethod),this._method},set:function(a){this._method=a}}),Object.defineProperty(App.Transaction.prototype,"date",{get:function(){return this._date||(this._date=this._data?new Date(this._data[6]):new Date),this._date},set:function(a){this._date=a}}),Object.defineProperty(App.Transaction.prototype,"currencyBase",{get:function(){return this._currencyBase||(this._currencyBase=this._data?this.savedCurrencyBase:App.ModelLocator.getProxy(App.ModelName.SETTINGS).baseCurrency),this._currencyBase},set:function(a){this._currencyBase=a}}),Object.defineProperty(App.Transaction.prototype,"currencyQuote",{get:function(){return this._currencyQuote||(this._currencyQuote=this._data?this.savedCurrencyQuote:App.ModelLocator.getProxy(App.ModelName.SETTINGS).defaultCurrencyQuote),this._currencyQuote},set:function(a){this._currencyQuote=a}}),App.SubCategory=function(a){a?(parseInt(a[0],10)>=App.SubCategory._UID&&(App.SubCategory._UID=parseInt(a[0],10)),this.id=a[0],this.name=a[1],this.category=a[2],this.balance=isNaN(a[3])?0:parseFloat(a[3])):(this.id=String(++App.SubCategory._UID),this.name="SubCategory"+this.id,this.category=null,this.balance=0),this._state=null},App.SubCategory._UID=0,App.SubCategory.prototype.saveState=function(){this._state||(this._state=this.name)},App.SubCategory.prototype.revokeState=function(){this._state&&(this.name=this._state)},App.SubCategory.prototype.clearSavedState=function(){this._state=null},App.Category=function(a){a?(this._data=a,parseInt(a[0],10)>=App.Category._UID&&(App.Category._UID=parseInt(a[0],10)),this.id=a[0],this.name=a[1],this.color=a[2],this.icon=a[3],this.account=a[4],this.budget=a[6],this._subCategories=null):(this._data=null,this.id=String(++App.Category._UID),this.name="Category"+this.id,this.color=null,this.icon=null,this.account=null,this.budget=null,this._subCategories=null),this.balance=0,this._states=null},App.Category._UID=0,App.Category.prototype.destroy=function(){for(var a=0,b=this._subCategories.length;b>a;)this._subCategories[a++]=null;if(this._subCategories.length=0,this._subCategories=null,this._states&&this._states.length){for(a=0,b=this._states.length;b>a;)this._states[a++]=null;this._states.length=0,this._states=null}this._data=null},App.Category.prototype.calculateBalance=function(){var a=(this.subCategories,0),b=this._subCategories.length;for(this.balance=0;b>a;)this.balance+=this._subCategories[a++].balance;return this.balance},App.Category.prototype.addSubCategory=function(a){if(this._subCategories){for(var b=0,c=this._subCategories.length;c>b;)if(this._subCategories[b++]===a)return;this._subCategories.push(a)}else this._subCategories=[a]},App.Category.prototype.removeSubCategory=function(a){for(var b=0,c=this._subCategories.length;c>b;b++)if(this._subCategories[b]===a){this._subCategories.splice(b,1);break}},App.Category.prototype.serialize=function(){for(var a=(this.subCategories,""),b=0,c=this._subCategories.length;c>b;)a+=this._subCategories[b++].id+",";return a=a.substring(0,a.length-1),[this.id,this.name,this.color,this.icon,this.account,a,this.budget]},App.Category.prototype.saveState=function(){this._states||(this._states=[]),this._states[this._states.length]=this.serialize()},App.Category.prototype.revokeState=function(){if(this._states&&this._states.length){var a=this._states.pop();this.name=a[1],this.color=a[2],this.icon=a[3],this.account=a[4],this.budget=a[6],this._inflateSubCategories(a[5])}},App.Category.prototype.clearSavedStates=function(){this._states&&(this._states.length=0);for(var a=0,b=this._subCategories.length;b>a;)this._subCategories[a++].clearSavedState()},App.Category.prototype._inflateSubCategories=function(a){this._subCategories=App.ModelLocator.getProxy(App.ModelName.SUB_CATEGORIES).filter(a.split(","),"id")},Object.defineProperty(App.Category.prototype,"subCategories",{get:function(){if(!this._subCategories)if(this._data)this._inflateSubCategories(this._data[5]);else{var a=new App.SubCategory;a.category=this.id,this._subCategories=[a]}return this._subCategories}}),App.Account=function(a){a?(this._data=a,parseInt(a[0],10)>=App.Account._UID&&(App.Account._UID=parseInt(a[0],10)),this.id=this._data[0],this.name=this._data[1],this._categories=null):(this._data=null,this.id=String(++App.Account._UID),this.name="Account"+this.id,this._categories=null),this.balance=0,this.lifeCycleState=App.LifeCycleState.CREATED},App.Account._UID=0,App.Account.prototype.addCategory=function(a){this._categories?this._categories.push(a):this._categories=[a]},App.Account.prototype.removeCategory=function(a){for(var b=0,c=this._categories.length;c>b;b++)if(this._categories[b]===a){this._categories.splice(b,1);break}},App.Account.prototype.calculateBalance=function(){var a=(this.categories,0),b=this._categories.length;for(this.balance=0;b>a;)this.balance+=this._categories[a++].calculateBalance();return this.balance},Object.defineProperty(App.Account.prototype,"categories",{get:function(){return this._categories||(this._categories=this._data?App.ModelLocator.getProxy(App.ModelName.CATEGORIES).filter(this._data[2].split(","),"id"):[]),this._categories}}),App.Filter=function(a,b,c){this.startDate=a,this.endDate=b,this.categories=c},App.ViewLocator={_viewSegments:{},init:function(a){for(var b=0,c=a.length;c>b;)this._viewSegments[a[b++]]=a[b++]},addViewSegment:function(a,b){if(this._viewSegments[a])throw Error("View segment "+a+" already exist");return this._viewSegments[a]=b,b},hasViewSegment:function(a){return this._viewSegments[a]},getViewSegment:function(a){return this._viewSegments[a]}},App.ColorTheme={WHITE:16777214,BLUE:3752548,BLUE_DARK:2435908,BLUE_LIGHT:5265787,GREY:15724527,GREY_DARK:13421772,GREY_DARKER:10066329,GREY_LIGHT:16777215,RED:15020051,RED_DARK:10027008,RED_LIGHT:16724736,GREEN:3394611,INPUT_HIGHLIGHT:39423,BLACK:0},App.FontStyle={_pixelRatio:1,_styles:[],init:function(a){return this._pixelRatio=a,this},get:function(a,b,c,d){var e=0,f=this._styles.length,g=null;for(d=d||this.CONDENSED;f>e;)if(g=this._styles[e++],g.fontSize===a&&g.fill===b&&g.fontName===d){if(!c)return g;if(g.align===c)return g}return g={fontSize:a,font:Math.round(a*this._pixelRatio)+"px "+d,fill:b,align:c?c:"left",fontName:d},this._styles.push(g),g},CONDENSED:"HelveticaNeueCond",LIGHT_CONDENSED:"HelveticaNeueLightCond",WHITE:"#ffffff",BLUE:"#394264",BLUE_LIGHT:"#50597B",BLUE_DARK:"#252B44",GREY:"#efefef",GREY_DARK:"#cccccc",GREY_DARKER:"#999999",BLACK_LIGHT:"#333333",RED_DARK:"#990000"},App.Skin=function(a,b){var c=App.ColorTheme,d=PIXI.scaleModes.DEFAULT,e=Math.round(10*b),f=new PIXI.Graphics,g=a-2*e,h=Math.round(40*b),i=App.GraphicUtils.drawRects,j=c.GREY,k=c.GREY_LIGHT,l=c.GREY_DARK;i(f,j,1,[0,0,a,h],!0,!1),i(f,k,1,[e,0,g,1],!1,!1),i(f,l,1,[e,h-1,g,1],!1,!0),this.GREY_40=f.generateTexture(1,d),i(f,c.WHITE,1,[0,0,a,h],!0,!1),i(f,j,1,[e,h-1,g,1],!1,!0),this.WHITE_40=f.generateTexture(1,d),h=Math.round(50*b),i(f,j,1,[0,0,a,h],!0,!1),i(f,k,1,[e,0,g,1],!1,!1),i(f,l,1,[e,h-1,g,1],!1,!0),this.GREY_50=f.generateTexture(1,d),h=Math.round(60*b),i(f,j,1,[0,0,a,h],!0,!1),i(f,k,1,[e,0,g,1],!1,!1),i(f,l,1,[e,h-1,g,1],!1,!0),this.GREY_60=f.generateTexture(1,d),h=Math.round(70*b),i(f,j,1,[0,0,a,h],!0,!1),i(f,k,1,[e,0,g,1],!1,!1),i(f,l,1,[e,h-1,g,1],!1,!0),this.GREY_70=f.generateTexture(1,d),i(f,c.RED,1,[0,0,a,h],!0,!1),i(f,c.RED_LIGHT,1,[e,0,g,1],!1,!1),i(f,c.RED_DARK,1,[e,h-1,g,1],!1,!0),this.RED_70=f.generateTexture(1,d),g=Math.round(40*b),h=g,f.clear(),f.beginFill(c.GREY_DARK,1),f.drawRect(0,0,g,h),f.beginFill(c.GREY,1),f.drawRect(0,h/2,g/2,h/2),f.beginFill(14606046,1),f.drawShape(new PIXI.Polygon([0,0,g,0,g,h,0,0])),f.endFill(),this.GREY_PATTERN=f.generateTexture(1,d),g=a-4*e,h=Math.round(40*b),i(f,j,1,[0,0,a,h],!0,!1),i(f,k,1,[e,0,g,1],!1,!1),i(f,l,1,[e,h-1,g,1],!1,!0),this.NARROW_GREY_40=f.generateTexture(1,d),i(f,c.WHITE,1,[0,0,a,h],!0,!1),i(f,j,1,[e,h-1,g,1],!1,!0),this.NARROW_WHITE_40=f.generateTexture(1,d)},App.HeaderSegment=function(a,b,c,d){PIXI.DisplayObjectContainer.call(this),this._action=a,this._width=b,this._height=c,this._pixelRatio=d,this._frontElement=null,this._backElement=null,this._middlePosition=Math.round(15*d),this._needsUpdate=!0,this._mask=new PIXI.Graphics,this.mask=this._mask,this.addChild(this._mask)},App.HeaderSegment.prototype=Object.create(PIXI.DisplayObjectContainer.prototype),App.HeaderSegment.prototype._render=function(){var a=Math.round(10*this._pixelRatio);App.GraphicUtils.drawRect(this._mask,16711680,.5,0,0,this._width,this._height-2*a),this._mask.y=a},App.HeaderSegment.prototype.change=function(a){if(this._action===a)this._needsUpdate=!1;else{var b=this._frontElement;this._frontElement=this._backElement,this._backElement=b,this._needsUpdate=!0}this._action=a},App.HeaderSegment.prototype.update=function(a){this._needsUpdate&&(this._frontElement.y=Math.round((this._middlePosition+this._frontElement.height)*a-this._frontElement.height),this._backElement.y=Math.round(this._middlePosition+(this._height-this._middlePosition)*a))},App.HeaderSegment.prototype.getAction=function(){return this._action},App.HeaderIcon=function(a,b,c,d){App.HeaderSegment.call(this,a,b,c,d),this._frontElement=PIXI.Sprite.fromFrame(this._getIconByAction(a)),this._backElement=PIXI.Sprite.fromFrame(this._getIconByAction(a)),this._iconResizeRatio=Math.round(20*d)/this._frontElement.height,this._render(),this.addChild(this._frontElement),this.addChild(this._backElement)},App.HeaderIcon.prototype=Object.create(App.HeaderSegment.prototype),App.HeaderIcon.prototype._render=function(){App.HeaderSegment.prototype._render.call(this);var a=App.ColorTheme;this._frontElement.scale.x=this._iconResizeRatio,this._frontElement.scale.y=this._iconResizeRatio,this._frontElement.x=this._middlePosition,this._frontElement.y=this._height,this._frontElement.tint=a.WHITE,this._frontElement.alpha=0,this._backElement.scale.x=this._iconResizeRatio,this._backElement.scale.y=this._iconResizeRatio,this._backElement.x=this._middlePosition,this._backElement.y=this._height,this._backElement.tint=a.WHITE,this._backElement.alpha=0},App.HeaderIcon.prototype._getIconByAction=function(a){var b=App.HeaderAction,c=null;return a===b.MENU?c="menu-app":a===b.CANCEL?c="close-app":a===b.CONFIRM?c="apply-app":a===b.ADD_TRANSACTION&&(c="plus-app"),c
},App.HeaderIcon.prototype.change=function(a){App.HeaderSegment.prototype.change.call(this,a);var b=this._getIconByAction(a);null===b?this._frontElement.alpha=0:(this._frontElement.setTexture(PIXI.TextureCache[b]),this._frontElement.alpha=1)},App.HeaderTitle=function(a,b,c,d,e){App.HeaderSegment.call(this,a,b,c,d),this._frontElement=new PIXI.Text(a,e),this._backElement=new PIXI.Text(a,e),this._render(),this.addChild(this._frontElement),this.addChild(this._backElement)},App.HeaderTitle.prototype=Object.create(App.HeaderSegment.prototype),App.HeaderTitle.prototype._render=function(){App.HeaderSegment.prototype._render.call(this),this._middlePosition=Math.round(18*this._pixelRatio),this._frontElement.x=Math.round((this._width-this._frontElement.width)/2),this._frontElement.y=this._height,this._frontElement.alpha=0,this._backElement.x=Math.round((this._width-this._backElement.width)/2),this._backElement.y=this._height,this._backElement.alpha=0},App.HeaderTitle.prototype.change=function(a){App.HeaderSegment.prototype.change.call(this,a),this._frontElement.setText(a),this._frontElement.x=Math.round((this._width-this._frontElement.width)/2),this._frontElement.alpha=1},App.Header=function(a){PIXI.Graphics.call(this);var b=App.ModelLocator,c=App.ModelName,d=App.HeaderIcon,e=App.HeaderAction,f=App.FontStyle,g=a.pixelRatio,h=b.getProxy(c.EVENT_LISTENER_POOL);this._layout=a,this._iconSize=Math.round(50*g),this._leftIcon=new d(e.ADD_TRANSACTION,this._iconSize,this._iconSize,g),this._rightIcon=new d(e.MENU,this._iconSize,this._iconSize,g),this._title=new App.HeaderTitle("Cashius",this._layout.width-2*this._iconSize,this._iconSize,g,f.get(20,f.WHITE)),this._ticker=b.getProxy(c.TICKER),this._tween=new App.TweenProxy(.7,App.Easing.outExpo,0,h),this._eventDispatcher=new App.EventDispatcher(h),this._actionEnabled=!0,this._render(),this.addChild(this._leftIcon),this.addChild(this._title),this.addChild(this._rightIcon),this._registerEventListeners()},App.Header.prototype=Object.create(PIXI.Graphics.prototype),App.Header.prototype._render=function(){var a=App.GraphicUtils,b=App.ColorTheme,c=this._layout.pixelRatio,d=this._layout.width,e=this._layout.headerHeight,f=e-this._iconSize,g=Math.round(10*c);this._title.x=this._iconSize,this._rightIcon.x=d-this._iconSize,a.drawRects(this,b.BLUE,1,[0,0,d,e],!0,!1),a.drawRects(this,b.BLUE_LIGHT,1,[this._iconSize+1,f+g,1,this._iconSize-2*g,d-this._iconSize,f+g,1,this._iconSize-2*g],!1,!1),a.drawRects(this,b.BLUE_DARK,1,[0,e-1,d,1,this._iconSize,f+g,1,this._iconSize-2*g,d-this._iconSize-1,f+g,1,this._iconSize-2*g],!1,!0)},App.Header.prototype._registerEventListeners=function(){var a=App.EventType;App.ViewLocator.getViewSegment(App.ViewName.SCREEN_STACK).addEventListener(a.CHANGE,this,this._onScreenChange),App.Device.TOUCH_SUPPORTED?this.tap=this._onClick:this.click=this._onClick,this._tween.addEventListener(a.COMPLETE,this,this._onTweenComplete),this.interactive=!0},App.Header.prototype.enableActions=function(){this._actionEnabled=!0},App.Header.prototype.disableActions=function(){this._actionEnabled=!1},App.Header.prototype._onScreenChange=function(){this._ticker.addEventListener(App.EventType.TICK,this,this._onTick),this._tween.restart()},App.Header.prototype.change=function(a,b,c){this._leftIcon.change(a),this._title.change(c),this._rightIcon.change(b)},App.Header.prototype._onTick=function(){this._onTweenUpdate()},App.Header.prototype._onTweenUpdate=function(){var a=this._tween.progress;this._leftIcon.update(a),this._title.update(a),this._rightIcon.update(a)},App.Header.prototype._onTweenComplete=function(){this._ticker.removeEventListener(App.EventType.TICK,this,this._onTick),this._onTweenUpdate()},App.Header.prototype._onClick=function(a){if(this._actionEnabled){var b=a.getLocalPosition(this).x,c=App.HeaderAction,d=c.NONE;b<=this._iconSize?d=this._leftIcon.getAction():b>=this._layout.width-this._iconSize&&(d=this._rightIcon.getAction()),d!==c.NONE&&this._eventDispatcher.dispatchEvent(App.EventType.CLICK,d)}},App.Header.prototype.addEventListener=function(a,b,c){this._eventDispatcher.addEventListener(a,b,c)},App.Header.prototype.removeEventListener=function(a,b,c){this._eventDispatcher.removeEventListener(a,b,c)},App.ScrollIndicator=function(a,b){PIXI.Graphics.call(this),this.visible=!1,this.boundingBox=new PIXI.Rectangle(0,0,0,0),this._direction=a,this._pixelRatio=b,this._minIndicatorSize=Math.round(50*b),this._padding=Math.round(4*b),this._size=0,this._indicatorSize=0,this._indicatorThickness=0,this._contentPosition=0,this._positionStep=0,this._showHideTween=new App.TweenProxy(.2,App.Easing.linear,0,App.ModelLocator.getProxy(App.ModelName.EVENT_LISTENER_POOL)),this._state=App.TransitionState.HIDDEN},App.ScrollIndicator.prototype=Object.create(PIXI.Graphics.prototype),App.ScrollIndicator.prototype.show=function(){var a=App.TransitionState;(this._state===a.HIDING||this._state===a.HIDDEN)&&(this._state=a.SHOWING,this.visible=!0,this._showHideTween.start(!0))},App.ScrollIndicator.prototype.hide=function(a){var b=App.TransitionState;a?(this._state=b.HIDDEN,this.alpha=0,this.visible=!1):(this._state===b.SHOWING||this._state===b.SHOWN)&&(this._state=b.HIDING,this._showHideTween.start(!0))},App.ScrollIndicator.prototype.update=function(a){this._contentPosition=a;var b=App.TransitionState;(this._state===b.SHOWING||this._state===b.HIDING)&&this._updateVisibility(b),this._render()},App.ScrollIndicator.prototype._updateVisibility=function(a){var b=this._showHideTween.progress;this._state===a.SHOWING?(this.alpha=b,1===b&&(this._state=a.SHOWN)):this._state===a.HIDING&&(this.alpha=1-b,1===b&&(this._state=a.HIDDEN,this.visible=!1))},App.ScrollIndicator.prototype.resize=function(a,b){this._size=a,this._direction===App.Direction.X?(this.boundingBox.width=this._size,this.boundingBox.height=Math.round(7*this._pixelRatio),this._indicatorThickness=this.boundingBox.height-this._padding,this._indicatorSize=Math.round(this._size*(this._size/b)),this._indicatorSize<this._minIndicatorSize&&(this._indicatorSize=this._minIndicatorSize),this._positionStep=(this._size-this._indicatorSize)/(b-this._size)):this._direction===App.Direction.Y&&(this.boundingBox.width=Math.round(7*this._pixelRatio),this.boundingBox.height=this._size,this._indicatorThickness=this.boundingBox.width-this._padding,this._indicatorSize=Math.round(this._size*(this._size/b)),this._indicatorSize<this._minIndicatorSize&&(this._indicatorSize=this._minIndicatorSize),this._positionStep=(this._size-this._indicatorSize)/(b-this._size)),this._render()},App.ScrollIndicator.prototype._render=function(){var a=this._indicatorSize,b=-Math.round(this._contentPosition*this._positionStep);b+a>this._size?a=this._size-b:0>b&&(a+=b,b=0),this.clear(),this.beginFill(0,.3),this._direction===App.Direction.X?this.drawRoundedRect(b+this._padding,Math.round(.5*this._padding),a-2*this._padding,this._indicatorThickness,.5*this._indicatorThickness):this._direction===App.Direction.Y&&this.drawRoundedRect(Math.round(.5*this._padding),b+this._padding,this._indicatorThickness,a-2*this._padding,.5*this._indicatorThickness),this.endFill()},App.ScrollIndicator.prototype.destroy=function(){this._showHideTween.destroy(),this._showHideTween=null,this.boundingBox=null,this._direction=null,this._state=null,this.clear()},App.Input=function(a,b,c,d,e,f){PIXI.Graphics.call(this);var g=App.FontStyle;this.boundingBox=new App.Rectangle(0,0,c,d),this._fontSize=b,this._width=c,this._height=d,this._pixelRatio=e,this._enabled=!1,this._focused=!1,this._eventDispatcher=new App.EventDispatcher(App.ModelLocator.getProxy(App.ModelName.EVENT_LISTENER_POOL)),this._placeholder=a,this._placeholderStyle=g.get(b,g.GREY),this._currentStyle=this._placeholderStyle,this._textStyle=g.get(b,g.BLUE),this._restrictPattern=null,this._text="",this._textField=new PIXI.Text(this._placeholder,this._currentStyle),this._inputProxy=document.getElementById("textInputProxy"),this._inputProxyListeners={focus:this._onFocus.bind(this),blur:this._onBlur.bind(this),change:this._onChange.bind(this)},f&&(this._icon=PIXI.Sprite.fromFrame("clear-app")),this._iconHitThreshold=Math.round(this._width-40*this._pixelRatio),this._render(),this.addChild(this._textField),this._icon&&this.addChild(this._icon)},App.Input.prototype=Object.create(PIXI.Graphics.prototype),App.Input.prototype._render=function(){var a=this._pixelRatio;this._renderBackground(!1,a),this._textField.x=Math.round(10*a),this._textField.y=Math.round((this._height-this._textField.height)/2+a),this._icon&&(this._icon.width=Math.round(20*a),this._icon.height=Math.round(20*a),this._icon.x=Math.round(this._width-this._icon.width-10*a),this._icon.y=Math.round((this._height-this._icon.height)/2),this._icon.tint=14540253)},App.Input.prototype._renderBackground=function(a,b){var c=App.ColorTheme;this.clear(),this.beginFill(a?c.INPUT_HIGHLIGHT:c.GREY_DARK),this.drawRoundedRect(0,0,this._width,this._height,Math.round(5*b)),this.beginFill(16777215),this.drawRoundedRect(Math.round(b),Math.round(b),this._width-Math.round(2*b),this._height-Math.round(2*b),Math.round(4*b)),this.endFill()},App.Input.prototype.enable=function(){this._enabled||(this._enabled=!0,this._registerEventListeners(),this.interactive=!0)},App.Input.prototype.disable=function(){this._unRegisterEventListeners(),this._unRegisterProxyEventListeners(),this.interactive=!1,this._enabled=!1},App.Input.prototype.restrict=function(a){this._restrictPattern=a},App.Input.prototype.isFocused=function(){return this._focused},App.Input.prototype.focus=function(){this._focused||(this._renderBackground(!0,this._pixelRatio),this._registerProxyEventListeners(),this._inputProxy.focus(),this._focused=!0)},App.Input.prototype.blur=function(){this._inputProxy.blur(),this._unRegisterProxyEventListeners(),this._focused=!1},App.Input.prototype.addEventListener=function(a,b,c){this._eventDispatcher.addEventListener(a,b,c)},App.Input.prototype.removeEventListener=function(a,b,c){this._eventDispatcher.removeEventListener(a,b,c)},App.Input.prototype._registerEventListeners=function(){App.Device.TOUCH_SUPPORTED?this.tap=this._onClick:this.click=this._onClick},App.Input.prototype._unRegisterEventListeners=function(){App.Device.TOUCH_SUPPORTED?this.tap=null:this.click=null},App.Input.prototype._registerProxyEventListeners=function(){var a=App.EventType;this._inputProxy.addEventListener(a.FOCUS,this._inputProxyListeners.focus,!1),this._inputProxy.addEventListener(a.BLUR,this._inputProxyListeners.blur,!1),this._inputProxy.addEventListener(a.CHANGE,this._inputProxyListeners.change,!1),this._inputProxy.addEventListener(a.KEY_PRESS,this._inputProxyListeners.change,!1),this._inputProxy.addEventListener(a.PASTE,this._inputProxyListeners.change,!1),this._inputProxy.addEventListener(a.TEXT_INPUT,this._inputProxyListeners.change,!1),this._inputProxy.addEventListener(a.INPUT,this._inputProxyListeners.change,!1)},App.Input.prototype._unRegisterProxyEventListeners=function(){var a=App.EventType;this._inputProxy.removeEventListener(a.FOCUS,this._inputProxyListeners.focus,!1),this._inputProxy.removeEventListener(a.BLUR,this._inputProxyListeners.blur,!1),this._inputProxy.removeEventListener(a.CHANGE,this._inputProxyListeners.change,!1),this._inputProxy.removeEventListener(a.KEY_PRESS,this._inputProxyListeners.change,!1),this._inputProxy.removeEventListener(a.PASTE,this._inputProxyListeners.change,!1),this._inputProxy.removeEventListener(a.TEXT_INPUT,this._inputProxyListeners.change,!1),this._inputProxy.removeEventListener(a.INPUT,this._inputProxyListeners.change,!1)},App.Input.prototype._onClick=function(a){this._inputProxy!==document.activeElement&&this.focus(),this._icon&&a.getLocalPosition(this).x>=this._iconHitThreshold&&(this._inputProxy.value="",this._onChange())},App.Input.prototype._onFocus=function(){var a=this._pixelRatio,b=this.toLocal(new PIXI.Point(this.x,this.y),this.stage);this._focused=!0,this._inputProxy.style.display="none",this._inputProxy.style.left=Math.round((this.x-b.x)/a)+"px",this._inputProxy.style.top=Math.round((this.y-b.y)/a)+"px",this._inputProxy.style.width=this._icon?Math.round(this._iconHitThreshold/a)+"px":Math.round(this._width/a)+"px",this._inputProxy.style.height=Math.round(this._height/a)+"px",this._inputProxy.style.fontSize=this._fontSize+"px",this._inputProxy.style.lineHeight=this._fontSize+"px",this._inputProxy.value=this._text,this._inputProxy.style.display="block",this._eventDispatcher.dispatchEvent(App.EventType.FOCUS)},App.Input.prototype._onBlur=function(){this._focused=!1,this._updateText(!0),this._inputProxy.style.top="-1000px",this._inputProxy.value="",this._renderBackground(!1,this._pixelRatio),this._unRegisterProxyEventListeners(),this._eventDispatcher.dispatchEvent(App.EventType.BLUR)},App.Input.prototype._onChange=function(a){this._updateText(!1),a&&13===a.keyCode&&this._inputProxy.blur()},App.Input.prototype._updateText=function(a){this._text=this._format(a),this._text===this._placeholder||0===this._text.length?(this._currentStyle===this._textStyle&&(this._currentStyle=this._placeholderStyle,this._textField.setStyle(this._currentStyle)),this._textField.setText(this._placeholder)):(this._currentStyle===this._placeholderStyle&&(this._currentStyle=this._textStyle,this._textField.setStyle(this._currentStyle)),this._textField.setText(this._text))},App.Input.prototype._format=function(){if(this._restrictPattern){var a=this._inputProxy.value.match(this._restrictPattern);this._inputProxy.value=a&&a.length>0?a[0]:""}return this._inputProxy.value},App.Input.prototype.setValue=function(a){this._inputProxy.value=a,this._updateText(!1)},App.Input.prototype.getValue=function(){return this._text},App.Input.prototype.setPlaceholder=function(a){this._placeholder=a,this._updateText(!1)},App.Input.prototype.hitTest=function(a){return a>=this.y&&a<this.y+this.boundingBox.height},App.TimeInput=function(a,b,c,d,e,f){App.Input.call(this,a,b,c,d,e,f),this._inputProxy=document.getElementById("timeInputProxy")},App.TimeInput.prototype=Object.create(App.Input.prototype),App.TimeInput.prototype._render=function(){var a=this._pixelRatio;this._renderBackground(!1,a),this._updateAlignment(),this._textField.y=Math.round(9*a)},App.TimeInput.prototype._updateText=function(a){App.Input.prototype._updateText.call(this,a),this._updateAlignment()},App.TimeInput.prototype._format=function(a){if(0===this._inputProxy.value.length)return"";var b=this._inputProxy.value.replace(/\D/g,""),c=b.substr(0,2),d=b.substr(2,2);return 2===c.length&&parseInt(c,10)>24?c="24":1===d.length&&parseInt(d,10)>5?d="5":d.length>=2&&parseInt(d,10)>59&&(d="59"),a&&(1===c.length&&(c="0"+c),0===d.length?d+="00":1===d.length&&(d+="0")),b=d.length>0?c+":"+d:c,this._inputProxy.value=b,b},App.TimeInput.prototype._updateAlignment=function(){this._textField.x=Math.round((this._width-this._textField.width)/2)},App.Button=function(a,b){PIXI.Graphics.call(this),this.boundingBox=new App.Rectangle(0,0,b.width,b.height),this._pixelRatio=b.pixelRatio,this._label=a,this._style=b.style,this._backgroundColor=b.backgroundColor,this._labelField=new PIXI.Text(a,this._style),this._render(),this.addChild(this._labelField)},App.Button.prototype=Object.create(PIXI.Graphics.prototype),App.Button.prototype._render=function(){var a=this.boundingBox.width,b=this.boundingBox.height;App.GraphicUtils.drawRoundedRect(this,this._backgroundColor,1,0,0,a,b,Math.round(5*this._pixelRatio)),this._labelField.x=Math.round((a-this._labelField.width)/2),this._labelField.y=Math.round((b-this._labelField.height)/2)},App.Button.prototype.resize=function(a,b){this.boundingBox.width=a||this.boundingBox.width,this.boundingBox.height=b||this.boundingBox.height,this._render()},App.Button.prototype.hitTest=function(a){return a.x>=this.x&&a.x<this.x+this.boundingBox.width&&a.y>=this.y&&a.y<this.y+this.boundingBox.height},App.CalendarWeekRow=function(a,b,c,d){PIXI.Graphics.call(this);var e=7,f=PIXI.Text,g=0,h=0;for(this.boundingBox=new App.Rectangle(0,0,c,Math.round(40*d)),this._week=null,this._width=c,this._pixelRatio=d,this._textStyle=a,this._selectedStyle=b,this._dateFields=new Array(7),this._selectedDayIndex=-1,this._highlightBackground=new PIXI.Graphics;e>h;h++,g+=2)this._dateFields[h]=new f("",this._textStyle);for(this.addChild(this._highlightBackground),h=0;e>h;)this.addChild(this._dateFields[h++])},App.CalendarWeekRow.prototype=Object.create(PIXI.Graphics.prototype),App.CalendarWeekRow.prototype._render=function(){var a=App.ColorTheme,b=this._week.length/2,c=Math.round(this._width/b),d=this.boundingBox.height,e=null,f=-1,g=-1,h=0,i=0;for(this.clear(),this.beginFill(a.GREY_LIGHT),this.drawRect(0,0,this._width,d),this.beginFill(a.GREY);b>i;i++,h+=2)e=this._dateFields[i],e.x=Math.round(i*c+(c-e.width)/2+1),e.y=Math.round((d-e.height)/2+1),this._week[h+1]?-1===f&&(f=i):(-1===g&&f>-1&&(g=i),i&&this.drawRect(Math.round(i*c),0,1,d));f>-1&&this.drawRect(f?f*c:0,0,-1===g?this._width:g*c,d),this.endFill(),App.GraphicUtils.drawRect(this._highlightBackground,a.BLUE,1,0,0,c-1,d),this._highlightBackground.alpha=0},App.CalendarWeekRow.prototype._getDayByDate=function(a){for(var b=0,c=0,d=this._week.length/2,e=-1;d>c;c++,b+=2)if(e=this._week[b],e===a)return{day:e,otherMonth:this._week[b+1],index:c};return null},App.CalendarWeekRow.prototype.getDayByPosition=function(a){for(var b=0,c=0,d=this._week.length/2,e=Math.round(this._width/d);d>c;c++,b+=2)if(a>=c*e&&c*e+e>=a)return{day:this._week[b],otherMonth:this._week[b+1],index:c};return null},App.CalendarWeekRow.prototype._selectDay=function(a){this._highlightBackground.x=a.index*Math.round(this._width/(this._week.length/2))+Math.round(this._pixelRatio),this._highlightBackground.alpha=1,this._selectedDayIndex>-1&&this._dateFields[this._selectedDayIndex].setStyle(this._textStyle),this._selectedDayIndex=a.index,this._dateFields[this._selectedDayIndex].setStyle(this._selectedStyle)},App.CalendarWeekRow.prototype._deselectDay=function(){this._selectedDayIndex>-1&&(this._dateFields[this._selectedDayIndex].setStyle(this._textStyle),this._selectedDayIndex=-1),this._highlightBackground.alpha=0},App.CalendarWeekRow.prototype.updateSelection=function(a){var b=this._getDayByDate(a);b&&0===b.otherMonth?this._selectDay(b):this._deselectDay()},App.CalendarWeekRow.prototype.change=function(a,b){this._week=a;for(var c=a.length/2,d=null,e=0,f=0;c>f;f++,e+=2)d=this._dateFields[f],d.setText(a[e]),d.setStyle(this._textStyle);this._render(),b>-1&&this.updateSelection(b)},App.Calendar=function(a,b){PIXI.Graphics.call(this);var c={font:"bold "+Math.round(12*b)+"px Arial",fill:"#999999"},d=App.CalendarWeekRow,e=PIXI.Text,f=App.DateUtils,g=App.FontStyle,h=App.ModelLocator.getProxy(App.ModelName.SETTINGS).startOfWeek,i=g.get(14,g.GREY_DARK),j=g.get(14,g.WHITE),k=f.getDayLabels(h),l=k.length,m=6,n=0;for(this.boundingBox=new App.Rectangle(0,0,a),this._date=null,this._selectedDate=null,this._width=a,this._pixelRatio=b,this._weekRowPosition=Math.round(81*b),this._monthField=new PIXI.Text("",g.get(18,g.BLUE)),this._prevButton=PIXI.Sprite.fromFrame("arrow-app"),this._nextButton=PIXI.Sprite.fromFrame("arrow-app"),this._dayLabelFields=new Array(l),this._weekRows=new Array(m),this._separatorContainer=new PIXI.Graphics;l>n;n++)this._dayLabelFields[n]=new e(k[n],c);for(n=0;m>n;n++)this._weekRows[n]=new d(i,j,a,b);for(this._render(),this.addChild(this._monthField),this.addChild(this._prevButton),this.addChild(this._nextButton),n=0;l>n;)this.addChild(this._dayLabelFields[n++]);for(n=0;m>n;)this.addChild(this._weekRows[n++]);this.addChild(this._separatorContainer)},App.Calendar.prototype=Object.create(PIXI.Graphics.prototype),App.Calendar.prototype._render=function(){var a=App.GraphicUtils,b=App.ColorTheme,c=this._pixelRatio,d=this._width,e=Math.round(12*c)/this._prevButton.height,f=Math.round(15*c),g=d-2*f,h=null,i=Math.round(d/this._dayLabelFields.length),j=Math.round(40*c),k=this._weekRows[0],l=k.boundingBox.height,m=this._dayLabelFields.length,n=0;for(this._monthField.y=Math.round((j-this._monthField.height)/2),this._prevButton.scale.x=e,this._prevButton.scale.y=e,this._prevButton.x=Math.round(20*c+this._prevButton.width),this._prevButton.y=Math.round((j-this._prevButton.height)/2+this._prevButton.height),this._prevButton.rotation=Math.PI,this._prevButton.tint=b.BLUE,this._nextButton.scale.x=e,this._nextButton.scale.y=e,this._nextButton.x=Math.round(d-20*c-this._nextButton.width),this._nextButton.y=Math.round((j-this._prevButton.height)/2),this._nextButton.tint=b.BLUE;m>n;n++)h=this._dayLabelFields[n],h.x=Math.round(n*i+(i-h.width)/2),h.y=Math.round(j+c+(j-h.height)/2);for(n=0,m=this._weekRows.length,this._separatorContainer.clear(),this._separatorContainer.beginFill(b.GREY,1);m>n;n++)k=this._weekRows[n],k.y=this._weekRowPosition+n*l,this._separatorContainer.drawRect(0,k.y+l,d,1);this._separatorContainer.endFill(),this.boundingBox.height=k.y+l,a.drawRects(this,b.GREY,1,[0,0,d,this.boundingBox.height],!0,!1),a.drawRects(this,b.GREY_DARK,1,[0,Math.round(80*c),d,1,f,j,g,1],!1,!1),a.drawRects(this,b.GREY_LIGHT,1,[f,j+1,g,1],!1,!0)},App.Calendar.prototype.update=function(a){this._date=a,this._selectedDate?this._selectedDate.setTime(this._date.valueOf()):this._selectedDate=new Date(this._date.valueOf());var b=App.DateUtils.getMonth(this._date,App.ModelLocator.getProxy(App.ModelName.SETTINGS).startOfWeek),c=this._selectedDate.getDate(),d=b.length,e=0;for(e=0;d>e;e++)this._weekRows[e].change(b[e],c);this._updateMonthLabel()},App.Calendar.prototype.getSelectedDate=function(){return this._selectedDate},App.Calendar.prototype._updateMonthLabel=function(){this._monthField.setText(App.DateUtils.getMonthLabel(this._date.getMonth())+" "+this._date.getFullYear()),this._monthField.x=Math.round((this._width-this._monthField.width)/2)},App.Calendar.prototype.onClick=function(){var a=this.stage.getTouchData().getLocalPosition(this),b=a.x,c=a.y;if(c>=this._weekRowPosition)this._selectDay(b,c);else{var d=this._prevButton.x-this._prevButton.width/2-b,e=this._nextButton.x+this._nextButton.width/2-b,f=this._nextButton.y+this._nextButton.height/2-c,g=d*d-f*f,h=e*e-f*f,i=20*this._pixelRatio;Math.sqrt(Math.abs(g))<i?this._changeDate(App.Direction.LEFT,-1):Math.sqrt(Math.abs(h))<i&&this._changeDate(App.Direction.RIGHT,-1)}},App.Calendar.prototype._getWeekByPosition=function(a){for(var b=this._weekRows[0].boundingBox.height,c=null,d=this._weekRows.length,e=0;d>e;)if(c=this._weekRows[e++],c.y<=a&&c.y+b>a)return c;return null},App.Calendar.prototype._selectDay=function(a,b){var c=this._getWeekByPosition(b),d=c.getDayByPosition(a),e=d.day,f=this._weekRows.length,g=0;if(d.otherMonth)e>20?this._changeDate(App.Direction.LEFT,e):this._changeDate(App.Direction.RIGHT,e);else{for(;f>g;)this._weekRows[g++].updateSelection(e);this._selectedDate.setFullYear(this._date.getFullYear(),this._date.getMonth(),e)}},App.Calendar.prototype._changeDate=function(a,b){var c=this._date.getMonth(),d=this._date.getFullYear(),e=11>c?c+1:0,f=e?d:d+1;a===App.Direction.LEFT&&(e=c?c-1:11,f=c?d:d-1),this._date.setFullYear(f,e),b>-1&&this._selectedDate.setFullYear(f,e,b),this._updateMonthLabel();var g=App.DateUtils.getMonth(this._date,App.ModelLocator.getProxy(App.ModelName.SETTINGS).startOfWeek),h=g.length,i=this._selectedDate.getFullYear()===f&&this._selectedDate.getMonth()===e,j=i?this._selectedDate.getDate():-1,k=0;for(k=0;h>k;k++)this._weekRows[k].change(g[k],j)},App.Radio=function(a,b){PIXI.Graphics.call(this),this._selected=b,this._size=Math.round(20*a),this._pixelRatio=a,this._check=new PIXI.Graphics,this.boundingBox=new App.Rectangle(0,0,this._size,this._size),this._render(),this._check.alpha=b?1:0,this.addChild(this._check)},App.Radio.prototype=Object.create(PIXI.Graphics.prototype),App.Radio.prototype._render=function(){var a=App.GraphicUtils.drawArc,b=App.ColorTheme,c=this._size,d=new PIXI.Point(Math.round(c/2),Math.round(c/2));a(this,d,c,c,Math.round(2*this._pixelRatio),0,360,20,0,0,0,b.GREY,1),c-=Math.round(8*this._pixelRatio),a(this._check,d,c,c,Math.round(6*this._pixelRatio),0,360,20,0,0,0,b.BLUE,1)},App.Radio.prototype.select=function(){this._selected=!0,this._check.alpha=1},App.Radio.prototype.deselect=function(){this._selected=!1,this._check.alpha=0},App.Pane=function(a,b,c,d,e,f){PIXI.DisplayObjectContainer.call(this),this.boundingBox=new PIXI.Rectangle(0,0,c,d),this._ticker=App.ModelLocator.getProxy(App.ModelName.TICKER),this._content=null,this._contentHeight=0,this._contentWidth=0,this._contentBoundingBox=new App.Rectangle,this._useMask=f,this.hitArea=this.boundingBox,this._enabled=!1,this._eventsRegistered=!1,this._state=null,this._xOriginalScrollPolicy=a,this._yOriginalScrollPolicy=b,this._xScrollPolicy=a,this._yScrollPolicy=b,this._xScrollIndicator=new App.ScrollIndicator(App.Direction.X,e),this._yScrollIndicator=new App.ScrollIndicator(App.Direction.Y,e),this._mouseData=null,this._oldMouseX=0,this._oldMouseY=0,this._xSpeed=0,this._ySpeed=0,this._xOffset=0,this._yOffset=0,this._friction=.9,this._dumpForce=.5,this._snapForce=.2,this._useMask&&(this._mask=new PIXI.Graphics,this.mask=this._mask,this.addChild(this._mask))},App.Pane.prototype=Object.create(PIXI.DisplayObjectContainer.prototype),App.Pane.prototype.setContent=function(a){this.removeContent(),this._content=a,this._contentHeight=Math.round(this._content.height),this._contentWidth=Math.round(this._content.width),this._contentBoundingBox.width=this._contentWidth,this._contentBoundingBox.height=this._contentHeight,this.addChildAt(this._content,0),this._updateScrollers(),this._useMask&&this._updateMask()},App.Pane.prototype.removeContent=function(){this._content&&this.contains(this._content)&&(this.removeChild(this._content),this._content=null)},App.Pane.prototype.resize=function(a,b){this.boundingBox.width=a||this.boundingBox.width,this.boundingBox.height=b||this.boundingBox.height,this._content&&(this._contentHeight=Math.round(this._content.height),this._contentWidth=Math.round(this._content.width),this._contentBoundingBox.width=this._contentWidth,this._contentBoundingBox.height=this._contentHeight,this._checkPosition(),this._updateScrollers(),this._useMask&&this._updateMask())},App.Pane.prototype.getContentBounds=function(){return this._contentBoundingBox},App.Pane.prototype._updateMask=function(){App.GraphicUtils.drawRect(this._mask,16711680,1,0,0,this.boundingBox.width,this.boundingBox.height)},App.Pane.prototype._updateX=function(a){this._content.x=Math.round(a)},App.Pane.prototype._updateY=function(a){this._content.y=Math.round(a)},App.Pane.prototype.enable=function(){if(!this._enabled){var a=App.ScrollPolicy;(this._xScrollPolicy!==a.OFF||this._yScrollPolicy!==a.OFF)&&this._registerEventListeners(),this.interactive=!0,this._enabled=!0}},App.Pane.prototype.disable=function(){this._unRegisterEventListeners(),this.cancelScroll(),this._checkPosition(),this.interactive=!1,this._enabled=!1},App.Pane.prototype.resetScroll=function(){this._state=null,this._xSpeed=0,this._ySpeed=0,this._content&&(this._updateX(0),this._updateY(0),this._xScrollIndicator.hide(!0),this._yScrollIndicator.hide(!0))},App.Pane.prototype.cancelScroll=function(){this._state=null,this._xSpeed=0,this._ySpeed=0,this._xScrollIndicator.hide(!0),this._yScrollIndicator.hide(!0)},App.Pane.prototype._registerEventListeners=function(){this._eventsRegistered||(this._eventsRegistered=!0,App.Device.TOUCH_SUPPORTED?(this.touchstart=this._onPointerDown,this.touchend=this._onPointerUp,this.touchendoutside=this._onPointerUp,this.touchmove=this._onPointerMove):(this.mousedown=this._onPointerDown,this.mouseup=this._onPointerUp,this.mouseupoutside=this._onPointerUp,this.mousemove=this._onPointerMove),this._ticker.addEventListener(App.EventType.TICK,this,this._onTick))},App.Pane.prototype._unRegisterEventListeners=function(){this._ticker.removeEventListener(App.EventType.TICK,this,this._onTick),App.Device.TOUCH_SUPPORTED?(this.touchstart=null,this.touchend=null,this.touchendoutside=null,this.touchmove=null):(this.mousedown=null,this.mouseup=null,this.mouseupoutside=null,this.mousemove=null),this._eventsRegistered=!1},App.Pane.prototype._onPointerDown=function(a){this._mouseData=a;var b=this._mouseData.getLocalPosition(this.stage);this._xOffset=b.x-this._content.x,this._yOffset=b.y-this._content.y,this._xSpeed=0,this._ySpeed=0,this._state=App.InteractiveState.DRAGGING,this._xScrollPolicy===App.ScrollPolicy.ON&&this._xScrollIndicator.show(),this._yScrollPolicy===App.ScrollPolicy.ON&&this._yScrollIndicator.show()},App.Pane.prototype._onPointerUp=function(){this._isContentPulled()?(this._state=App.InteractiveState.SNAPPING,this._xSpeed=0,this._ySpeed=0):this._state=App.InteractiveState.SCROLLING,this._mouseData=null},App.Pane.prototype._onPointerMove=function(a){this._mouseData=a},App.Pane.prototype._onTick=function(){var a=App.InteractiveState;this._state===a.DRAGGING?this._drag(App.ScrollPolicy):this._state===a.SCROLLING?this._scroll(App.ScrollPolicy,a):this._state===a.SNAPPING&&this._snap(App.ScrollPolicy,a),this._xScrollIndicator.visible&&this._xScrollIndicator.update(this._content.x),this._yScrollIndicator.visible&&this._yScrollIndicator.update(this._content.y)},App.Pane.prototype._drag=function(a){var b=0;if(this.stage){if(this._xScrollPolicy===a.ON){var c=this.boundingBox.width,d=this._mouseData.getLocalPosition(this.stage).x,e=this._content.x,f=e+this._contentWidth,g=e-this._contentWidth;if(-1e4>=d)return;e>0?(b=(1-e/c)*this._dumpForce,this._updateX(d*b-this._xOffset*b)):c>f?(b=f/c*this._dumpForce,this._updateX(g-(c-d)*b+(this._contentWidth-this._xOffset)*b)):this._updateX(d-this._xOffset),this._xSpeed=d-this._oldMouseX,this._oldMouseX=d}if(this._yScrollPolicy===a.ON){var h=this.boundingBox.height,i=this._mouseData.getLocalPosition(this.stage).y,j=this._content.y,k=j+this._contentHeight,l=h-this._contentHeight;if(-1e4>=i)return;j>0?(b=(1-j/h)*this._dumpForce,this._updateY(i*b-this._yOffset*b)):h>k?(b=k/h*this._dumpForce,this._updateY(l-(h-i)*b+(this._contentHeight-this._yOffset)*b)):this._updateY(i-this._yOffset),this._ySpeed=i-this._oldMouseY,this._oldMouseY=i}}},App.Pane.prototype._scroll=function(a,b){if(this._xScrollPolicy===a.ON){this._updateX(this._content.x+this._xSpeed);var c=this.boundingBox.width,d=this._content.x,e=d+this._contentWidth;d>0?this._xSpeed*=(1-d/c)*this._dumpForce:c>e&&(this._xSpeed*=e/c*this._dumpForce),Math.abs(this._xSpeed)<.1?(this._xSpeed=0,this._state=null,this._xScrollIndicator.hide(),(d>0||c>e)&&(this._state=b.SNAPPING)):this._xSpeed*=this._friction}if(this._yScrollPolicy===a.ON){this._updateY(this._content.y+this._ySpeed);var f=this.boundingBox.height,g=this._content.y,h=g+this._contentHeight;g>0?this._ySpeed*=(1-g/f)*this._dumpForce:f>h&&(this._ySpeed*=h/f*this._dumpForce),Math.abs(this._ySpeed)<.1?(this._ySpeed=0,this._state=null,this._yScrollIndicator.hide(),(g>0||f>h)&&(this._state=b.SNAPPING)):this._ySpeed*=this._friction}},App.Pane.prototype._snap=function(a){if(this._xScrollPolicy===a.ON){var b=this.boundingBox.width,c=this._content.x,d=c+this._contentWidth,e=c-this._contentWidth,f=c*this._snapForce;c>0?5>f?(this._state=null,this._updateX(0),this._xScrollIndicator.hide()):this._updateX(f):b>d&&(f=e+(c-e)*this._snapForce,f>=b-5?(this._state=null,this._updateX(e),this._xScrollIndicator.hide()):this._updateX(f))}if(this._yScrollPolicy===a.ON){var g=this.boundingBox.height,h=this._content.y,i=h+this._contentHeight,j=g-this._contentHeight;h>0?(f=h*this._snapForce,5>f?(this._state=null,this._updateY(0),this._yScrollIndicator.hide()):this._updateY(f)):g>i&&(f=j+(h-j)*this._snapForce,f>=j-5?(this._state=null,this._updateY(j),this._yScrollIndicator.hide()):this._updateY(f))}},App.Pane.prototype._isContentPulled=function(){if(this._contentHeight>this.boundingBox.height){if(this._content.y>0)return!0;if(this._content.y+this._contentHeight<this.boundingBox.height)return!0}if(this._contentWidth>this.boundingBox.width){if(this._content.x>0)return!0;if(this._content.x+this._contentWidth<this.boundingBox.width)return!0}return!1},App.Pane.prototype._updateScrollers=function(){var a=App.ScrollPolicy,b=this.boundingBox.width,c=this.boundingBox.height;
this._xOriginalScrollPolicy===a.AUTO&&(this._contentWidth>=b?(this._xScrollPolicy=a.ON,this._xScrollIndicator.resize(b,this._contentWidth),this._xScrollIndicator.x=c-this._xScrollIndicator.boundingBox.height,this.contains(this._xScrollIndicator)||this.addChild(this._xScrollIndicator)):(this._xScrollPolicy=a.OFF,this._xScrollIndicator.hide(),this.contains(this._xScrollIndicator)&&this.removeChild(this._xScrollIndicator))),this._yOriginalScrollPolicy===a.AUTO&&(this._contentHeight>=c?(this._yScrollPolicy=a.ON,this._yScrollIndicator.resize(c,this._contentHeight),this._yScrollIndicator.x=b-this._yScrollIndicator.boundingBox.width,this.contains(this._yScrollIndicator)||this.addChild(this._yScrollIndicator)):(this._yScrollPolicy=a.OFF,this._yScrollIndicator.hide(),this.contains(this._yScrollIndicator)&&this.removeChild(this._yScrollIndicator))),this._xScrollPolicy===a.OFF&&this._yScrollPolicy===a.OFF?this._unRegisterEventListeners():this._registerEventListeners()},App.Pane.prototype._checkPosition=function(){var a=this.boundingBox.width,b=this.boundingBox.height;this._contentWidth>a?this._content.x>0?this._updateX(0):this._content.x+this._contentWidth<a&&this._updateX(a-this._contentWidth):this._contentWidth<=a&&0!==this._content.x&&this._updateX(0),this._contentHeight>b?this._content.y>0?this._updateY(0):this._content.y+this._contentHeight<b&&this._updateY(b-this._contentHeight):this._contentHeight<=b&&0!==this._content.y&&this._updateY(0)},App.InfiniteList=function(a,b,c,d,e,f){PIXI.DisplayObjectContainer.call(this);var g=App.Direction,h=new b(0,a[0],f),i=c===g.X?h.boundingBox.width:h.boundingBox.height,j=c===g.X?Math.ceil(d/i)+1:Math.ceil(e/i)+1,k=a.length-1,l=0,m=0;for(this.boundingBox=new PIXI.Rectangle(0,0,d,e),this.hitArea=this.boundingBox,this._ticker=App.ModelLocator.getProxy(App.ModelName.TICKER),this._model=a,this._itemClass=b,this._direction=c,this._width=d,this._height=e,this._pixelRatio=f,this._items=new Array(j),this._itemSize=i,this._selectedModelIndex=-1,this._enabled=!1,this._state=null,this._mouseData=null,this._virtualPosition=0,this._oldMousePosition=0,this._speed=0,this._offset=0,this._friction=.9;j>m;m++,l++)l>k&&(l=0),m>0&&(h=new b(l,a[l],f)),this._items[m]=h,this.addChild(h);this._updateLayout(!1)},App.InfiniteList.prototype=Object.create(PIXI.DisplayObjectContainer.prototype),App.InfiniteList.prototype.enable=function(){this._enabled||(this._enabled=!0,this._registerEventListeners(),this.interactive=!0)},App.InfiniteList.prototype.disable=function(){this.interactive=!1,this._unRegisterEventListeners(),this._enabled=!1},App.InfiniteList.prototype.selectItemByPosition=function(a){var b=0,c=this._items.length,d=this._itemSize,e=this._direction===App.Direction.X?"x":"y",f=null,g=0;for(this._selectedModelIndex=-1;c>b;)if(f=this._items[b++],g=f[e],a>=g&&g+d>a){this._selectedModelIndex=f.getModelIndex();break}for(b=0;c>b;)this._items[b++].select(this._selectedModelIndex);return f},App.InfiniteList.prototype.selectItemByValue=function(a){var b=0,c=this._model.length;for(this._selectedModelIndex=-1;c>b;b++)if(this._model[b]===a){this._selectedModelIndex=b;break}for(c=this._items.length,b=0;c>b;)this._items[b++].select(this._selectedModelIndex)},App.InfiniteList.prototype.getSelectedValue=function(){return this._model[this._selectedModelIndex]},App.InfiniteList.prototype.cancelScroll=function(){this._speed=0,this._state=null},App.InfiniteList.prototype._registerEventListeners=function(){App.Device.TOUCH_SUPPORTED?(this.touchstart=this._onPointerDown,this.touchend=this._onPointerUp,this.touchendoutside=this._onPointerUp):(this.mousedown=this._onPointerDown,this.mouseup=this._onPointerUp,this.mouseupoutside=this._onPointerUp),this._ticker.addEventListener(App.EventType.TICK,this,this._onTick)},App.InfiniteList.prototype._unRegisterEventListeners=function(){this._ticker.removeEventListener(App.EventType.TICK,this,this._onTick),App.Device.TOUCH_SUPPORTED?(this.touchstart=null,this.touchend=null,this.touchendoutside=null):(this.mousedown=null,this.mouseup=null,this.mouseupoutside=null)},App.InfiniteList.prototype._onTick=function(){var a=App.InteractiveState;this._state===a.DRAGGING?this._drag(App.Direction):this._state===a.SCROLLING&&this._scroll(App.Direction)},App.InfiniteList.prototype._onPointerDown=function(a){this._mouseData=a;var b=this._mouseData.getLocalPosition(this.stage).x;this._direction===App.Direction.Y&&(b=this._mouseData.getLocalPosition(this.stage).y),this._offset=b-this._virtualPosition,this._speed=0,this._state=App.InteractiveState.DRAGGING},App.InfiniteList.prototype._onPointerUp=function(){this._state=App.InteractiveState.SCROLLING,this._mouseData=null},App.InfiniteList.prototype._drag=function(a){if(this.stage){if(this._direction===a.X){var b=this._mouseData.getLocalPosition(this.stage).x;if(-1e4>=b)return;this._updateX(b-this._offset)}else if(this._direction===a.Y){if(b=this._mouseData.getLocalPosition(this.stage).y,-1e4>=b)return;this._updateY(b-this._offset)}this._speed=b-this._oldMousePosition,this._oldMousePosition=b}},App.InfiniteList.prototype._scroll=function(a){this._direction===a.X?this._updateX(this._virtualPosition+this._speed):this._direction===a.Y&&this._updateY(this._virtualPosition+this._speed),Math.abs(this._speed)<.1?(this._speed=0,this._state=null):this._speed*=this._friction},App.InfiniteList.prototype._updateX=function(a){a=Math.round(a);var b=0,c=this._items.length,d=this._itemSize,e=this._width,f=a-this._virtualPosition,g=0,h=Math.floor(a/d),i=0,j=0,k=this._model.length,l=0,m=null;for(this._virtualPosition=a;c>b;)m=this._items[b++],l=m.x+f,(0>l+d||l>e)&&(g=-Math.floor(l/e),l+=g*c*d,i=Math.floor(l/d),j=h>=0?(i-h%k)%k:(i-h)%k,0>j?j=k+j:j>=k&&(j=k-1),m.setModel(j,this._model[j],this._selectedModelIndex)),m.x=l},App.InfiniteList.prototype._updateY=function(a){a=Math.round(a);var b=0,c=this._items.length,d=this._itemSize,e=this._height,f=a-this._virtualPosition,g=0,h=Math.floor(a/d),i=0,j=0,k=this._model.length,l=0,m=null;for(this._virtualPosition=a;c>b;)m=this._items[b++],l=m.y+f,(0>l+d||l>e)&&(g=-Math.floor(l/e),l+=g*c*d,i=Math.floor(l/d),j=h>=0?(i-h%k)%k:(i-h)%k,0>j?j=k+j:j>=k&&(j=k-1),m.setModel(j,this._model[j],this._selectedModelIndex)),m.y=l},App.InfiniteList.prototype._updateLayout=function(a){var b=0,c=this._items.length,d=null,e=0,f=App.Direction;if(this._direction===f.X){for(;c>b;)d=this._items[b++],d.x=e,e=Math.round(e+d.boundingBox.width);a&&this._updateX(this.x)}else if(this._direction===f.Y){for(;c>b;)d=this._items[b++],d.y=e,e=Math.round(e+d.boundingBox.height);a&&this._updateY(this.y)}},App.InfiniteList.prototype.hitTest=function(a){return a>=this.y&&a<this.y+this.boundingBox.height},App.VirtualList=function(a,b,c,d,e){PIXI.DisplayObjectContainer.call(this);var f=a.allocate(),g=b===App.Direction.X?f.boundingBox.width:f.boundingBox.height;this.boundingBox=new PIXI.Rectangle(0,0,c,d),this._model=null,this._itemPool=a,this._direction=b,this._width=c,this._height=d,this._pixelRatio=e,this._items=[],this._itemSize=g,this._virtualX=0,this._virtualY=0,a.release(f)},App.VirtualList.prototype=Object.create(PIXI.DisplayObjectContainer.prototype),App.VirtualList.prototype.getItemUnderPoint=function(a){var b=a.getLocalPosition(this).x,c=App.Direction,d=0,e=this._items.length,f=0,g=0,h=null;if(this._direction===c.X){for(;e>d;)if(h=this._items[d++],g=h.x,f=h.boundingBox.width,b>=g&&g+f>=b)return h}else if(this._direction===c.Y)for(b=a.getLocalPosition(this).y;e>d;)if(h=this._items[d++],g=h.y,f=h.boundingBox.height,b>=g&&g+f>=b)return h;return null},App.VirtualList.prototype.updateX=function(a){a=Math.round(a);var b=0,c=this._items.length,d=a-this._virtualX,e=Math.floor(a/this._itemSize),f=0,g=0,h=0,i=this._model.length,j=c-2,k=i-c,l=!1,m=!1,n=0,o=null;for(this._virtualX=a;c>b;)o=this._items[b++],n=o.x+d,m=n>this._width&&d>0,l=n+this._itemSize<0&&0>d,(m||l)&&(f=-Math.floor(n/this._width),n+=f*c*this._itemSize,g=Math.floor(n/this._itemSize),h=e>=0?(g-e%i)%i:(g-e)%i,0>h?h=i+h:h>=i&&(h=i-1),l&&h>j||m&&k>h?o.setModel(this._model[h]):n=o.x+d),o.x=n},App.VirtualList.prototype.updateY=function(a){a=Math.round(a);var b=0,c=this._items.length,d=a-this._virtualY,e=Math.floor(a/this._itemSize),f=0,g=0,h=0,i=this._model.length,j=c-2,k=i-c,l=!1,m=!1,n=0,o=null;for(this._virtualY=a;c>b;)o=this._items[b++],n=o.y+d,m=n>this._height&&d>0,l=n+this._itemSize<0&&0>d,(m||l)&&(f=-Math.floor(n/this._height),n+=f*c*this._itemSize,g=Math.floor(n/this._itemSize),h=e>=0?(g-e%i)%i:(g-e)%i,0>h?h=i+h:h>=i&&(h=i-1),l&&h>j||m&&k>h?o.setModel(this._model[h]):n=o.y+d),o.y=n},App.VirtualList.prototype.reset=function(){var a=App.Direction,b=0,c=null,d=0,e=this._items.length;if(this._direction===a.X)for(;e>d;d++)c=this._items[d],c.x=b,c.setModel(this._model[d]),b=Math.round(b+this._itemSize);else if(this._direction===a.Y)for(;e>d;d++)c=this._items[d],c.y=b,c.setModel(this._model[d]),b=Math.round(b+this._itemSize)},App.VirtualList.prototype.update=function(a){this._model=a;var b=App.Direction,c=Math.ceil(this._width/this._itemSize)+1,d=this._model.length*this._itemSize,e=null,f=0,g=this._items.length,h=0;for(this.boundingBox.width=d,this.boundingBox.height=this._height,this._virtualX=0,this._virtualY=0;g>h;h++)this._itemPool.release(this.removeChild(this._items[h])),this._items[h]=null;if(this._items.length=0,this._direction===b.X)for(c>this._model.length&&(c=this._model.length),h=0,g=c;g>h;h++)e=this._itemPool.allocate(),e.x=f,e.setModel(this._model[h]),this._items.push(e),this.addChild(e),f=Math.round(f+this._itemSize);else if(this._direction===b.Y)for(c=Math.ceil(this._height/this._itemSize)+1,this.boundingBox.width=this._width,this.boundingBox.height=d,c>this._model.length&&(c=this._model.length),h=0,g=c;g>h;h++)e=this._itemPool.allocate(),e.y=f,e.setModel(this._model[h]),this._items.push(e),this.addChild(e),f=Math.round(f+this._itemSize)},App.VirtualList.prototype._updateLayout=function(a){var b=0,c=this._items.length,d=null,e=0,f=App.Direction;if(this._direction===f.X){for(;c>b;)d=this._items[b++],d.x=e,e=Math.round(e+this._itemSize);a&&this.updateX(this.x)}else if(this._direction===f.Y){for(;c>b;)d=this._items[b++],d.y=e,e=Math.round(e+this._itemSize);a&&this.updateY(this.y)}},Object.defineProperty(App.VirtualList.prototype,"x",{get:function(){return this._virtualX}}),Object.defineProperty(App.VirtualList.prototype,"y",{get:function(){return this._virtualY}}),App.List=function(a){PIXI.DisplayObjectContainer.call(this),this.boundingBox=new App.Rectangle,this._direction=a,this._items=[]},App.List.prototype=Object.create(PIXI.DisplayObjectContainer.prototype),App.List.prototype.add=function(a,b){return this._items[this._items.length]=a,this.addChild(a),b&&this.updateLayout(),a},App.List.prototype.remove=function(a){this.removeItemAt(this._items.indexOf(a))},App.List.prototype.removeItemAt=function(a){var b=this._items.splice(a,1)[0];return this.removeChild(b),b},App.List.prototype.getItemAt=function(a){return this._items[a]},App.List.prototype.updateLayout=function(){var a=0,b=this._items.length,c=null,d=0,e=App.Direction;if(this._direction===e.X){for(;b>a;)c=this._items[a++],c.x=d,d=Math.round(d+c.boundingBox.width);this.boundingBox.width=d,this.boundingBox.height=c.boundingBox.height}else if(this._direction===e.Y){for(;b>a;)c=this._items[a++],c.y=d,d=Math.round(d+c.boundingBox.height);this.boundingBox.height=d,this.boundingBox.width=c.boundingBox.width}},App.List.prototype.getItemUnderPoint=function(a){var b=a.getLocalPosition(this).x,c="width",d=0,e="x",f=null,g=0,h=this._items.length;for(this._direction===App.Direction.Y&&(b=a.getLocalPosition(this).y,e="y",c="height");h>g;)if(f=this._items[g++],d=f[e],b>=d&&d+f.boundingBox[c]>=b)return f;return null},App.List.prototype.hitTest=function(a){return a>=this.y&&a<this.y+this.boundingBox.height},Object.defineProperty(App.List.prototype,"length",{get:function(){return this._items.length}}),App.TileList=function(a,b){App.List.call(this,a),this._windowSize=b},App.TileList.prototype=Object.create(App.List.prototype),App.TileList.prototype.updateX=function(a){this.x=Math.round(a);for(var b=0,c=this._items.length,d=0,e=0,f=null;c>b;)f=this._items[b++],d=f.boundingBox.width,e=this.x+f.x,f.visible=e+d>0&&e<this._windowSize},App.TileList.prototype.updateY=function(a){this.y=Math.round(a);for(var b=0,c=this._items.length,d=0,e=0,f=null;c>b;)f=this._items[b++],d=f.boundingBox.height,e=this.y+f.y,f.visible=e+d>0&&e<this._windowSize},App.TileList.prototype.updateLayout=function(a){App.List.prototype.updateLayout.call(this),a&&(this._direction===App.Direction.X?this.updateX(this.x):this._direction===App.Direction.Y&&this.updateY(this.y))},App.TilePane=function(a,b,c,d,e,f){App.Pane.call(this,a,b,c,d,e,f)},App.TilePane.prototype=Object.create(App.Pane.prototype),App.TilePane.prototype.setContent=function(a){this.removeContent(),this._content=a,this._contentHeight=Math.round(this._content.boundingBox.height),this._contentWidth=Math.round(this._content.boundingBox.width),this._contentBoundingBox.width=this._contentWidth,this._contentBoundingBox.height=this._contentHeight,this.addChildAt(this._content,0),this._updateScrollers(),this._useMask&&this._updateMask()},App.TilePane.prototype.resize=function(a,b){this.boundingBox.width=a||this.boundingBox.width,this.boundingBox.height=b||this.boundingBox.height,this._content&&(this._contentHeight=Math.round(this._content.boundingBox.height),this._contentWidth=Math.round(this._content.boundingBox.width),this._contentBoundingBox.width=this._contentWidth,this._contentBoundingBox.height=this._contentHeight,this._checkPosition(),this._updateScrollers(),this._useMask&&this._updateMask())},App.TilePane.prototype._updateX=function(a){this._content.updateX(a)},App.TilePane.prototype._updateY=function(a){this._content.updateY(a)},App.ViewStack=function(a,b,c){if(PIXI.DisplayObjectContainer.call(this),this._children=[],this._selectedChild=null,this._selectedIndex=-1,this._childrenToHide=[],this._eventDispatcher=new App.EventDispatcher(c),a)for(var d=0,e=a.length;e>d;)this.add(a[d++],b)},App.ViewStack.prototype=Object.create(PIXI.DisplayObjectContainer.prototype),App.ViewStack.prototype.add=function(a,b){this._children[this._children.length]=a,b&&this.addChild(a)},App.ViewStack.prototype.selectChild=function(a){if(this._selectedChild){if(!a||this._selectedChild===a)return;this._childrenToHide[this._childrenToHide.length]=this._selectedChild}for(var b=0,c=this._children.length;c>b;)if(a===this._children[b++]){this._selectedChild=a,this._selectedIndex=b-1;break}this._eventDispatcher.dispatchEvent(App.EventType.CHANGE)},App.ViewStack.prototype.selectChildByIndex=function(a){if(!(0>a||a>=this._children.length)){if(this._selectedChild){if(this._selectedChild===this._children[a])return;this._childrenToHide[this._childrenToHide.length]=this._selectedChild}this._selectedChild=this._children[a],this._selectedIndex=a,this._eventDispatcher.dispatchEvent(App.EventType.CHANGE)}},App.ViewStack.prototype.getSelectedChild=function(){return this._selectedChild},App.ViewStack.prototype.getSelectedIndex=function(){return this._selectedIndex},App.ViewStack.prototype.getChildByIndex=function(a){return 0>a||a>=this._children.length?null:this._children[a]},App.ViewStack.prototype.show=function(){if(this._selectedChild){for(var a=0,b=this._childrenToHide.length;b>a;a++)if(this._selectedChild===this._childrenToHide[a]){this._selectedChild.removeEventListener(App.EventType.COMPLETE,this,this._onHideComplete),this._childrenToHide.splice(a,1);break}this.contains(this._selectedChild)||this.addChild(this._selectedChild),this._selectedChild.show()}},App.ViewStack.prototype.hide=function(){for(var a=0,b=this._childrenToHide.length,c=null,d=App.EventType;b>a;)c=this._childrenToHide[a++],c.addEventListener(d.COMPLETE,this,this._onHideComplete),c.hide()},App.ViewStack.prototype._onHideComplete=function(a){if(a.state===App.TransitionState.HIDDEN){var b=a.target;b.removeEventListener(App.EventType.COMPLETE,this,this._onHideComplete),this.contains(b)&&this.removeChild(b);for(var c=0,d=this._childrenToHide.length;d>c;c++)if(b===this._childrenToHide[c]){this._childrenToHide.splice(c,1);break}}},App.ViewStack.prototype.addEventListener=function(a,b,c){this._eventDispatcher.addEventListener(a,b,c)},App.ViewStack.prototype.removeEventListener=function(a,b,c){this._eventDispatcher.removeEventListener(a,b,c)},App.ListHeader=function(a,b,c){PIXI.Graphics.call(this),this._width=b,this._pixelRatio=c,this._textField=new PIXI.Text(a,App.FontStyle.get(12,App.FontStyle.GREY_DARKER)),this._render(),this.addChild(this._textField)},App.ListHeader.prototype=Object.create(PIXI.Graphics.prototype),App.ListHeader.prototype._render=function(){var a=App.GraphicUtils,b=App.ColorTheme,c=Math.round(30*this._pixelRatio);a.drawRect(this,b.GREY_DARK,1,0,0,this._width,c),this._textField.x=Math.round((this._width-this._textField.width)/2),this._textField.y=Math.round((c-this._textField.height)/2)},App.AddNewButton=function(a,b,c,d){PIXI.DisplayObjectContainer.call(this),this.boundingBox=new App.Rectangle(0,0,c.width,c.height),this._label=a,this._pixelRatio=d,this._skin=new PIXI.Sprite(c),this._icon=PIXI.Sprite.fromFrame("plus-app"),this._iconResizeRatio=Math.round(20*d)/this._icon.height,this._labelField=new PIXI.Text(a,b),this._render(),this.addChild(this._skin),this.addChild(this._icon),this.addChild(this._labelField)},App.AddNewButton.prototype=Object.create(PIXI.DisplayObjectContainer.prototype),App.AddNewButton.prototype._render=function(){var a=Math.round(10*this._pixelRatio),b=this.boundingBox.height,c=0;this._icon.scale.x=this._iconResizeRatio,this._icon.scale.y=this._iconResizeRatio,c=Math.round((this.boundingBox.width-(this._labelField.width+a+this._icon.width))/2),this._icon.x=c,this._icon.y=Math.round((b-this._icon.height)/2),this._icon.tint=App.ColorTheme.GREY_DARK,this._labelField.x=c+this._icon.width+a,this._labelField.y=Math.round((b-this._labelField.height)/2)},App.SwipeButton=function(a,b){PIXI.DisplayObjectContainer.call(this),this._width=a,this._interactionEnabled=!1,this._interactiveState=null,this._dragFriction=.5,this._snapForce=.5,this._openOffset=b,this._isOpen=!1,this._ticker=App.ModelLocator.getProxy(App.ModelName.TICKER)},App.SwipeButton.prototype=Object.create(PIXI.DisplayObjectContainer.prototype),App.SwipeButton.prototype.disable=function(){this._disableInteraction(),this.close(!0)},App.SwipeButton.prototype._enableInteraction=function(){this._interactionEnabled||(this._interactionEnabled=!0,this._ticker.addEventListener(App.EventType.TICK,this,this._onTick),this.interactive=!0)},App.SwipeButton.prototype._disableInteraction=function(){this.interactive=!1,this._interactiveState=null,this._ticker.removeEventListener(App.EventType.TICK,this,this._onTick),this._interactionEnabled=!1},App.SwipeButton.prototype._onTick=function(){var a=App.InteractiveState;this._interactiveState===a.SWIPING?this._swipe():this._interactiveState===a.SNAPPING&&this._snap()},App.SwipeButton.prototype.swipeStart=function(a){var b=App.Direction,c=App.InteractiveState;this._interactiveState||(this._isOpen||a!==b.LEFT?this._isOpen&&a===b.RIGHT&&(this._interactiveState=c.SNAPPING,this._enableInteraction()):(this._interactiveState=c.SWIPING,this._enableInteraction()))},App.SwipeButton.prototype.swipeEnd=function(){this._interactiveState===App.InteractiveState.SWIPING&&(this._interactiveState=App.InteractiveState.SNAPPING)},App.SwipeButton.prototype._swipe=function(){if(this.stage&&!this._isOpen){var a=this.stage.getTouchPosition().x;if(-1e4>=a)return;this._updateSwipePosition(-Math.round(this._width*(1-a/this._width)*this._dragFriction))}},App.SwipeButton.prototype._snap=function(){var a=this._getSwipePosition(),b=Math.round(a*this._snapForce);a<-this._openOffset?b>=-this._openOffset?(this._isOpen=!0,this._disableInteraction(),this._updateSwipePosition(-this._openOffset)):this._updateSwipePosition(b):b>=-1?(this._isOpen=!1,this._disableInteraction(),this._updateSwipePosition(0)):this._updateSwipePosition(b)},App.SwipeButton.prototype.close=function(a){this._isOpen&&(a?(this._updateSwipePosition(0),this._isOpen=!1):(this._interactiveState=App.InteractiveState.SNAPPING,this._enableInteraction()))},App.SwipeButton.prototype._updateSwipePosition=function(){},App.SwipeButton.prototype._getSwipePosition=function(){},App.ExpandButton=function(a,b,c){PIXI.DisplayObjectContainer.call(this);var d=App.ModelLocator,e=App.ModelName,f=d.getProxy(e.EVENT_LISTENER_POOL);this.boundingBox=new App.Rectangle(0,0,a,b),this._content=null,this._contentHeight=b,this._buttonHeight=b,this._useMask=c,this._updateBoundsInTransition=!1,this._eventsRegistered=!1,this._transitionState=App.TransitionState.CLOSED,this._expandTween=new App.TweenProxy(.4,App.Easing.outExpo,0,f),this._eventDispatcher=new App.EventDispatcher(f),this._ticker=d.getProxy(e.TICKER),this._useMask&&(this._mask=new PIXI.Graphics,this.mask=this._mask,this._updateMask(),this.addChild(this._mask))},App.ExpandButton.prototype=Object.create(PIXI.DisplayObjectContainer.prototype),App.ExpandButton.prototype._setContent=function(a){this._content=a,this._contentHeight=this._content.boundingBox?this._content.boundingBox.height:this._content.height,this._content.visible=!1,this._content.y=this._buttonHeight},App.ExpandButton.prototype._registerEventListeners=function(){this._eventsRegistered||(this._eventsRegistered=!0,this._ticker.addEventListener(App.EventType.TICK,this,this._onTick),this._expandTween.addEventListener(App.EventType.COMPLETE,this,this._onTransitionComplete))},App.ExpandButton.prototype._unRegisterEventListeners=function(){this._expandTween.removeEventListener(App.EventType.COMPLETE,this,this._onTransitionComplete),this._ticker.removeEventListener(App.EventType.TICK,this,this._onTick),this._eventsRegistered=!1},App.ExpandButton.prototype._onTick=function(){this._expandTween.isRunning()&&this._updateTransition()},App.ExpandButton.prototype._updateTransition=function(){this._updateBounds(this._updateBoundsInTransition),this._useMask&&this._updateMask()},App.ExpandButton.prototype._onTransitionComplete=function(){var a=App.TransitionState;this._transitionState===a.OPENING?this._transitionState=a.OPEN:this._transitionState===a.CLOSING&&(this._transitionState=a.CLOSED,this._content.visible=!1),this._unRegisterEventListeners(),this._updateBounds(this._updateBoundsInTransition),this._useMask&&this._updateMask(),this.isInTransition()||(this._updateBoundsInTransition=!1,this._eventDispatcher.dispatchEvent(App.EventType.COMPLETE,this))},App.ExpandButton.prototype._updateBounds=function(a){var b=App.TransitionState;a&&(this._contentHeight=this._content.boundingBox?this._content.boundingBox.height:this._content.height),this._transitionState===b.OPENING?this.boundingBox.height=Math.round(this._buttonHeight+this._contentHeight*this._expandTween.progress):this._transitionState===b.OPEN?this.boundingBox.height=this._buttonHeight+this._contentHeight:this._transitionState===b.CLOSING?this.boundingBox.height=Math.round(this._buttonHeight+this._contentHeight*(1-this._expandTween.progress)):this._transitionState===b.CLOSED&&(this.boundingBox.height=this._buttonHeight)},App.ExpandButton.prototype._updateMask=function(){App.GraphicUtils.drawRect(this._mask,16711680,1,0,0,this.boundingBox.width,this.boundingBox.height)},App.ExpandButton.prototype.onClick=function(){var a=App.TransitionState;this._transitionState===a.CLOSED||this._transitionState===a.CLOSING?this.open():(this._transitionState===a.OPEN||this._transitionState===a.OPENING)&&this.close()},App.ExpandButton.prototype.isOpen=function(){return this._transitionState!==App.TransitionState.CLOSED},App.ExpandButton.prototype.isOpening=function(){return this._transitionState===App.TransitionState.OPENING},App.ExpandButton.prototype.isInTransition=function(){return this._transitionState===App.TransitionState.OPENING||this._transitionState===App.TransitionState.CLOSING},App.ExpandButton.prototype.open=function(a){var b=App.TransitionState;(this._transitionState===b.CLOSED||this._transitionState===b.CLOSING)&&(this._registerEventListeners(),this._content.visible=!0,this._transitionState=b.OPENING,this._updateBoundsInTransition=a,this._expandTween.restart())},App.ExpandButton.prototype.close=function(a,b){var c=App.TransitionState,d=App.EventType;a?(this._transitionState=c.CLOSING,this._updateBoundsInTransition=b,this._expandTween.stop(),this._onTransitionComplete()):this._transitionState===c.OPEN||this._transitionState===c.OPENING?(this._registerEventListeners(),this._transitionState=c.CLOSING,this._updateBoundsInTransition=b,this._expandTween.start(!0)):this._eventDispatcher.dispatchEvent(d.COMPLETE,this)},App.ExpandButton.prototype.addEventListener=function(a,b,c){this._eventDispatcher.addEventListener(a,b,c)},App.ExpandButton.prototype.removeEventListener=function(a,b,c){this._eventDispatcher.removeEventListener(a,b,c)},App.PopUpButton=function(a,b,c){PIXI.DisplayObjectContainer.call(this);var d=App.ModelLocator,e=App.ModelName,f=App.Button,g=PIXI.Graphics,h=App.FontStyle,i=App.ColorTheme,j=c.pixelRatio,k=c.width;this.boundingBox=new App.Rectangle(0,0,k,c.height),this._pixelRatio=j,this._popUpLayout=c.popUpLayout,this._backgroundColor=i.RED,this._transitionState=App.TransitionState.HIDDEN,this._eventsRegistered=App.EventLevel.NONE,this._overlay=this.addChild(new g),this._container=this.addChild(new g),this._popUpBackground=this._container.addChild(new g),this._labelField=this._container.addChild(new PIXI.Text(a,h.get(18,h.WHITE))),this._messageField=this._container.addChild(new PIXI.Text(b,h.get(18,h.BLUE,"center",h.LIGHT_CONDENSED))),this._cancelButton=this._container.addChild(new f("Cancel",{width:k,height:Math.round(50*j),pixelRatio:j,style:h.get(18,h.BLACK_LIGHT,null,h.LIGHT_CONDENSED),backgroundColor:i.GREY_DARK})),this._confirmButton=this._container.addChild(new f("Delete",{width:k,height:Math.round(30*j),pixelRatio:j,style:h.get(16,h.WHITE,null,h.LIGHT_CONDENSED),backgroundColor:i.RED})),this._containerMask=this._container.addChild(new g),this._container.mask=this._containerMask,this._ticker=d.getProxy(e.TICKER),this._eventDispatcher=new App.EventDispatcher(d.getProxy(e.EVENT_LISTENER_POOL)),this._tween=new App.TweenProxy(.3,App.Easing.outExpo,0,d.getProxy(e.EVENT_LISTENER_POOL)),this._updateLayout(0)},App.PopUpButton.prototype=Object.create(PIXI.DisplayObjectContainer.prototype),App.PopUpButton.prototype.setPosition=function(a,b){this.boundingBox.x=a,this.boundingBox.y=b,this.x=a,this.y=b,this._overlay.x=-a,this._overlay.y=-b},App.PopUpButton.prototype.setMessage=function(a){this._messageField.setText(a)},App.PopUpButton.prototype.setPopUpLayout=function(a,b,c,d,e,f){this._popUpLayout.overlayWidth=c||this._popUpLayout.overlayWidth,this._popUpLayout.overlayHeight=d||this._popUpLayout.overlayHeight,this._popUpLayout.width=e||this._popUpLayout.width,this._popUpLayout.height=f||this._popUpLayout.height,this._popUpLayout.x=a||this._popUpLayout.x,this._popUpLayout.y=this._popUpLayout.height/2-this.boundingBox.y-b},App.PopUpButton.prototype.showPopUp=function(){var a=App.TransitionState;(this._transitionState===a.HIDDEN||this._transitionState===a.HIDING)&&(this._registerEventListeners(App.EventLevel.LEVEL_1),this._onShowStart(),this._transitionState=a.SHOWING,this._tween.restart())},App.PopUpButton.prototype.hidePopUp=function(a){var b=App.TransitionState;a?(this._unRegisterEventListeners(App.EventLevel.LEVEL_2),this._transitionState=b.HIDDEN,this._tween.stop(),this._updateLayout(0),this._onHideComplete()):(this._transitionState===b.SHOWN||this._transitionState===b.SHOWING)&&(this._unRegisterEventListeners(App.EventLevel.LEVEL_2),this._transitionState=b.HIDING,this._tween.start(!0))},App.PopUpButton.prototype._registerEventListeners=function(a){var b=App.EventLevel;a===b.LEVEL_1&&this._eventsRegistered!==b.LEVEL_1&&(this._ticker.addEventListener(App.EventType.TICK,this,this._onTick),this._tween.addEventListener(App.EventType.COMPLETE,this,this._onTweenComplete)),a===b.LEVEL_2&&this._eventsRegistered!==b.LEVEL_2&&(App.Device.TOUCH_SUPPORTED?this.tap=this._onClick:this.click=this._onClick,this.interactive=!0),this._eventsRegistered=a},App.PopUpButton.prototype._unRegisterEventListeners=function(a){var b=App.EventLevel;a===b.LEVEL_1&&(this._ticker.removeEventListener(App.EventType.TICK,this,this._onTick),this._tween.removeEventListener(App.EventType.COMPLETE,this,this._onTweenComplete),this._eventsRegistered=b.NONE),a===b.LEVEL_2&&(this.interactive=!1,App.Device.TOUCH_SUPPORTED?this.tap=null:this.click=null,this._eventsRegistered=b.LEVEL_1)},App.PopUpButton.prototype._onClick=function(){var a=this.stage.getTouchData().getLocalPosition(this._container);this._cancelButton.hitTest(a)?this._eventDispatcher.dispatchEvent(App.EventType.CANCEL):this._confirmButton.hitTest(a)&&this._eventDispatcher.dispatchEvent(App.EventType.CONFIRM)},App.PopUpButton.prototype._onTick=function(){if(this._tween.isRunning()){var a=App.TransitionState;this._transitionState===a.SHOWING?this._updateLayout(this._tween.progress):this._transitionState===a.HIDING&&this._updateLayout(1-this._tween.progress)}},App.PopUpButton.prototype._onShowStart=function(){var a=Math.round(10*this._pixelRatio);this._cancelButton.x=a,this._confirmButton.x=a,App.GraphicUtils.drawRect(this._overlay,App.ColorTheme.BLUE,1,0,0,this._popUpLayout.overlayWidth,this._popUpLayout.overlayHeight),this._overlay.alpha=0,this._overlay.visible=!0,this._popUpBackground.alpha=0,this._popUpBackground.visible=!0,this._messageField.alpha=0,this._messageField.visible=!0,this._cancelButton.alpha=0,this._cancelButton.visible=!0,this._confirmButton.alpha=0,this._confirmButton.visible=!0},App.PopUpButton.prototype._updateLayout=function(a){var b=App.GraphicUtils,c=App.ColorTheme,d=this._pixelRatio,e=this.boundingBox.width,f=this.boundingBox.height,g=Math.round(e+(this._popUpLayout.width-e)*a),h=Math.round(f+(this._popUpLayout.height-f)*a),i=Math.round(10*d),j=Math.round(5*d),k=Math.round(g-2*i),l=this._cancelButton.boundingBox.height+this._confirmButton.boundingBox.height+i;b.drawRect(this._containerMask,c.BLACK,1,0,0,g,h),b.drawRoundedRect(this._container,c.RED,1,0,0,g,h,j),b.drawRoundedRect(this._popUpBackground,c.GREY,1,0,0,g,h,j),this._container.x=Math.round(this._popUpLayout.x*a),this._container.y=Math.round(this._popUpLayout.y*a),this._cancelButton.resize(k),this._cancelButton.y=h-l-i,this._confirmButton.resize(k),this._confirmButton.y=this._cancelButton.y+this._cancelButton.boundingBox.height+i,this._labelField.x=Math.round((g-this._labelField.width)/2),this._labelField.y=Math.round((h-this._labelField.height)/2),this._messageField.x=Math.round((g-this._messageField.width)/2),this._messageField.y=Math.round((h-l-i-this._messageField.height)/2),this._overlay.alpha=.8*a,this._popUpBackground.alpha=a,this._messageField.alpha=a,this._cancelButton.alpha=a,this._confirmButton.alpha=a,this._labelField.alpha=1-a},App.PopUpButton.prototype._onTweenComplete=function(){var a=App.TransitionState;this._transitionState===a.SHOWING?(this._transitionState=a.SHOWN,this._registerEventListeners(App.EventLevel.LEVEL_2),this._updateLayout(1)):this._transitionState===a.HIDING&&(this._transitionState=a.HIDDEN,this._updateLayout(0),this._onHideComplete())},App.PopUpButton.prototype._onHideComplete=function(){this._unRegisterEventListeners(App.EventLevel.LEVEL_1),this._overlay.visible=!1,this._popUpBackground.visible=!1,this._messageField.visible=!1,this._cancelButton.visible=!1,this._confirmButton.visible=!1,this._eventDispatcher.dispatchEvent(App.EventType.COMPLETE,{target:this,state:this._transitionState})},App.PopUpButton.prototype.hitTest=function(a){return a>=this.y&&a<this.y+this.boundingBox.height},App.PopUpButton.prototype.addEventListener=function(a,b,c){this._eventDispatcher.addEventListener(a,b,c)},App.PopUpButton.prototype.removeEventListener=function(a,b,c){this._eventDispatcher.removeEventListener(a,b,c)},App.Screen=function(a,b){PIXI.DisplayObjectContainer.call(this);var c=App.ModelLocator,d=App.ModelName,e=a.pixelRatio;
this._model=null,this._layout=a,this._enabled=!1,this._eventsRegistered=App.EventLevel.NONE,this._transitionState=App.TransitionState.HIDDEN,this._interactiveState=null,this._mouseDownPosition=null,this._mouseX=0,this._mouseY=0,this._leftSwipeThreshold=15*e,this._rightSwipeThreshold=5*e,this._clickThreshold=5*e,this._swipeEnabled=!1,this._preferScroll=!0,this._mode=App.ScreenMode.DEFAULT,this._ticker=c.getProxy(d.TICKER),this._eventDispatcher=new App.EventDispatcher(c.getProxy(d.EVENT_LISTENER_POOL)),this._showHideTween=new App.TweenProxy(b,App.Easing.outExpo,0,c.getProxy(d.EVENT_LISTENER_POOL)),this.alpha=0},App.Screen.prototype=Object.create(PIXI.DisplayObjectContainer.prototype),App.Screen.prototype.show=function(){var a=App.TransitionState;(this._transitionState===a.HIDDEN||this._transitionState===a.HIDING)&&(this.enable(),this._transitionState=a.SHOWING,this._showHideTween.restart(),this.visible=!0)},App.Screen.prototype.hide=function(){var a=App.TransitionState;(this._transitionState===a.SHOWN||this._transitionState===a.SHOWING)&&(this.disable(),this._transitionState=a.HIDING,this._showHideTween.start(!0))},App.Screen.prototype.enable=function(){this._enabled||(this._registerEventListeners(App.EventLevel.LEVEL_1),this._enabled=!0)},App.Screen.prototype.disable=function(){this._unRegisterEventListeners(App.EventLevel.LEVEL_2),this._enabled=!1,this._interactiveState=null},App.Screen.prototype.update=function(a,b){this._mode=b},App.Screen.prototype.addEventListener=function(a,b,c){this._eventDispatcher.addEventListener(a,b,c)},App.Screen.prototype.removeEventListener=function(a,b,c){this._eventDispatcher.removeEventListener(a,b,c)},App.Screen.prototype._registerEventListeners=function(a){var b=App.EventLevel;a===b.LEVEL_1&&this._eventsRegistered!==b.LEVEL_1&&(this._ticker.addEventListener(App.EventType.TICK,this,this._onTick),this._showHideTween.addEventListener(App.EventType.COMPLETE,this,this._onTweenComplete)),a===b.LEVEL_2&&this._eventsRegistered!==b.LEVEL_2&&(App.Device.TOUCH_SUPPORTED?(this.touchstart=this._onPointerDown,this.touchend=this._onPointerUp,this.touchendoutside=this._onPointerUp):(this.mousedown=this._onPointerDown,this.mouseup=this._onPointerUp,this.mouseupoutside=this._onPointerUp),App.ViewLocator.getViewSegment(App.ViewName.HEADER).addEventListener(App.EventType.CLICK,this,this._onHeaderClick),this.interactive=!0),this._eventsRegistered=a},App.Screen.prototype._unRegisterEventListeners=function(a){var b=App.EventLevel;a===b.LEVEL_1&&(this._ticker.removeEventListener(App.EventType.TICK,this,this._onTick),this._showHideTween.removeEventListener(App.EventType.COMPLETE,this,this._onTweenComplete),this._eventsRegistered=b.NONE),a===b.LEVEL_2&&(this.interactive=!1,App.ViewLocator.getViewSegment(App.ViewName.HEADER).removeEventListener(App.EventType.CLICK,this,this._onHeaderClick),App.Device.TOUCH_SUPPORTED?(this.touchstart=null,this.touchend=null,this.touchendoutside=null):(this.mousedown=null,this.mouseup=null,this.mouseupoutside=null),this._eventsRegistered=b.LEVEL_1)},App.Screen.prototype._onTick=function(){if(this._showHideTween.isRunning()){var a=App.TransitionState;this._transitionState===a.SHOWING?this.alpha=this._showHideTween.progress:this._transitionState===a.HIDING&&(this.alpha=1-this._showHideTween.progress)}this._swipeEnabled&&this._interactiveState===App.InteractiveState.DRAGGING&&this._drag()},App.Screen.prototype._onTweenComplete=function(){var a=App.TransitionState;this._transitionState===a.SHOWING?(this._transitionState=a.SHOWN,this.alpha=1,this._registerEventListeners(App.EventLevel.LEVEL_2)):this._transitionState===a.HIDING&&(this._transitionState=a.HIDDEN,this._unRegisterEventListeners(App.EventLevel.LEVEL_1),this.alpha=0,this.visible=!1,this._eventDispatcher.dispatchEvent(App.EventType.COMPLETE,{target:this,state:this._transitionState}))},App.Screen.prototype._onPointerDown=function(a){this.stage&&(this._mouseDownPosition=a.getLocalPosition(this.stage),this._mouseX=this._mouseDownPosition.x,this._mouseY=this._mouseDownPosition.y),this._swipeEnabled&&(this._interactiveState=App.InteractiveState.DRAGGING)},App.Screen.prototype._onPointerUp=function(a){if(this._swipeEnabled&&(this._interactiveState===App.InteractiveState.SWIPING&&this._swipeEnd(),this._interactiveState=null),this.stage&&this._mouseDownPosition&&this._enabled){var b=this._mouseDownPosition.x,c=this._mouseDownPosition.y;this._mouseDownPosition=a.getLocalPosition(this.stage,this._mouseDownPosition);var d=b-this._mouseDownPosition.x,e=c-this._mouseDownPosition.y,f=d*d-e*e,g=App.TransitionState;Math.abs(f)<this._clickThreshold&&(this._transitionState===g.SHOWING||this._transitionState===g.SHOWN)&&this._onClick(),this._mouseDownPosition=null}},App.Screen.prototype._drag=function(){var a=App.InteractiveState;if(this._interactiveState===a.DRAGGING&&this.stage&&this._mouseX){var b=this.stage.getTouchPosition(),c=b.x,d=b.y;this._mouseX-c>this._leftSwipeThreshold?(this._interactiveState=a.SWIPING,this._swipeStart(Math.abs(this._mouseY-d)>Math.abs(this._mouseX-c)&&this._preferScroll,App.Direction.LEFT)):c-this._mouseX>this._rightSwipeThreshold&&(this._interactiveState=a.SWIPING,this._swipeStart(Math.abs(this._mouseY-d)>Math.abs(this._mouseX-c)&&this._preferScroll,App.Direction.RIGHT)),this._mouseX=c,this._mouseY=d}},App.Screen.prototype._onClick=function(){this._eventDispatcher.dispatchEvent(App.EventType.CLICK)},App.Screen.prototype._onHeaderClick=function(){},App.Screen.prototype._swipeStart=function(){},App.Screen.prototype._swipeEnd=function(){},App.EditScreen=function(a){App.Screen.call(this,a,.4);var b=a.pixelRatio,c=a.width-Math.round(20*b),d=Math.round(40*b);this._target=null,this._background=this.addChild(new PIXI.Graphics),this._input=this.addChild(new App.Input("",20,c,d,b,!0)),this._deleteButton=new App.PopUpButton("Delete","",{width:c,height:d,pixelRatio:b,popUpLayout:{x:Math.round(10*b),y:0,width:Math.round(c-20*b),height:Math.round(a.height/2),overlayWidth:a.width,overlayHeight:0}}),this._renderAll=!0},App.EditScreen.prototype=Object.create(App.Screen.prototype),App.EditScreen.prototype._render=function(){var a=App.GraphicUtils,b=App.ColorTheme,c=App.ScreenMode,d=this._layout.pixelRatio,e=Math.round(10*d),f=Math.round(60*d),g=this._layout.width-2*e;this._renderAll&&(this._renderAll=!1,this._input.x=e,this._input.y=e,this._deleteButton.setPosition(e,f+e)),this._mode===c.EDIT?(this.contains(this._deleteButton)||this.addChild(this._deleteButton),a.drawRects(this._background,b.GREY,1,[0,0,g+2*e,2*f],!0,!1),a.drawRects(this._background,b.GREY_DARK,1,[e,f-1,g,1],!1,!1),a.drawRects(this._background,b.GREY_LIGHT,1,[e,f,g,1],!1,!0)):this._mode===c.ADD&&(this.contains(this._deleteButton)&&this.removeChild(this._deleteButton),a.drawRect(this._background,b.GREY,1,0,0,g+2*e,f))},App.EditScreen.prototype.hide=function(){this._unRegisterDeleteButtonListeners(),App.Screen.prototype.hide.call(this)},App.EditScreen.prototype.enable=function(){App.Screen.prototype.enable.call(this),this._input.enable()},App.EditScreen.prototype.disable=function(){App.Screen.prototype.disable.call(this),this._input.disable()},App.EditScreen.prototype.update=function(a,b){this._model=a,this._mode=b,this._target=this._model instanceof App.Account?App.Account:App.SubCategory,this._deleteButton.hidePopUp(!0),this._target===App.Account?(this._input.setValue(this._model.name),this._deleteButton.setMessage("Are you sure you want to\ndelete this account with all its\ndata and categories?")):this._target===App.SubCategory&&this._model.subCategory&&(this._input.setValue(this._model.subCategory.name),this._deleteButton.setMessage("Are you sure you want to\ndelete this sub-category?")),this._render()},App.EditScreen.prototype._registerDeleteButtonListeners=function(){var a=App.EventType;this._deleteButton.addEventListener(a.CANCEL,this,this._onDeleteCancel),this._deleteButton.addEventListener(a.CONFIRM,this,this._onDeleteConfirm),this._deleteButton.addEventListener(a.COMPLETE,this,this._onHidePopUpComplete)},App.EditScreen.prototype._unRegisterDeleteButtonListeners=function(){var a=App.EventType;this._deleteButton.removeEventListener(a.CANCEL,this,this._onDeleteCancel),this._deleteButton.removeEventListener(a.CONFIRM,this,this._onDeleteConfirm),this._deleteButton.removeEventListener(a.COMPLETE,this,this._onHidePopUpComplete)},App.EditScreen.prototype._onDeleteCancel=function(){this._deleteButton.hidePopUp(),App.ViewLocator.getViewSegment(App.ViewName.HEADER).enableActions()},App.EditScreen.prototype._onDeleteConfirm=function(){var a=App.EventType,b=App.ModelLocator.getProxy(App.ModelName.CHANGE_SCREEN_DATA_POOL).allocate().update(App.ScreenName.BACK);this._onHidePopUpComplete(),App.ViewLocator.getViewSegment(App.ViewName.HEADER).enableActions(),b.updateBackScreen=!0,this._target===App.Account?App.Controller.dispatchEvent(a.CHANGE_ACCOUNT,{type:a.DELETE,account:this._model,nextCommand:new App.ChangeScreen,nextCommandData:b}):this._target===App.SubCategory&&App.Controller.dispatchEvent(a.CHANGE_SUB_CATEGORY,{type:a.DELETE,subCategory:this._model.subCategory,category:this._model.category,nextCommand:new App.ChangeCategory,nextCommandData:{type:a.CHANGE,category:this._model.category,nextCommand:new App.ChangeScreen,nextCommandData:b}})},App.EditScreen.prototype._onHidePopUpComplete=function(){this._unRegisterDeleteButtonListeners(),this.enable(),this._registerEventListeners(App.EventLevel.LEVEL_2)},App.EditScreen.prototype._onClick=function(){this._deleteButton.hitTest(this.stage.getTouchData().getLocalPosition(this).y)&&(this._input.isFocused()?this._input.blur():(this.disable(),this._unRegisterEventListeners(App.EventLevel.LEVEL_1),App.ViewLocator.getViewSegment(App.ViewName.HEADER).disableActions(),this._registerDeleteButtonListeners(),this._deleteButton.setPopUpLayout(0,this._layout.headerHeight,0,this._layout.contentHeight>this._background.height?this._layout.contentHeight:this._background.height),this._deleteButton.showPopUp()))},App.EditScreen.prototype._onHeaderClick=function(a){var b=App.EventType,c=App.ModelLocator.getProxy(App.ModelName.CHANGE_SCREEN_DATA_POOL).allocate().update(App.ScreenName.BACK);this._input.blur(),a===App.HeaderAction.CONFIRM?(c.updateBackScreen=!0,this._target===App.Account?App.Controller.dispatchEvent(b.CHANGE_ACCOUNT,{type:b.CHANGE,account:this._model,name:this._input.getValue(),nextCommand:new App.ChangeScreen,nextCommandData:c}):this._target===App.SubCategory&&App.Controller.dispatchEvent(b.CHANGE_SUB_CATEGORY,{type:b.CHANGE,subCategory:this._model.subCategory,category:this._model.category,name:this._input.getValue(),nextCommand:new App.ChangeCategory,nextCommandData:{type:b.CHANGE,category:this._model.category,nextCommand:new App.ChangeScreen,nextCommandData:c}})):a===App.HeaderAction.CANCEL&&App.Controller.dispatchEvent(b.CHANGE_SCREEN,c)},App.InputScrollScreen=function(a){App.Screen.call(this,a,.4),this._scrollTween=new App.TweenProxy(.5,App.Easing.outExpo,0,App.ModelLocator.getProxy(App.ModelName.EVENT_LISTENER_POOL)),this._scrollState=App.TransitionState.HIDDEN,this._scrollInput=null,this._scrollPosition=0,this._inputPadding=Math.round(10*a.pixelRatio)},App.InputScrollScreen.prototype=Object.create(App.Screen.prototype),App.InputScrollScreen.prototype._onTick=function(){App.Screen.prototype._onTick.call(this),this._scrollTween.isRunning()&&this._onScrollTweenUpdate()},App.InputScrollScreen.prototype._onScrollTweenUpdate=function(){var a=App.TransitionState;this._scrollState===a.SHOWING?this._pane.y=-Math.round((this._scrollPosition+this._container.y)*this._scrollTween.progress):this._scrollState===a.HIDING&&(this._pane.y=-Math.round((this._scrollPosition+this._container.y)*(1-this._scrollTween.progress)))},App.InputScrollScreen.prototype._onScrollTweenComplete=function(){var a=App.TransitionState;this._onScrollTweenUpdate(),this._scrollState===a.SHOWING?(this._scrollState=a.SHOWN,this._scrollInput.enable(),this._scrollInput.focus()):this._scrollState===a.HIDING&&(this._scrollState=a.HIDDEN,this._pane.enable(),App.ViewLocator.getViewSegment(App.ViewName.APPLICATION_VIEW).scrollTo(0))},App.InputScrollScreen.prototype._focusInput=function(a){var b=App.TransitionState;(this._scrollState===b.HIDDEN||this._scrollState===b.HIDING)&&(this._scrollState=b.SHOWING,this._pane.disable(),a?(this._scrollPosition=0,this._onScrollTweenComplete()):(this._scrollPosition=this._scrollInput.y-this._inputPadding,this._scrollTween.start()))},App.InputScrollScreen.prototype._onInputBlur=function(){var a=App.TransitionState;(this._scrollState===a.SHOWN||this._scrollState===a.SHOWING)&&(this._scrollState=a.HIDING,this._scrollInput.disable(),this._scrollPosition>0?this._scrollTween.restart():(this._pane.resetScroll(),this._onScrollTweenComplete()))},App.InputScrollScreen.prototype.resetScroll=function(){this._scrollInput&&this._scrollInput.blur(),this._scrollTween.stop(),this._pane.y=0,this._pane.resetScroll(),App.ViewLocator.getViewSegment(App.ViewName.APPLICATION_VIEW).scrollTo(0)},App.TransactionToggleButton=function(a,b,c,d){this._iconName=a,this._toggleStyle=c.toggleStyle,this._toggleOptions=d,this._icon=PIXI.Sprite.fromFrame(a),this._selected=!1,this._iconResizeRatio=Math.round(20*c.pixelRatio)/this._icon.height,App.Button.call(this,b,c),this._render(!0),this.addChild(this._icon)},App.TransactionToggleButton.prototype=Object.create(App.Button.prototype),App.TransactionToggleButton.prototype._render=function(a){var b=this._pixelRatio,c=this.boundingBox.width,d=this.boundingBox.height,e=Math.round(10*b),f=Math.round(5*b);this._selected?(this._toggleOptions.icon&&this._icon.setTexture(PIXI.TextureCache[this._toggleOptions.icon]),this._toggleOptions.label&&this._labelField.setText(this._toggleOptions.label),this._toggleOptions.toggleColor&&(this._icon.tint=16777214,this._labelField.setStyle(this._toggleStyle),this.clear(),this.beginFill(App.ColorTheme.BLUE),this.drawRoundedRect(f,f,c-2*f,d-2*f,f),this.endFill())):(this._toggleOptions.icon&&this._icon.setTexture(PIXI.TextureCache[this._iconName]),this._toggleOptions.label&&this._labelField.setText(this._label),this._toggleOptions.toggleColor&&(this._icon.tint=App.ColorTheme.BLUE,this._labelField.setStyle(this._style),this.clear())),a&&(this._icon.scale.x=this._iconResizeRatio,this._icon.scale.y=this._iconResizeRatio,this._icon.y=Math.round((d-this._icon.height)/2),this._icon.tint=App.ColorTheme.BLUE,this._labelField.y=Math.round((d-this._labelField.height)/2)),this._icon.x=Math.round((c-this._icon.width-e-this._labelField.width)/2),this._labelField.x=Math.round(this._icon.x+this._icon.width+e)},App.TransactionToggleButton.prototype.toggle=function(){this._selected=!this._selected,this._render(!1)},App.TransactionToggleButton.prototype.setState=function(a){this._selected=a,this._render(!1)},App.TransactionToggleButton.prototype.isSelected=function(){return this._selected},App.TransactionOptionButton=function(a,b,c){PIXI.DisplayObjectContainer.call(this);var d=PIXI.Text,e=PIXI.Sprite;this.boundingBox=new App.Rectangle(0,0,c.width,c.height),this._options=c,this._value=null,this._pixelRatio=c.pixelRatio,this._skin=new e(c.skin),this._icon=new e.fromFrame(a),this._nameField=new d(b,c.nameStyle),this._valueField=new d("",c.valueStyle),this._valueDetailField=null,this._arrow=new e.fromFrame("arrow-app"),this._iconResizeRatio=Math.round(20*this._pixelRatio)/this._icon.height,this._arrowResizeRatio=Math.round(12*this._pixelRatio)/this._arrow.height,this._render(),this._update(),this.addChild(this._skin),this.addChild(this._icon),this.addChild(this._nameField),this.addChild(this._valueField),this.addChild(this._arrow)},App.TransactionOptionButton.prototype=Object.create(PIXI.DisplayObjectContainer.prototype),App.TransactionOptionButton.prototype._render=function(){var a=App.ColorTheme,b=this._pixelRatio,c=this.boundingBox.height;this._icon.scale.x=this._iconResizeRatio,this._icon.scale.y=this._iconResizeRatio,this._icon.x=Math.round(15*b),this._icon.y=Math.round((c-this._icon.height)/2),this._icon.tint=a.GREY_DARK,this._nameField.x=Math.round(50*b),this._nameField.y=Math.round((c-this._nameField.height)/2),this._arrow.scale.x=this._arrowResizeRatio,this._arrow.scale.y=this._arrowResizeRatio,this._arrow.x=Math.round(this.boundingBox.width-15*b-this._arrow.width),this._arrow.y=Math.round((c-this._arrow.height)/2),this._arrow.tint=a.GREY_DARK},App.TransactionOptionButton.prototype._update=function(){var a=this._pixelRatio,b=this.boundingBox.width-35*a;this._valueField.x=Math.round(b-this._valueField.width),this._valueDetailField&&this.contains(this._valueDetailField)?(this._valueField.y=Math.round(9*a),this._valueDetailField.y=Math.round(30*a),this._valueDetailField.x=Math.round(b-this._valueDetailField.width)):this._valueField.y=Math.round((this.boundingBox.height-this._valueField.height)/2)},App.TransactionOptionButton.prototype.setValue=function(a,b){this._value=a,this._valueField.setText(a),b?(this._valueDetailField?this._valueDetailField.setText(b):this._valueDetailField=new PIXI.Text(b,this._options.valueDetailStyle),this.contains(this._valueDetailField)||this.addChild(this._valueDetailField)):this._valueDetailField&&this.contains(this._valueDetailField)&&this.removeChild(this._valueDetailField),this._update()},App.TransactionOptionButton.prototype.getValue=function(){return this._value},App.AddTransactionScreen=function(a){App.InputScrollScreen.call(this,a);var b=App.TransactionOptionButton,c=App.TransactionToggleButton,d=App.FontStyle,e=App.ViewLocator.getViewSegment(App.ViewName.SKIN),f=a.pixelRatio,g=a.width,h=g-2*Math.round(10*f),i=Math.round(40*f),j={width:Math.round(g/3),height:Math.round(40*f),pixelRatio:f,style:d.get(14,d.BLUE),toggleStyle:d.get(14,d.WHITE)},k={pixelRatio:f,width:g,height:Math.round(50*f),skin:e.GREY_50,nameStyle:d.get(18,d.GREY_DARKER),valueStyle:d.get(18,d.BLUE,"right"),valueDetailStyle:d.get(14,d.BLUE)};this._pane=new App.Pane(App.ScrollPolicy.OFF,App.ScrollPolicy.AUTO,g,a.contentHeight,f,!1),this._container=new PIXI.DisplayObjectContainer,this._background=new PIXI.Graphics,this._transactionInput=new App.Input("00.00",24,h,i,f,!0),this._noteInput=new App.Input("Add Note",20,h,i,f,!0),this._separators=new PIXI.Graphics,this._deleteBackground=new PIXI.Sprite(e.GREY_60),this._deleteButton=new App.PopUpButton("Delete","Are you sure you want to\ndelete this transaction?",{width:h,height:i,pixelRatio:f,popUpLayout:{x:Math.round(10*f),y:0,width:Math.round(h-20*f),height:Math.round(a.height/2),overlayWidth:g,overlayHeight:0}}),this._optionList=new App.List(App.Direction.Y),this._accountOption=this._optionList.add(new b("account","Account",k)),this._categoryOption=this._optionList.add(new b("folder-app","Category",k)),this._timeOption=this._optionList.add(new b("calendar","Time",k)),this._methodOption=this._optionList.add(new b("credit-card","Method",k)),this._currencyOption=this._optionList.add(new b("currencies","Currency",k),!0),this._toggleButtonList=new App.List(App.Direction.X),this._typeToggle=this._toggleButtonList.add(new c("expense","Expense",j,{icon:"income",label:"Income",toggleColor:!1})),this._pendingToggle=this._toggleButtonList.add(new c("pending-app","Pending",j,{toggleColor:!0})),this._repeatToggle=this._toggleButtonList.add(new c("repeat-app","Repeat",j,{toggleColor:!0}),!0),this._renderAll=!0,this._transactionInput.restrict(/\d{1,}(\.\d*){0,1}/g),this._container.addChild(this._background),this._container.addChild(this._transactionInput),this._container.addChild(this._toggleButtonList),this._container.addChild(this._optionList),this._container.addChild(this._noteInput),this._container.addChild(this._separators),this._pane.setContent(this._container),this.addChild(this._pane),this._clickThreshold=10*f},App.AddTransactionScreen.prototype=Object.create(App.InputScrollScreen.prototype),App.AddTransactionScreen.prototype._render=function(){var a=this._layout.width,b=this._layout.pixelRatio,c=Math.round(10*b);if(this._renderAll){var d=App.ColorTheme,e=App.GraphicUtils,f=Math.round(60*b),g=this._toggleButtonList.boundingBox.height,h=Math.round(a/3),i=a-2*c,j=0;this._renderAll=!1,this._transactionInput.x=c,this._transactionInput.y=c,this._toggleButtonList.y=f,this._optionList.y=this._toggleButtonList.y+g,j=this._optionList.y+this._optionList.boundingBox.height,this._noteInput.x=c,this._noteInput.y=j+c,e.drawRects(this._separators,d.GREY_LIGHT,1,[c,f,i,1,h,f+c,1,g-2*c,2*h,f+c,1,g-2*c,c,j,i,1],!0,!1),j=this._noteInput.y+this._noteInput.boundingBox.height+c,this._deleteBackground.y=j,this._deleteButton.setPosition(c,this._deleteBackground.y+c),e.drawRects(this._separators,d.GREY_DARK,1,[c,f-1,i,1,h-1,f+c,1,g-2*c,2*h-1,f+c,1,g-2*c,c,f+g-1,i,1,c,j-1,i,1],!1,!0)}this._mode===App.ScreenMode.EDIT?(App.GraphicUtils.drawRect(this._background,App.ColorTheme.GREY,1,0,0,a,this._deleteButton.y+this._deleteButton.boundingBox.height+c),this._container.contains(this._deleteBackground)||this._container.addChild(this._deleteBackground),this._container.contains(this._deleteButton)||this._container.addChild(this._deleteButton)):(App.GraphicUtils.drawRect(this._background,App.ColorTheme.GREY,1,0,0,a,this._noteInput.y+this._noteInput.boundingBox.height+c),this._container.contains(this._deleteBackground)&&this._container.removeChild(this._deleteBackground),this._container.contains(this._deleteButton)&&this._container.removeChild(this._deleteButton))},App.AddTransactionScreen.prototype.update=function(a,b){this._model=a||this._model,this._mode=b||this._mode;var c=App.ModelLocator.getProxy(App.ModelName.SETTINGS),d=this._model.account?this._model.account:c.defaultAccount,e=this._model.category?this._model.category:c.defaultCategory,f=this._model.subCategory?this._model.subCategory:c.defaultSubCategory;this._transactionInput.setValue(this._model.amount),this._typeToggle.setState(this._model.type===App.TransactionType.INCOME),this._pendingToggle.setState(this._model.pending),this._repeatToggle.setState(this._model.repeat),this._accountOption.setValue(d.name),this._categoryOption.setValue(f.name,e.name),this._timeOption.setValue(App.DateUtils.getMilitaryTime(this._model.date),this._model.date.toDateString()),this._methodOption.setValue(this._model.method.name),this._currencyOption.setValue(this._model.currencyQuote),this._deleteButton.hidePopUp(!0),this._noteInput.setValue(this._model.note),this._render(),this._pane.resize(),this.resetScroll()},App.AddTransactionScreen.prototype.hide=function(){this._unRegisterDeleteButtonListeners(),App.Screen.prototype.hide.call(this)},App.AddTransactionScreen.prototype.enable=function(){App.Screen.prototype.enable.call(this),this._pane.enable()},App.AddTransactionScreen.prototype.disable=function(){App.Screen.prototype.disable.call(this),this._transactionInput.disable(),this._noteInput.disable(),this._pane.disable()},App.AddTransactionScreen.prototype._registerEventListeners=function(a){if(App.Screen.prototype._registerEventListeners.call(this,a),a===App.EventLevel.LEVEL_2){var b=App.EventType;this._scrollTween.addEventListener(b.COMPLETE,this,this._onScrollTweenComplete),this._transactionInput.addEventListener(b.BLUR,this,this._onInputBlur),this._noteInput.addEventListener(b.BLUR,this,this._onInputBlur)}},App.AddTransactionScreen.prototype._unRegisterEventListeners=function(a){App.Screen.prototype._unRegisterEventListeners.call(this,a);var b=App.EventType;this._scrollTween.removeEventListener(b.COMPLETE,this,this._onScrollTweenComplete),this._transactionInput.removeEventListener(b.BLUR,this,this._onInputBlur),this._noteInput.removeEventListener(b.BLUR,this,this._onInputBlur)},App.AddTransactionScreen.prototype._registerDeleteButtonListeners=function(){var a=App.EventType;this._deleteButton.addEventListener(a.CANCEL,this,this._onDeleteCancel),this._deleteButton.addEventListener(a.CONFIRM,this,this._onDeleteConfirm),this._deleteButton.addEventListener(a.COMPLETE,this,this._onHidePopUpComplete)},App.AddTransactionScreen.prototype._unRegisterDeleteButtonListeners=function(){var a=App.EventType;this._deleteButton.removeEventListener(a.CANCEL,this,this._onDeleteCancel),this._deleteButton.removeEventListener(a.CONFIRM,this,this._onDeleteConfirm),this._deleteButton.removeEventListener(a.COMPLETE,this,this._onHidePopUpComplete)},App.AddTransactionScreen.prototype._onDeleteCancel=function(){this._deleteButton.hidePopUp(),App.ViewLocator.getViewSegment(App.ViewName.HEADER).enableActions()},App.AddTransactionScreen.prototype._onDeleteConfirm=function(){var a=App.HeaderAction,b=this._getChangeTransactionData(App.ScreenName.TRANSACTIONS,0,null,a.MENU,a.ADD_TRANSACTION,App.ScreenTitle.TRANSACTIONS);this._onHidePopUpComplete(),App.ViewLocator.getViewSegment(App.ViewName.HEADER).enableActions(),App.ModelLocator.getProxy(App.ModelName.TRANSACTIONS).setCurrent(this._model),b.type=App.EventType.DELETE,App.Controller.dispatchEvent(App.EventType.CHANGE_TRANSACTION,b)},App.AddTransactionScreen.prototype._onHidePopUpComplete=function(){this._unRegisterDeleteButtonListeners(),this.enable(),this._registerEventListeners(App.EventLevel.LEVEL_2)},App.AddTransactionScreen.prototype._onClick=function(){this._pane.cancelScroll();var a=this._scrollState===App.TransitionState.SHOWN&&this._scrollInput,b=this.stage.getTouchData(),c=b.getLocalPosition(this._container).y;if(this._transactionInput.hitTest(c))this._scrollInput=this._transactionInput,this._focusInput(this._scrollInput.y+this._container.y>0);else if(this._toggleButtonList.hitTest(c))a?this._scrollInput.blur():this._toggleButtonList.getItemUnderPoint(b).toggle();else if(this._optionList.hitTest(c)){a&&this._scrollInput.blur();var d=this._optionList.getItemUnderPoint(b);d===this._accountOption?this._onAccountOptionClick():d===this._categoryOption?this._onCategoryOptionClick():d===this._timeOption?this._onTimeOptionClick():d===this._methodOption?this._onMethodOptionClick():d===this._currencyOption&&this._onCurrencyOptionClick()}else this._noteInput.hitTest(c)?(this._scrollInput=this._noteInput,this._focusInput(!1)):this._deleteButton.hitTest(c)?a?this._scrollInput.blur():(this.disable(),this._unRegisterEventListeners(App.EventLevel.LEVEL_1),App.ViewLocator.getViewSegment(App.ViewName.HEADER).disableActions(),this._registerDeleteButtonListeners(),this._deleteButton.setPopUpLayout(0,this._container.y+this._layout.headerHeight,0,this._layout.contentHeight>this._container.height?this._layout.contentHeight:this._container.height),this._deleteButton.showPopUp()):a&&this._scrollInput.blur()},App.AddTransactionScreen.prototype._onAccountOptionClick=function(){App.Controller.dispatchEvent(App.EventType.CHANGE_TRANSACTION,this._getChangeTransactionData(App.ScreenName.ACCOUNT,App.ScreenMode.SELECT,null,0,App.HeaderAction.NONE,App.ScreenTitle.SELECT_ACCOUNT))},App.AddTransactionScreen.prototype._onCategoryOptionClick=function(){var a=this._model.account;a&&a.lifeCycleState!==App.LifeCycleState.DELETED?App.Controller.dispatchEvent(App.EventType.CHANGE_TRANSACTION,this._getChangeTransactionData(App.ScreenName.CATEGORY,App.ScreenMode.SELECT,a,0,App.HeaderAction.NONE,App.ScreenTitle.SELECT_CATEGORY)):App.Controller.dispatchEvent(App.EventType.CHANGE_TRANSACTION,this._getChangeTransactionData(App.ScreenName.ACCOUNT,App.ScreenMode.SELECT,null,0,App.HeaderAction.NONE,App.ScreenTitle.SELECT_ACCOUNT))},App.AddTransactionScreen.prototype._onTimeOptionClick=function(){App.Controller.dispatchEvent(App.EventType.CHANGE_TRANSACTION,this._getChangeTransactionData(App.ScreenName.SELECT_TIME,App.ScreenMode.SELECT,this._model.date,0,0,App.ScreenTitle.SELECT_TIME))},App.AddTransactionScreen.prototype._onMethodOptionClick=function(){this._methodOption.setValue(this._methodOption.getValue()===App.PaymentMethod.CASH?App.PaymentMethod.CREDIT_CARD:App.PaymentMethod.CASH)},App.AddTransactionScreen.prototype._onCurrencyOptionClick=function(){App.Controller.dispatchEvent(App.EventType.CHANGE_TRANSACTION,this._getChangeTransactionData(App.ScreenName.CURRENCIES,App.ScreenMode.SELECT,null,0,App.HeaderAction.NONE,App.ScreenTitle.SELECT_CURRENCY))},App.AddTransactionScreen.prototype._onHeaderClick=function(a){var b=App.HeaderAction,c=this._getChangeTransactionData(App.ScreenName.TRANSACTIONS,0,App.ModelLocator.getProxy(App.ModelName.TRANSACTIONS).copySource().reverse(),b.MENU,b.ADD_TRANSACTION,App.ScreenTitle.TRANSACTIONS);this._scrollState===App.TransitionState.SHOWN&&this._scrollInput&&this._scrollInput.blur(),a===b.CONFIRM?(c.type=App.EventType.CONFIRM,App.Controller.dispatchEvent(App.EventType.CHANGE_TRANSACTION,c)):(c.type=App.EventType.CANCEL,c.nextCommandData.screenName=App.ScreenName.BACK,c.nextCommandData.updateBackScreen=!0,App.Controller.dispatchEvent(App.EventType.CHANGE_TRANSACTION,c))},App.AddTransactionScreen.prototype._getChangeTransactionData=function(a,b,c,d,e,f){return{type:App.EventType.CHANGE,amount:this._transactionInput.getValue(),transactionType:this._typeToggle.isSelected()?App.TransactionType.INCOME:App.TransactionType.EXPENSE,pending:this._pendingToggle.isSelected(),repeat:this._repeatToggle.isSelected(),method:this._methodOption.getValue(),note:this._noteInput.getValue(),nextCommand:new App.ChangeScreen,nextCommandData:App.ModelLocator.getProxy(App.ModelName.CHANGE_SCREEN_DATA_POOL).allocate().update(a,b,c,d,e,f)}},App.SelectTimeScreen=function(a){App.InputScrollScreen.call(this,a);var b=a.pixelRatio,c=a.width,d=App.ScrollPolicy;this._pane=new App.Pane(d.OFF,d.AUTO,c,a.contentHeight,b,!1),this._container=new PIXI.DisplayObjectContainer,this._inputBackground=new PIXI.Graphics,this._input=new App.TimeInput("00:00",30,c-Math.round(20*b),Math.round(40*b),b),this._header=new App.ListHeader("Select Date",c,b),this._calendar=new App.Calendar(c,b),this._render(),this._container.addChild(this._inputBackground),this._container.addChild(this._header),this._container.addChild(this._calendar),this._container.addChild(this._input),this._pane.setContent(this._container),this.addChild(this._pane)},App.SelectTimeScreen.prototype=Object.create(App.InputScrollScreen.prototype),App.SelectTimeScreen.prototype._render=function(){var a=App.ColorTheme,b=App.GraphicUtils,c=this._layout.pixelRatio,d=Math.round(60*c),e=this._layout.width;b.drawRects(this._inputBackground,a.GREY,1,[0,0,e,d],!0,!1),b.drawRects(this._inputBackground,a.GREY_DARK,1,[0,d-1,e,1],!1,!0),this._input.x=Math.round(10*c),this._input.y=Math.round((d-this._input.height)/2),this._header.y=d,this._calendar.y=Math.round(this._header.y+this._header.height)},App.SelectTimeScreen.prototype.enable=function(){App.InputScrollScreen.prototype.enable.call(this),this._pane.enable()},App.SelectTimeScreen.prototype.disable=function(){this.resetScroll(),App.InputScrollScreen.prototype.disable.call(this),this._input.disable(),this._pane.disable()},App.SelectTimeScreen.prototype.update=function(a){this._input.setValue(App.DateUtils.getMilitaryTime(a)),this._calendar.update(a)},App.SelectTimeScreen.prototype._registerEventListeners=function(a){if(App.Screen.prototype._registerEventListeners.call(this,a),a===App.EventLevel.LEVEL_2){var b=App.EventType;this._scrollTween.addEventListener(b.COMPLETE,this,this._onScrollTweenComplete),this._input.addEventListener(b.BLUR,this,this._onInputBlur)}},App.SelectTimeScreen.prototype._unRegisterEventListeners=function(a){App.Screen.prototype._unRegisterEventListeners.call(this,a);var b=App.EventType;this._scrollTween.removeEventListener(b.COMPLETE,this,this._onScrollTweenComplete),this._input.removeEventListener(b.BLUR,this,this._onInputBlur)},App.SelectTimeScreen.prototype._onClick=function(){this._pane.cancelScroll();var a=this._scrollState===App.TransitionState.SHOWN&&this._scrollInput,b=this.stage.getTouchData(),c=b.getLocalPosition(this._container).y;this._input.hitTest(c)?(this._scrollInput=this._input,this._focusInput(this._input.y+this._container.y>0)):a?this._scrollInput.blur():this._calendar.onClick()},App.SelectTimeScreen.prototype._onHeaderClick=function(a){var b=App.HeaderAction,c=App.ModelLocator.getProxy(App.ModelName.CHANGE_SCREEN_DATA_POOL).allocate().update(App.ScreenName.BACK);
this._scrollState===App.TransitionState.SHOWN&&this._scrollInput&&this._scrollInput.blur(),a===b.CANCEL?App.Controller.dispatchEvent(App.EventType.CHANGE_SCREEN,c):a===b.CONFIRM&&(c.updateBackScreen=!0,App.Controller.dispatchEvent(App.EventType.CHANGE_TRANSACTION,{type:App.EventType.CHANGE,date:this._calendar.getSelectedDate(),time:this._input.getValue(),nextCommand:new App.ChangeScreen,nextCommandData:c}))},App.AccountButton=function(a,b){App.SwipeButton.call(this,b.width,b.openOffset),this.allocated=!1,this.poolIndex=a,this.boundingBox=new PIXI.Rectangle(0,0,b.width,b.height),this._model=null,this._mode=App.ScreenMode.SELECT,this._pixelRatio=b.pixelRatio,this._background=this.addChild(new PIXI.Graphics),this._editLabel=this.addChild(new PIXI.Text("Edit",b.editStyle)),this._swipeSurface=this.addChild(new PIXI.DisplayObjectContainer),this._skin=this._swipeSurface.addChild(new PIXI.Sprite(b.skin)),this._nameLabel=this._swipeSurface.addChild(new PIXI.Text("",b.nameStyle)),this._detailsLabel=this._swipeSurface.addChild(new PIXI.Text("Balance: 2.876, Expenses: -250, Income: 1.500",b.detailStyle)),this._renderAll=!0},App.AccountButton.prototype=Object.create(App.SwipeButton.prototype),App.AccountButton.prototype._render=function(){if(this._renderAll){var a=this.boundingBox.width,b=this.boundingBox.height,c=this._pixelRatio,d=Math.round(15*c);this._renderAll=!1,App.GraphicUtils.drawRect(this._background,App.ColorTheme.RED,1,0,0,a,b),this._editLabel.x=Math.round(a-50*this._pixelRatio),this._editLabel.y=Math.round((b-this._editLabel.height)/2),this._nameLabel.x=d,this._nameLabel.y=d,this._detailsLabel.x=d,this._detailsLabel.y=Math.round(45*c)}},App.AccountButton.prototype.setModel=function(a,b){this._model=a,this._mode=b,this._nameLabel.setText(this._model.name),this._render()},App.AccountButton.prototype.getModel=function(){return this._model},App.AccountButton.prototype.getClickMode=function(a){return this._isOpen&&a.getLocalPosition(this).x>=this._width-this._openOffset?App.ScreenMode.EDIT:App.ScreenMode.SELECT},App.AccountButton.prototype._updateSwipePosition=function(a){this._swipeSurface.x=a},App.AccountButton.prototype._getSwipePosition=function(){return this._swipeSurface.x},App.AccountScreen=function(a){App.Screen.call(this,a,.4);var b=App.ScrollPolicy,c=App.FontStyle,d=a.pixelRatio,e=a.contentHeight;this._model=App.ModelLocator.getProxy(App.ModelName.ACCOUNTS),this._interactiveButton=null,this._buttonList=new App.TileList(App.Direction.Y,e),this._addNewButton=new App.AddNewButton("ADD ACCOUNT",c.get(16,c.GREY_DARK),App.ViewLocator.getViewSegment(App.ViewName.SKIN).GREY_60,d),this._pane=new App.TilePane(b.OFF,b.AUTO,a.width,e,d,!1),this._pane.setContent(this._buttonList),this.addChild(this._pane)},App.AccountScreen.prototype=Object.create(App.Screen.prototype),App.AccountScreen.prototype.enable=function(){App.Screen.prototype.enable.call(this),this._pane.resetScroll(),this._pane.enable()},App.AccountScreen.prototype.disable=function(){App.Screen.prototype.disable.call(this),this._pane.disable()},App.AccountScreen.prototype.update=function(a,b){this._buttonList.remove(this._addNewButton);for(var c=App.ViewLocator.getViewSegment(App.ViewName.ACCOUNT_BUTTON_POOL),d=0,e=this._buttonList.length,f=App.LifeCycleState.DELETED,g=null,h=null;e>d;d++)c.release(this._buttonList.removeItemAt(0));for(d=0,e=this._model.length();e>d;)g=this._model.getItemAt(d++),g.lifeCycleState!==f&&(h=c.allocate(),h.setModel(g,b),this._buttonList.add(h));this._buttonList.add(this._addNewButton),this._buttonList.updateLayout(!0),this._pane.resize(),this._mode=b,this._swipeEnabled=b===App.ScreenMode.EDIT},App.AccountScreen.prototype._onTweenComplete=function(){App.Screen.prototype._onTweenComplete.call(this),this._transitionState===App.TransitionState.HIDDEN&&this._closeButtons(!0)},App.AccountScreen.prototype._swipeStart=function(a,b){var c=this._buttonList.getItemUnderPoint(this.stage.getTouchData());!c||c instanceof App.AddNewButton||(a||this._pane.cancelScroll(),this._interactiveButton=c,this._interactiveButton.swipeStart(b),this._closeButtons(!1))},App.AccountScreen.prototype._swipeEnd=function(){this._interactiveButton&&(this._interactiveButton.swipeEnd(),this._interactiveButton=null)},App.AccountScreen.prototype._closeButtons=function(a){if(this._mode===App.ScreenMode.EDIT)for(var b=0,c=this._buttonList.length-1,d=null;c>b;)d=this._buttonList.getItemAt(b++),d!==this._interactiveButton&&d.close(a)},App.AccountScreen.prototype._onClick=function(){var a=this.stage.getTouchData(),b=this._buttonList.getItemUnderPoint(a);if(b){var c=App.EventType,d=App.ModelLocator.getProxy(App.ModelName.CHANGE_SCREEN_DATA_POOL).allocate().update(App.ScreenName.EDIT);if(b instanceof App.AddNewButton)d.headerName=App.ScreenTitle.ADD_ACCOUNT,App.Controller.dispatchEvent(c.CHANGE_ACCOUNT,{type:c.CREATE,nextCommand:new App.ChangeScreen,nextCommandData:d});else{var e=App.ScreenMode,f=App.HeaderAction;this._mode===e.EDIT?b.getClickMode(a)===e.EDIT?App.Controller.dispatchEvent(c.CHANGE_SCREEN,d.update(App.ScreenName.EDIT,App.ScreenMode.EDIT,b.getModel(),0,0,App.ScreenTitle.EDIT_ACCOUNT)):App.Controller.dispatchEvent(c.CHANGE_SCREEN,d.update(App.ScreenName.CATEGORY,this._mode,b.getModel(),f.MENU,f.ADD_TRANSACTION,App.ScreenTitle.CATEGORIES)):App.Controller.dispatchEvent(c.CHANGE_SCREEN,d.update(App.ScreenName.CATEGORY,this._mode,b.getModel(),0,f.NONE,App.ScreenTitle.SELECT_CATEGORY))}}},App.AccountScreen.prototype._onHeaderClick=function(a){var b=App.HeaderAction,c=App.ModelLocator.getProxy(App.ModelName.CHANGE_SCREEN_DATA_POOL).allocate();a===b.ADD_TRANSACTION?App.Controller.dispatchEvent(App.EventType.CHANGE_TRANSACTION,{type:App.EventType.CREATE,nextCommand:new App.ChangeScreen,nextCommandData:c.update()}):a===b.MENU?App.Controller.dispatchEvent(App.EventType.CHANGE_SCREEN,c.update(App.ScreenName.MENU,0,null,b.NONE,b.CANCEL,App.ScreenTitle.MENU)):a===b.CANCEL&&App.Controller.dispatchEvent(App.EventType.CHANGE_SCREEN,c.update(App.ScreenName.BACK))},App.SubCategoryButton=function(a,b){App.SwipeButton.call(this,b.width,b.openOffset),this.allocated=!1,this.poolIndex=a,this.boundingBox=new App.Rectangle(0,0,b.width,b.height),this._model=null,this._mode=null,this._options=b,this._pixelRatio=b.pixelRatio,this._background=this.addChild(new PIXI.Graphics),this._deleteLabel=this.addChild(new PIXI.Text("Edit",b.editLabelStyle)),this._swipeSurface=this.addChild(new PIXI.DisplayObjectContainer),this._skin=this._swipeSurface.addChild(new PIXI.Sprite(b.whiteSkin)),this._icon=PIXI.Sprite.fromFrame("subcategory-app"),this._nameLabel=this._swipeSurface.addChild(new PIXI.Text("",b.nameLabelStyle)),this._renderAll=!0},App.SubCategoryButton.prototype=Object.create(App.SwipeButton.prototype),App.SubCategoryButton.prototype._render=function(){if(this._nameLabel.setText(this._model.name),this._renderAll){this._renderAll=!1;var a=App.ColorTheme,b=this._pixelRatio,c=this.boundingBox.width,d=this.boundingBox.height,e=Math.round(25*b),f=Math.round(20*b)/this._icon.height;App.GraphicUtils.drawRect(this._background,a.RED,1,0,0,c,d),this._deleteLabel.x=Math.round(c-50*b),this._deleteLabel.y=Math.round((d-this._deleteLabel.height)/2),this._icon.scale.x=f,this._icon.scale.y=f,this._icon.x=e,this._icon.y=Math.round((d-this._icon.height)/2),this._icon.tint=a.GREY,this._nameLabel.y=Math.round((d-this._nameLabel.height)/2)}this._mode===App.ScreenMode.SELECT?(this._skin.setTexture(this._options.whiteSkin),this._nameLabel.x=Math.round(64*this._pixelRatio),this._swipeSurface.contains(this._icon)||this._swipeSurface.addChild(this._icon)):this._mode===App.ScreenMode.EDIT&&(this._skin.setTexture(this._options.greySkin),this._nameLabel.x=this._icon.x,this._swipeSurface.contains(this._icon)&&this._swipeSurface.removeChild(this._icon))},App.SubCategoryButton.prototype.disable=function(){App.SwipeButton.prototype.disable.call(this)},App.SubCategoryButton.prototype.update=function(a,b){this._model=a,this._mode=b,this._render(),this.close(!0)},App.SubCategoryButton.prototype.getModel=function(){return this._model},App.SubCategoryButton.prototype.onClick=function(a,b){this._mode===App.ScreenMode.EDIT&&this._isOpen&&a.getLocalPosition(this).x>=this._width-this._openOffset&&(this._model.saveState(),App.Controller.dispatchEvent(App.EventType.CHANGE_SCREEN,App.ModelLocator.getProxy(App.ModelName.CHANGE_SCREEN_DATA_POOL).allocate().update(App.ScreenName.EDIT,App.ScreenMode.EDIT,{subCategory:this._model,category:b},0,0,App.ScreenTitle.EDIT_SUB_CATEGORY)))},App.SubCategoryButton.prototype._updateSwipePosition=function(a){this._swipeSurface.x=a},App.SubCategoryButton.prototype._getSwipePosition=function(){return this._swipeSurface.x},App.SubCategoryList=function(a){PIXI.DisplayObjectContainer.call(this),this.boundingBox=new App.Rectangle(0,0,a.width,0),this._model=null,this._mode=null,this._width=a.width,this._pixelRatio=a.pixelRatio,this._interactiveButton=null,a.displayHeader&&(this._header=this.addChild(new App.ListHeader("Sub-Categories",this._width,this._pixelRatio))),this._buttonList=this.addChild(new App.List(App.Direction.Y)),this._addNewButton=new App.AddNewButton("ADD SUB-CATEGORY",a.addLabelStyle,a.addButtonSkin,this._pixelRatio)},App.SubCategoryList.prototype=Object.create(PIXI.DisplayObjectContainer.prototype),App.SubCategoryList.prototype._render=function(){this._header&&(this._buttonList.y=this._header.height),this.boundingBox.height=this._buttonList.y+this._buttonList.boundingBox.height},App.SubCategoryList.prototype.update=function(a,b){this._model=a,this._buttonList.remove(this._addNewButton);for(var c=a.subCategories,d=App.ViewLocator.getViewSegment(App.ViewName.SUB_CATEGORY_BUTTON_POOL),e=0,f=this._buttonList.length,g=null;f>e;e++)d.release(this._buttonList.removeItemAt(0));for(e=0,f=c.length;f>e;)g=d.allocate(),g.update(c[e++],b),this._buttonList.add(g,!1);this._buttonList.add(this._addNewButton),this._buttonList.updateLayout(),this._render(),this._mode=b},App.SubCategoryList.prototype.swipeStart=function(a){var b=this._buttonList.getItemUnderPoint(this.stage.getTouchData());!b||b instanceof App.AddNewButton||(this._interactiveButton=b,this._interactiveButton.swipeStart(a),this.closeButtons(!1))},App.SubCategoryList.prototype.swipeEnd=function(){this._interactiveButton&&(this._interactiveButton.swipeEnd(),this._interactiveButton=null)},App.SubCategoryList.prototype.closeButtons=function(a){for(var b=0,c=this._buttonList.length-1,d=null;c>b;)d=this._buttonList.getItemAt(b++),d!==this._interactiveButton&&d.close(a)},App.SubCategoryList.prototype.getItemUnderPoint=function(a){return this._buttonList.getItemUnderPoint(a)},App.SubCategoryList.prototype.hitTest=function(a){return a>=this.y&&a<this.y+this.boundingBox.height},App.CategoryButtonSurface=function(a){PIXI.DisplayObjectContainer.call(this),this._width=a.width,this._height=a.height,this._pixelRatio=a.pixelRatio,this._skin=this.addChild(new PIXI.Sprite(a.skin)),this._colorStripe=this.addChild(new PIXI.Graphics),this._icon=null,this._nameLabel=this.addChild(new PIXI.Text("",a.nameLabelStyle)),this._renderAll=!0},App.CategoryButtonSurface.prototype=Object.create(PIXI.DisplayObjectContainer.prototype),App.CategoryButtonSurface.prototype.render=function(a,b,c){this._nameLabel.setText(a),this._icon&&this._icon.setTexture(PIXI.TextureCache[b]),App.GraphicUtils.drawRect(this._colorStripe,"0x"+c,1,0,0,Math.round(4*this._pixelRatio),this._height),this._renderAll&&(this._renderAll=!1,this._icon=PIXI.Sprite.fromFrame(b),this.addChild(this._icon),this._icon.width=Math.round(20*this._pixelRatio),this._icon.height=Math.round(20*this._pixelRatio),this._icon.x=Math.round(25*this._pixelRatio),this._icon.y=Math.round((this._height-this._icon.height)/2),this._nameLabel.x=Math.round(64*this._pixelRatio),this._nameLabel.y=Math.round(18*this._pixelRatio)),this._icon.tint=parseInt(c,16)},App.CategoryButtonEdit=function(a,b){App.SwipeButton.call(this,b.width,Math.round(80*b.pixelRatio)),this.allocated=!1,this.poolIndex=a,this.boundingBox=new App.Rectangle(0,0,b.width,b.height),this._model=null,this._mode=null,this._pixelRatio=b.pixelRatio,this._background=this.addChild(new PIXI.Graphics),this._editLabel=this.addChild(new PIXI.Text("Edit",b.editLabelStyle)),this._swipeSurface=this.addChild(new App.CategoryButtonSurface(b)),this._renderAll=!0},App.CategoryButtonEdit.prototype=Object.create(App.SwipeButton.prototype),App.CategoryButtonEdit.prototype._render=function(){var a=this.boundingBox.width,b=this.boundingBox.height;this._swipeSurface.render(this._model.name,this._model.icon,this._model.color),this._renderAll&&(this._renderAll=!1,App.GraphicUtils.drawRect(this._background,App.ColorTheme.RED,1,0,0,a,b),this._editLabel.x=Math.round(a-50*this._pixelRatio),this._editLabel.y=Math.round(18*this._pixelRatio))},App.CategoryButtonEdit.prototype.disable=function(){App.SwipeButton.prototype.disable.call(this)},App.CategoryButtonEdit.prototype.update=function(a,b){this._model=a,this._mode=b,this._render(),this.close(!0)},App.CategoryButtonEdit.prototype.onClick=function(a){this._isOpen&&a.getLocalPosition(this).x>=this._width-this._openOffset&&(this._model.saveState(),App.Controller.dispatchEvent(App.EventType.CHANGE_SCREEN,App.ModelLocator.getProxy(App.ModelName.CHANGE_SCREEN_DATA_POOL).allocate().update(App.ScreenName.EDIT_CATEGORY,App.ScreenMode.EDIT,this._model,0,0,App.ScreenTitle.EDIT_CATEGORY)))},App.CategoryButtonEdit.prototype._updateSwipePosition=function(a){this._swipeSurface.x=a},App.CategoryButtonEdit.prototype._getSwipePosition=function(){return this._swipeSurface.x},App.CategoryButtonExpand=function(a,b){App.ExpandButton.call(this,b.width,b.height,!0),this.allocated=!1,this.poolIndex=a,this._model=null,this._mode=null,this._pixelRatio=b.pixelRatio,this._surface=new App.CategoryButtonSurface(b),this._subCategoryList=new App.SubCategoryList(b),this._layoutDirty=!0,this._setContent(this._subCategoryList),this.addChild(this._subCategoryList),this.addChild(this._surface)},App.CategoryButtonExpand.prototype=Object.create(App.ExpandButton.prototype),App.CategoryButtonExpand.prototype._render=function(){this._surface.render(this._model.name,this._model.icon,this._model.color)},App.CategoryButtonExpand.prototype.update=function(a,b){this._model=a,this._mode=b,this._layoutDirty=!0,this._render(),this.close(!0)},App.CategoryButtonExpand.prototype.onClick=function(a){var b=App.TransitionState;if(this._transitionState===b.CLOSED||this._transitionState===b.CLOSING)this.open();else if(a.getLocalPosition(this).y<=this._buttonHeight)this.close();else{this._eventDispatcher.dispatchEvent(App.EventType.COMPLETE,this);var c=this._subCategoryList.getItemUnderPoint(a);if(c){var d=App.ModelLocator,e=App.ModelName,f=App.EventType,g=d.getProxy(e.CHANGE_SCREEN_DATA_POOL).allocate().update(App.ScreenName.BACK);c instanceof App.AddNewButton?(g.screenName=App.ScreenName.EDIT,g.headerName=App.ScreenTitle.ADD_SUB_CATEGORY,App.Controller.dispatchEvent(f.CHANGE_SUB_CATEGORY,{type:f.CREATE,category:this._model,nextCommand:new App.ChangeScreen,nextCommandData:g})):(g.backSteps=d.getProxy(e.SCREEN_HISTORY).peek(2).screenName===App.ScreenName.ACCOUNT?2:1,g.updateBackScreen=!0,App.Controller.dispatchEvent(f.CHANGE_TRANSACTION,{type:f.CHANGE,account:d.getProxy(e.ACCOUNTS).find("id",this._model.account),category:this._model,subCategory:c.getModel(),nextCommand:new App.ChangeScreen,nextCommandData:g}))}}},App.CategoryButtonExpand.prototype.open=function(){this._layoutDirty&&(this._subCategoryList.update(this._model,this._mode),this._contentHeight=this._subCategoryList.boundingBox.height,this._layoutDirty=!1),App.ExpandButton.prototype.open.call(this)},App.CategoryButtonExpand.prototype.disable=function(){this.close(!0)},App.CategoryScreen=function(a){App.Screen.call(this,a,.4);var b=App.ScrollPolicy,c=App.FontStyle,d=App.ObjectPool,e=a.pixelRatio,f=a.width,g=a.contentHeight,h=App.ViewLocator.getViewSegment(App.ViewName.SKIN),i={width:f,height:Math.round(50*e),pixelRatio:e,skin:h.GREY_50,addButtonSkin:h.WHITE_40,nameLabelStyle:c.get(18,c.BLUE),editLabelStyle:c.get(18,c.WHITE,null,c.LIGHT_CONDENSED),addLabelStyle:c.get(14,c.GREY_DARK),displayHeader:!1};this._interactiveButton=null,this._buttonsInTransition=[],this._layoutDirty=!1,this._buttonExpandPool=new d(App.CategoryButtonExpand,5,i),this._buttonEditPool=new d(App.CategoryButtonEdit,5,i),this._buttonList=new App.TileList(App.Direction.Y,g),this._addNewButton=new App.AddNewButton("ADD CATEGORY",c.get(14,c.GREY_DARK),App.ViewLocator.getViewSegment(App.ViewName.SKIN).GREY_50,e),this._pane=new App.TilePane(b.OFF,b.AUTO,a.width,g,e,!1),this._pane.setContent(this._buttonList),this.addChild(this._pane)},App.CategoryScreen.prototype=Object.create(App.Screen.prototype),App.CategoryScreen.prototype.enable=function(){App.Screen.prototype.enable.call(this),this._pane.resetScroll(),this._pane.enable()},App.CategoryScreen.prototype.disable=function(){App.Screen.prototype.disable.call(this),this._layoutDirty=!1,this._pane.disable()},App.CategoryScreen.prototype.update=function(a,b){this._model=a,this._buttonList.remove(this._addNewButton);for(var c=App.ScreenMode,d=this._mode===c.SELECT?this._buttonExpandPool:this._buttonEditPool,e=this._model.categories,f=0,g=this._buttonList.length,h=null;g>f;f++)d.release(this._buttonList.removeItemAt(0));for(d=b===c.SELECT?this._buttonExpandPool:this._buttonEditPool,f=0,g=e.length;g>f;)h=d.allocate(),h.update(e[f++],b),this._buttonList.add(h,!1);this._buttonList.add(this._addNewButton),this._updateLayout(),this._mode=b,this._swipeEnabled=b===c.EDIT},App.CategoryScreen.prototype._onTick=function(){App.Screen.prototype._onTick.call(this),this._layoutDirty&&this._updateLayout()},App.CategoryScreen.prototype._onTweenComplete=function(){App.Screen.prototype._onTweenComplete.call(this),this._transitionState===App.TransitionState.HIDDEN&&this._closeButtons(!0)},App.CategoryScreen.prototype._swipeStart=function(a,b){var c=this._buttonList.getItemUnderPoint(this.stage.getTouchData());!c||c instanceof App.AddNewButton||(a||this._pane.cancelScroll(),this._interactiveButton=c,this._interactiveButton.swipeStart(b),this._closeButtons(!1))},App.CategoryScreen.prototype._swipeEnd=function(){this._interactiveButton&&(this._interactiveButton.swipeEnd(),this._interactiveButton=null)},App.CategoryScreen.prototype._closeButtons=function(a){var b=0,c=this._buttonList.length-1,d=null,e=App.ScreenMode,f=App.EventType;if(this._mode===e.SELECT)for(;c>b;)d=this._buttonList.getItemAt(b++),d!==this._interactiveButton&&d.isOpen()&&(-1===this._buttonsInTransition.indexOf(d)&&(this._buttonsInTransition.push(d),d.addEventListener(f.COMPLETE,this,this._onButtonTransitionComplete),this._layoutDirty=!0),d.close(a));else if(this._mode===e.EDIT)for(;c>b;)d=this._buttonList.getItemAt(b++),d!==this._interactiveButton&&d.close(a)},App.CategoryScreen.prototype._onClick=function(){var a=this.stage.getTouchData(),b=this._buttonList.getItemUnderPoint(a);if(b)if(b instanceof App.AddNewButton){var c=App.ModelLocator.getProxy(App.ModelName.CHANGE_SCREEN_DATA_POOL).allocate().update(App.ScreenName.EDIT_CATEGORY);c.headerName=App.ScreenTitle.ADD_CATEGORY,App.Controller.dispatchEvent(App.EventType.CHANGE_CATEGORY,{type:App.EventType.CREATE,account:this._model,nextCommand:new App.ChangeScreen,nextCommandData:c})}else this._mode===App.ScreenMode.SELECT?(this._interactiveButton=b,-1===this._buttonsInTransition.indexOf(this._interactiveButton)&&(this._buttonsInTransition.push(this._interactiveButton),this._interactiveButton.addEventListener(App.EventType.COMPLETE,this,this._onButtonTransitionComplete),this._layoutDirty=!0),this._interactiveButton.onClick(a),this._pane.cancelScroll()):this._mode===App.ScreenMode.EDIT&&b.onClick(a)},App.CategoryScreen.prototype._onHeaderClick=function(a){var b=App.HeaderAction,c=App.ModelLocator.getProxy(App.ModelName.CHANGE_SCREEN_DATA_POOL).allocate().update(App.ScreenName.MENU,0,null,b.NONE,b.CANCEL,App.ScreenTitle.MENU);a===b.ADD_TRANSACTION?App.Controller.dispatchEvent(App.EventType.CHANGE_TRANSACTION,{type:App.EventType.CREATE,nextCommand:new App.ChangeScreen,nextCommandData:c.update()}):a===b.MENU?App.Controller.dispatchEvent(App.EventType.CHANGE_SCREEN,c):a===b.CANCEL&&App.Controller.dispatchEvent(App.EventType.CHANGE_SCREEN,c.update(App.ScreenName.BACK))},App.CategoryScreen.prototype._onButtonTransitionComplete=function(a){var b=0,c=this._buttonsInTransition.length,d=App.EventType;for(a.removeEventListener(d.COMPLETE,this,this._onButtonTransitionComplete);c>b;b++)if(a===this._buttonsInTransition[b]){this._buttonsInTransition.splice(b,1);break}0===this._buttonsInTransition.length&&(this._interactiveButton=null,this._layoutDirty=!1,this._updateLayout())},App.CategoryScreen.prototype._updateLayout=function(){this._buttonList.updateLayout(!0),this._pane.resize()},App.ColorSample=function(a,b,c){PIXI.Graphics.call(this),this.boundingBox=new App.Rectangle(0,0,Math.round(40*c),Math.round(50*c)),this._modelIndex=a,this._pixelRatio=c,this._color=b.toString(),this._selected=!1,this._render()},App.ColorSample.prototype=Object.create(PIXI.Graphics.prototype),App.ColorSample.prototype._render=function(){var a=Math.round((this._selected?0:5)*this._pixelRatio),b=Math.round((this._selected?5:10)*this._pixelRatio),c=this.boundingBox.width,d=this.boundingBox.height;this.clear(),this.beginFill("0x"+this._color),this.drawRoundedRect(a,b,c-2*a,d-2*b,Math.round(5*this._pixelRatio)),this.endFill()},App.ColorSample.prototype.setModel=function(a,b,c){this._modelIndex=a,this._color=b,this._selected=c===this._modelIndex,this._render()},App.ColorSample.prototype.getModelIndex=function(){return this._modelIndex},App.ColorSample.prototype.getValue=function(){return this._color},App.ColorSample.prototype.select=function(a){var b=this._modelIndex===a;this._selected!==b&&(this._selected=b,this._render())},App.IconSample=function(a,b,c){PIXI.DisplayObjectContainer.call(this);var d=Math.round(64*c);this.boundingBox=new App.Rectangle(0,0,d,d),this._modelIndex=a,this._model=b,this._pixelRatio=c,this._icon=PIXI.Sprite.fromFrame(b),this._iconResizeRatio=Math.round(32*c)/this._icon.height,this._selected=!1,this._render(),this.addChild(this._icon)},App.IconSample.prototype=Object.create(PIXI.DisplayObjectContainer.prototype),App.IconSample.prototype._render=function(){var a=App.ColorTheme,b=this.boundingBox.width;this._icon.scale.x=this._iconResizeRatio,this._icon.scale.y=this._iconResizeRatio,this._icon.x=Math.round((b-this._icon.width)/2),this._icon.y=Math.round((b-this._icon.height)/2),this._icon.tint=this._selected?a.BLUE:a.GREY_DARK},App.IconSample.prototype.setModel=function(a,b,c){this._modelIndex=a,this._model=b,this._icon.setTexture(PIXI.TextureCache[b]),this._selected=c===this._modelIndex,this._render()},App.IconSample.prototype.getModelIndex=function(){return this._modelIndex},App.IconSample.prototype.getValue=function(){return this._model},App.IconSample.prototype.select=function(a){var b=this._modelIndex===a;this._selected!==b&&(this._selected=b,this._render())},App.EditCategoryScreen=function(a){App.InputScrollScreen.call(this,a);var b=App.ScrollPolicy,c=App.InfiniteList,d=App.Direction,e=App.IconSample,f=App.FontStyle,g=App.Input,h=a.pixelRatio,i=a.width,j=i-Math.round(20*h),k=Math.round(40*h),l=App.ModelLocator.getProxy(App.ModelName.ICONS),m=Math.round(64*h),n={width:i,height:k,pixelRatio:h,addButtonSkin:App.ViewLocator.getViewSegment(App.ViewName.SKIN).GREY_40,addLabelStyle:f.get(14,f.GREY_DARK),displayHeader:!0};this._pane=new App.Pane(b.OFF,b.AUTO,i,a.contentHeight,h,!1),this._container=new PIXI.DisplayObjectContainer,this._background=this._container.addChild(new PIXI.Graphics),this._colorStripe=this._container.addChild(new PIXI.Graphics),this._icon=PIXI.Sprite.fromFrame("currencies"),this._iconResizeRatio=Math.round(32*h)/this._icon.height,this._input=this._container.addChild(new g("Enter Category Name",20,i-Math.round(70*h),Math.round(40*h),h,!0)),this._separators=this._container.addChild(new PIXI.Graphics),this._colorList=this._container.addChild(new c(this._getColorSamples(),App.ColorSample,d.X,i,Math.round(50*h),h)),this._topIconList=this._container.addChild(new c(l.slice(0,Math.floor(l.length/2)),e,d.X,i,m,h)),this._bottomIconList=this._container.addChild(new c(l.slice(Math.floor(l.length/2)),e,d.X,i,m,h)),this._subCategoryList=this._container.addChild(new App.SubCategoryList(n)),this._budgetHeader=this._container.addChild(new App.ListHeader("Budget",i,h)),this._budget=this._container.addChild(new g("Enter Budget",20,j,k,h,!0)),this._deleteButton=new App.PopUpButton("Delete","Are you sure you want to\ndelete this category with all its\ndata and sub-categories?",{width:j,height:k,pixelRatio:h,popUpLayout:{x:Math.round(10*h),y:0,width:Math.round(j-20*h),height:Math.round(a.height/2),overlayWidth:i,overlayHeight:0}}),this._renderAll=!0,this._budget.restrict(/\d{1,}(\.\d{0,2}){0,1}/g),this._pane.setContent(this._container),this.addChild(this._pane),this._swipeEnabled=!0},App.EditCategoryScreen.prototype=Object.create(App.InputScrollScreen.prototype),App.EditCategoryScreen.prototype._render=function(){var a=App.GraphicUtils,b=App.ColorTheme,c=this._layout.pixelRatio,d=this._layout.width,e=Math.round(60*c),f=this._colorList.boundingBox.height,g=d-2*this._inputPadding,h=this._getSelectedIcon(),i=this._colorList.getSelectedValue(),j=0;a.drawRect(this._colorStripe,"0x"+i,1,0,0,Math.round(4*c),Math.round(59*c)),this._icon&&(this._icon.setTexture(PIXI.TextureCache[h]),this._icon.tint=parseInt(i,16)),this._renderAll&&(this._renderAll=!1,this._icon=PIXI.Sprite.fromFrame(h),this._iconResizeRatio=Math.round(32*c)/this._icon.height,this._icon.scale.x=this._iconResizeRatio,this._icon.scale.y=this._iconResizeRatio,this._icon.x=Math.round(15*c),this._icon.y=Math.round((e-this._icon.height)/2),this._icon.tint=parseInt(i,16),this._container.addChild(this._icon),this._input.x=Math.round(60*c),this._input.y=Math.round((e-this._input.height)/2),this._colorList.y=e,this._topIconList.y=e+this._colorList.boundingBox.height,this._bottomIconList.y=this._topIconList.y+this._topIconList.boundingBox.height,this._subCategoryList.y=this._bottomIconList.y+this._bottomIconList.boundingBox.height,this._budget.x=this._inputPadding,this._separators.x=this._inputPadding),this._budgetHeader.y=this._subCategoryList.y+this._subCategoryList.boundingBox.height,j=this._budgetHeader.y+this._budgetHeader.height,this._budget.y=j+this._inputPadding,this._mode===App.ScreenMode.EDIT?(j+=e,this._deleteButton.setPosition(this._inputPadding,j+this._inputPadding),this._container.contains(this._deleteButton)||this._container.addChild(this._deleteButton)):this._container.contains(this._deleteButton)&&this._container.removeChild(this._deleteButton),a.drawRect(this._background,b.GREY,1,0,0,d,j+e),a.drawRects(this._separators,b.GREY_DARK,1,[0,e-1,g,1,0,e+f,g,1,0,j-1,g,1],!0,!1),a.drawRects(this._separators,b.GREY_LIGHT,1,[0,e,g,1,0,e+f+1,g,1,0,j,g,1],!1,!0)},App.EditCategoryScreen.prototype.hide=function(){this._unRegisterDeleteButtonListeners(),App.Screen.prototype.hide.call(this)},App.EditCategoryScreen.prototype.update=function(a,b){this._model=a,this._mode=b,this._input.setValue(this._model.name),this._model.color?this._colorList.selectItemByValue(this._model.color):this._colorList.selectItemByPosition(0),this._model.icon?(this._topIconList.selectItemByValue(this._model.icon),this._bottomIconList.selectItemByValue(this._model.icon)):(this._topIconList.selectItemByPosition(0),this._bottomIconList.selectItemByValue(-1e4)),this._subCategoryList.update(this._model,App.ScreenMode.EDIT),this._budget.setValue(this._model.budget),this._deleteButton.hidePopUp(!0),this._render(),this._pane.resize(),this.resetScroll()},App.EditCategoryScreen.prototype.enable=function(){App.Screen.prototype.enable.call(this),this._colorList.enable(),this._topIconList.enable(),this._bottomIconList.enable(),this._pane.enable()},App.EditCategoryScreen.prototype.disable=function(){App.Screen.prototype.disable.call(this),this._input.disable(),this._colorList.disable(),this._topIconList.disable(),this._bottomIconList.disable(),this._budget.disable(),this._pane.disable()},App.EditCategoryScreen.prototype._registerEventListeners=function(a){if(App.Screen.prototype._registerEventListeners.call(this,a),a===App.EventLevel.LEVEL_2){var b=App.EventType;this._scrollTween.addEventListener(b.COMPLETE,this,this._onScrollTweenComplete),this._input.addEventListener(b.BLUR,this,this._onInputBlur),this._budget.addEventListener(b.BLUR,this,this._onInputBlur)}},App.EditCategoryScreen.prototype._unRegisterEventListeners=function(a){App.Screen.prototype._unRegisterEventListeners.call(this,a);var b=App.EventType;this._scrollTween.removeEventListener(b.COMPLETE,this,this._onScrollTweenComplete),this._budget.removeEventListener(b.BLUR,this,this._onInputBlur),this._input.removeEventListener(b.BLUR,this,this._onInputBlur)},App.EditCategoryScreen.prototype._registerDeleteButtonListeners=function(){var a=App.EventType;this._deleteButton.addEventListener(a.CANCEL,this,this._onDeleteCancel),this._deleteButton.addEventListener(a.CONFIRM,this,this._onDeleteConfirm),this._deleteButton.addEventListener(a.COMPLETE,this,this._onHidePopUpComplete)},App.EditCategoryScreen.prototype._unRegisterDeleteButtonListeners=function(){var a=App.EventType;this._deleteButton.removeEventListener(a.CANCEL,this,this._onDeleteCancel),this._deleteButton.removeEventListener(a.CONFIRM,this,this._onDeleteConfirm),this._deleteButton.removeEventListener(a.COMPLETE,this,this._onHidePopUpComplete)},App.EditCategoryScreen.prototype._onDeleteCancel=function(){this._deleteButton.hidePopUp(),App.ViewLocator.getViewSegment(App.ViewName.HEADER).enableActions()},App.EditCategoryScreen.prototype._onDeleteConfirm=function(){var a=App.EventType,b=App.ModelLocator.getProxy(App.ModelName.CHANGE_SCREEN_DATA_POOL).allocate().update(App.ScreenName.BACK);this._onHidePopUpComplete(),App.ViewLocator.getViewSegment(App.ViewName.HEADER).enableActions(),b.updateBackScreen=!0,App.Controller.dispatchEvent(a.CHANGE_CATEGORY,{type:a.DELETE,category:this._model,nextCommand:new App.ChangeScreen,nextCommandData:b})},App.EditCategoryScreen.prototype._onHidePopUpComplete=function(){this._unRegisterDeleteButtonListeners(),this.enable(),this._registerEventListeners(App.EventLevel.LEVEL_2)},App.EditCategoryScreen.prototype._onClick=function(){this._pane.cancelScroll();var a=this._scrollState===App.TransitionState.SHOWN&&this._scrollInput,b=this.stage.getTouchData(),c=b.getLocalPosition(this._container),d=c.y;if(this._input.hitTest(d))this._scrollInput=this._input,this._focusInput(this._scrollInput.y+this._container.y>0),this._subCategoryList.closeButtons();else if(this._colorList.hitTest(d))this._onSampleClick(this._colorList,c.x,a);else if(this._topIconList.hitTest(d))this._onSampleClick(this._topIconList,c.x,a);else if(this._bottomIconList.hitTest(d))this._onSampleClick(this._bottomIconList,c.x,a);else if(this._subCategoryList.hitTest(d)){var e=this._subCategoryList.getItemUnderPoint(b);e&&(a&&this._scrollInput.blur(),e instanceof App.AddNewButton?App.Controller.dispatchEvent(App.EventType.CHANGE_SUB_CATEGORY,{type:App.EventType.CREATE,category:this._model,nextCommand:new App.ChangeScreen,nextCommandData:App.ModelLocator.getProxy(App.ModelName.CHANGE_SCREEN_DATA_POOL).allocate().update(App.ScreenName.EDIT,App.ScreenMode.ADD,null,0,0,App.ScreenTitle.ADD_SUB_CATEGORY)}):e.onClick(b,this._model)),this._subCategoryList.closeButtons()}else this._budget.hitTest(d)?(this._scrollInput=this._budget,this._focusInput(!1),this._subCategoryList.closeButtons()):this._deleteButton.hitTest(d)?a?this._scrollInput.blur():(this.disable(),this._unRegisterEventListeners(App.EventLevel.LEVEL_1),App.ViewLocator.getViewSegment(App.ViewName.HEADER).disableActions(),this._registerDeleteButtonListeners(),this._deleteButton.setPopUpLayout(0,this._container.y+this._layout.headerHeight,0,this._layout.contentHeight>this._container.height?this._layout.contentHeight:this._container.height),this._deleteButton.showPopUp()):a&&this._scrollInput.blur()
},App.EditCategoryScreen.prototype._onSampleClick=function(a,b,c){c&&this._scrollInput.blur(),a.cancelScroll();var d=a.selectItemByPosition(b);d instanceof App.ColorSample?(App.GraphicUtils.drawRect(this._colorStripe,"0x"+d.getValue(),1,0,0,this._colorStripe.width,this._colorStripe.height),this._icon.tint=parseInt(d.getValue(),16)):d instanceof App.IconSample&&(this._icon.setTexture(PIXI.TextureCache[d.getValue()]),(a===this._topIconList?this._bottomIconList:this._topIconList).selectItemByPosition(-1e4))},App.EditCategoryScreen.prototype._onHeaderClick=function(a){var b=App.EventType,c=App.ModelLocator.getProxy(App.ModelName.CHANGE_SCREEN_DATA_POOL).allocate().update(App.ScreenName.BACK),d={type:b.CONFIRM,category:this._model,name:this._input.getValue(),color:this._colorList.getSelectedValue(),icon:this._getSelectedIcon(),budget:this._budget.getValue(),nextCommand:new App.ChangeScreen,nextCommandData:c};this._scrollState===App.TransitionState.SHOWN&&this._scrollInput&&this._scrollInput.blur(),a===App.HeaderAction.CONFIRM?(this._model.clearSavedStates(),c.updateBackScreen=!0,App.Controller.dispatchEvent(b.CHANGE_CATEGORY,d)):a===App.HeaderAction.CANCEL&&(d.type=b.CANCEL,App.Controller.dispatchEvent(b.CHANGE_CATEGORY,d))},App.EditCategoryScreen.prototype._getSelectedIcon=function(){var a=this._topIconList.getSelectedValue();return a||(a=this._bottomIconList.getSelectedValue()),a},App.EditCategoryScreen.prototype._swipeStart=function(a,b){a||this._pane.cancelScroll(),this._subCategoryList.swipeStart(b)},App.EditCategoryScreen.prototype._swipeEnd=function(){this._subCategoryList.swipeEnd()},App.EditCategoryScreen.prototype._getColorSamples=function(){for(var a=App.MathUtils.rgbToHex,b=0,c=30,d=2*Math.PI/c,e=127,f=128,g=new Array(c);c>b;b++)g[b]=a(Math.round(Math.sin(d*b+0)*e+f),Math.round(Math.sin(d*b+2)*e+f),Math.round(Math.sin(d*b+4)*e+f));return g},App.TransactionButton=function(a,b){App.SwipeButton.call(this,b.width,b.openOffset);var c=PIXI.Text,d=PIXI.Graphics,e=b.labelStyles.edit;this.allocated=!1,this.poolIndex=a,this.boundingBox=new App.Rectangle(0,0,b.width,b.height),this._model=null,this._pixelRatio=b.pixelRatio,this._labelStyles=b.labelStyles,this._isPending=void 0,this._background=this.addChild(new d),this._copyLabel=this.addChild(new c("Copy",e)),this._editLabel=this.addChild(new c("Edit",e)),this._icon=null,this._iconResizeRatio=-1,this._swipeSurface=this.addChild(new PIXI.DisplayObjectContainer),this._redSkin=this._swipeSurface.addChild(new PIXI.Sprite(b.redSkin)),this._greySkin=this._swipeSurface.addChild(new PIXI.Sprite(b.greySkin)),this._colorStripe=this._swipeSurface.addChild(new d),this._accountField=this._swipeSurface.addChild(new c("",e)),this._categoryField=this._swipeSurface.addChild(new c("",e)),this._amountField=this._swipeSurface.addChild(new c("",e)),this._currencyField=this._swipeSurface.addChild(new c("",e)),this._dateField=this._swipeSurface.addChild(new c("",e)),this._pendingFlag=this._swipeSurface.addChild(new d),this._pendingLabel=this._pendingFlag.addChild(new c("PENDING",this._labelStyles.pending))},App.TransactionButton.prototype=Object.create(App.SwipeButton.prototype),App.TransactionButton.prototype._update=function(a){var b=this._model.pending,c=this._model.date,d=c.getMonth()+1+"/"+c.getDate()+"/"+c.getFullYear();this._accountField.setText(this._model.account.name),this._amountField.setText(this._model.amount),this._currencyField.setText(" "+this._model.currencyQuote),this._categoryField.setText(this._model.subCategory.name+" / "+this._model.category.name),this._dateField.setText(b?"Due by\n"+d:d),this._icon?this._icon.setTexture(PIXI.TextureCache[this._model.category.icon]):this._icon=this._swipeSurface.addChild(PIXI.Sprite.fromFrame(this._model.category.icon)),b!==this._isPending&&(b?(this._accountField.setStyle(this._labelStyles.accountPending),this._amountField.setStyle(this._labelStyles.amountPending),this._currencyField.setStyle(this._labelStyles.currencyPending),this._categoryField.setStyle(this._labelStyles.accountPending),this._dateField.setStyle(this._labelStyles.datePending)):(this._accountField.setStyle(this._labelStyles.accountIncome),this._amountField.setStyle(this._labelStyles.amountIncome),this._currencyField.setStyle(this._labelStyles.currencyIncome),this._categoryField.setStyle(this._labelStyles.accountIncome),this._dateField.setStyle(this._labelStyles.date))),this._render(a,b),this._updateLayout(a,b),this.close(!0),this._isPending=b},App.TransactionButton.prototype._render=function(a,b){var c=App.GraphicUtils,d=App.ColorTheme,e=this._pixelRatio,f=this.boundingBox.width,g=this.boundingBox.height,h=Math.round(this._openOffset/2);a&&(c.drawRects(this._background,d.GREEN,1,[0,0,f-h,g],!0,!1),c.drawRects(this._background,d.RED,1,[f-h,0,h,g],!1,!0),c.drawRect(this._pendingFlag,0,1,0,0,Math.round(this._pendingLabel.width+10*e),Math.round(this._pendingLabel.height+6*e))),c.drawRect(this._colorStripe,"0x"+this._model.category.color,1,0,0,Math.round(4*e),g),b!==this._isPending&&(b?(this._greySkin.visible=!1,this._redSkin.visible=!0,this._pendingFlag.visible=!0):(this._greySkin.visible=!0,this._redSkin.visible=!1,this._pendingFlag.visible=!1)),this._icon.tint=b?d.RED_DARK:parseInt(this._model.category.color,16)},App.TransactionButton.prototype._updateLayout=function(a,b){var c=this._pixelRatio,d=this.boundingBox.width,e=this.boundingBox.height,f=Math.round(60*c),g=Math.round(10*c);a&&(this._copyLabel.x=d-2*f+Math.round((f-this._copyLabel.width)/2),this._copyLabel.y=Math.round((e-this._copyLabel.height)/2),this._editLabel.x=d-f+Math.round((f-this._editLabel.width)/2),this._editLabel.y=Math.round((e-this._editLabel.height)/2),-1===this._iconResizeRatio&&(this._iconResizeRatio=Math.round(32*this._pixelRatio)/this._icon.height),this._icon.scale.x=this._iconResizeRatio,this._icon.scale.y=this._iconResizeRatio,this._icon.x=Math.round(20*c),this._icon.y=Math.round((e-this._icon.height)/2),this._accountField.x=Math.round(70*c),this._accountField.y=Math.round(7*c),this._amountField.x=Math.round(70*c),this._amountField.y=Math.round(26*c),this._currencyField.y=Math.round(33*c),this._categoryField.x=Math.round(70*c),this._categoryField.y=Math.round(52*c),this._pendingLabel.x=Math.round(5*c),this._pendingLabel.y=Math.round(4*c),this._pendingFlag.x=Math.round(d-g-this._pendingFlag.width),this._pendingFlag.y=Math.round(7*c)),this._currencyField.x=Math.round(this._amountField.x+this._amountField.width),this._dateField.x=Math.round(d-g-this._dateField.width),this._dateField.y=Math.round(b?38*c:52*c)},App.TransactionButton.prototype.setModel=function(a){this._model=a,this._update(null===this._icon)},App.TransactionButton.prototype.onClick=function(a){var b=a.getLocalPosition(this).x;if(this._isOpen&&b>=this._width-this._openOffset){var c=App.ModelLocator.getProxy(App.ModelName.CHANGE_SCREEN_DATA_POOL).allocate().update();b>=this._width-this._openOffset/2?(App.ModelLocator.getProxy(App.ModelName.TRANSACTIONS).setCurrent(this._model),c.screenMode=App.ScreenMode.EDIT,c.updateData=this._model,c.headerName=App.ScreenTitle.EDIT_TRANSACTION,App.Controller.dispatchEvent(App.EventType.CHANGE_SCREEN,c)):App.Controller.dispatchEvent(App.EventType.CHANGE_TRANSACTION,{type:App.EventType.COPY,transaction:this._model,nextCommand:new App.ChangeScreen,nextCommandData:c})}},App.TransactionButton.prototype._updateSwipePosition=function(a){this._swipeSurface.x=a},App.TransactionButton.prototype._getSwipePosition=function(){return this._swipeSurface.x},App.TransactionScreen=function(a){App.Screen.call(this,a,.4);var b=App.ScrollPolicy,c=a.pixelRatio,d=a.width,e=a.contentHeight;this._interactiveButton=null,this._buttonList=new App.VirtualList(App.ViewLocator.getViewSegment(App.ViewName.TRANSACTION_BUTTON_POOL),App.Direction.Y,d,e,c),this._pane=this.addChild(new App.TilePane(b.OFF,b.AUTO,d,e,c,!1)),this._pane.setContent(this._buttonList)},App.TransactionScreen.prototype=Object.create(App.Screen.prototype),App.TransactionScreen.prototype.enable=function(){App.Screen.prototype.enable.call(this),this._pane.enable(),this._swipeEnabled=!0},App.TransactionScreen.prototype.disable=function(){App.Screen.prototype.disable.call(this),this._pane.disable(),this._swipeEnabled=!1},App.TransactionScreen.prototype.update=function(a){this._model=a,this._buttonList.update(a),this._pane.resize()},App.TransactionScreen.prototype._swipeStart=function(a,b){this._interactiveButton=this._buttonList.getItemUnderPoint(this.stage.getTouchData()),this._interactiveButton&&this._interactiveButton.swipeStart(b),this._closeButtons(!1)},App.TransactionScreen.prototype._swipeEnd=function(){this._interactiveButton&&(this._interactiveButton.swipeEnd(),this._interactiveButton=null)},App.TransactionScreen.prototype._closeButtons=function(a){for(var b=0,c=this._buttonList.children.length,d=null;c>b;)d=this._buttonList.getChildAt(b++),d!==this._interactiveButton&&d.close(a)},App.TransactionScreen.prototype._onClick=function(){var a=this.stage.getTouchData(),b=this._buttonList.getItemUnderPoint(a);b&&b.onClick(a)},App.TransactionScreen.prototype._onHeaderClick=function(a){var b=App.HeaderAction,c=App.ModelLocator.getProxy(App.ModelName.CHANGE_SCREEN_DATA_POOL).allocate();a===b.ADD_TRANSACTION?App.Controller.dispatchEvent(App.EventType.CHANGE_TRANSACTION,{type:App.EventType.CREATE,nextCommand:new App.ChangeScreen,nextCommandData:c.update()}):a===b.MENU&&(c.update(App.ScreenName.MENU,0,null,b.NONE,b.CANCEL,App.ScreenTitle.MENU),App.Controller.dispatchEvent(App.EventType.CHANGE_SCREEN,c))},App.ReportSubCategoryButton=function(a,b){PIXI.DisplayObjectContainer.call(this),this.allocated=!1,this.poolIndex=a,this.boundingBox=new App.Rectangle(0,0,b.width,b.height),this._model=null,this._pixelRatio=b.pixelRatio,this._background=this.addChild(new PIXI.Sprite(b.skin)),this._colorStripe=this.addChild(new PIXI.Graphics),this._nameField=this.addChild(new PIXI.Text("",b.labelStyles.name)),this._percentField=this.addChild(new PIXI.Text("%",b.labelStyles.percent)),this._amountField=this.addChild(new PIXI.Text("",b.labelStyles.amount)),this._renderAll=!0},App.ReportSubCategoryButton.prototype=Object.create(PIXI.DisplayObjectContainer.prototype),App.ReportSubCategoryButton.prototype._render=function(a){var b=Math.round(10*this._pixelRatio),c=this.boundingBox.width,d=this.boundingBox.height;this._renderAll&&(this._renderAll=!1,this._nameField.x=2*b,this._nameField.y=Math.round((d-this._nameField.height)/2),this._percentField.y=Math.round((d-this._percentField.height)/2),this._amountField.y=Math.round((d-this._amountField.height)/2)),App.GraphicUtils.drawRect(this._colorStripe,a,1,0,0,Math.round(2*this._pixelRatio),d),this._percentField.x=Math.round(.7*c-this._percentField.width),this._amountField.x=Math.round(c-b-this._amountField.width)},App.ReportSubCategoryButton.prototype.setModel=function(a,b,c){this._model=a,this._nameField.setText(this._model.name),this._percentField.setText((this._model.balance/b*100).toFixed(1)+" %"),this._amountField.setText(App.StringUtils.formatNumber(Math.abs(this._model.balance),2,",")),this._render(c)},App.ReportSubCategoryButton.prototype._update=function(){this._nameField.setText(this._model.name),this._render()},App.ReportCategoryButton=function(a,b){App.ExpandButton.call(this,b.width,b.height,!1),this.allocated=!1,this.poolIndex=a,this._model=null,this._accountBalance=0,this._pixelRatio=b.pixelRatio,this._buttonPool=b.subCategoryButtonPool,this._background=this.addChild(new PIXI.Sprite(b.skin)),this._colorStripe=this.addChild(new PIXI.Graphics),this._nameField=this.addChild(new PIXI.Text("",b.labelStyles.name)),this._percentField=this.addChild(new PIXI.Text("%",b.labelStyles.percent)),this._amountField=this.addChild(new PIXI.Text("",b.labelStyles.amount)),this._subCategoryList=new App.List(App.Direction.Y),this._renderAll=!0,this._updated=!1,this._setContent(this._subCategoryList),this.addChild(this._subCategoryList)},App.ReportCategoryButton.prototype=Object.create(App.ExpandButton.prototype),App.ReportCategoryButton.prototype._render=function(){var a=Math.round(10*this._pixelRatio),b=this.boundingBox.width,c=this.boundingBox.height;this._renderAll&&(this._renderAll=!1,this._nameField.x=Math.round(15*this._pixelRatio),this._nameField.y=Math.round((c-this._nameField.height)/2),this._percentField.y=Math.round((c-this._percentField.height)/2),this._amountField.y=Math.round((c-this._amountField.height)/2)),App.GraphicUtils.drawRect(this._colorStripe,"0x"+this._model.color,1,0,0,Math.round(4*this._pixelRatio),c),this._percentField.x=Math.round(.7*b-this._percentField.width),this._amountField.x=Math.round(b-a-this._amountField.width)},App.ReportCategoryButton.prototype.setModel=function(a,b){this._updated=!1,this._model=a,this._accountBalance=b,this.close(!0),this._nameField.setText(this._model.name),this._percentField.setText((this._model.balance/this._accountBalance*100).toFixed(1)+" %"),this._amountField.setText(App.StringUtils.formatNumber(Math.abs(this._model.balance),2,",")),this._render()},App.ReportCategoryButton.prototype.getModel=function(){return this._model},App.ReportCategoryButton.prototype._update=function(){this._updated=!0;for(var a=0,b=this._subCategoryList.length,c=this._model.subCategories,d="0x"+this._model.color,e=null,f=null;b>a;a++)this._buttonPool.release(this._subCategoryList.removeItemAt(0));for(a=0,b=c.length;b>a;)e=c[a++],f=this._buttonPool.allocate(),f.setModel(e,this._accountBalance,d),this._subCategoryList.add(f);this._subCategoryList.updateLayout()},App.ReportCategoryButton.prototype.onClick=function(){var a=App.TransitionState;this._transitionState===a.CLOSED||this._transitionState===a.CLOSING?(this._updated||this._update(),this.open(!0)):(this._transitionState===a.OPEN||this._transitionState===a.OPENING)&&this.close(!1,!0)},App.ReportAccountButton=function(a,b){App.ExpandButton.call(this,b.width,b.height,!0),this.allocated=!1,this.poolIndex=a,this._model=null,this._height=b.height,this._pixelRatio=b.pixelRatio,this._buttonPool=b.categoryButtonPool,this._background=this.addChild(new PIXI.Graphics),this._nameField=this.addChild(new PIXI.Text("",b.labelStyles.name)),this._amountField=this.addChild(new PIXI.Text("",b.labelStyles.amount)),this._categoryList=new App.List(App.Direction.Y),this._interactiveButton=null,this._renderAll=!0,this._updated=!1,this._setContent(this._categoryList),this.addChild(this._categoryList)},App.ReportAccountButton.prototype=Object.create(App.ExpandButton.prototype),App.ReportAccountButton.prototype._render=function(){var a=this.boundingBox.width;if(this._renderAll){this._renderAll=!1;var b=App.GraphicUtils,c=App.ColorTheme,d=this.boundingBox.height;b.drawRects(this._background,c.BLUE,1,[0,0,a,d],!0,!1),b.drawRects(this._background,c.BLUE_DARK,1,[0,d-1,a,1],!1,!0),this._nameField.x=Math.round(10*this._pixelRatio),this._nameField.y=Math.round((d-this._nameField.height)/2),this._amountField.y=Math.round((d-this._amountField.height)/2)}this._amountField.x=Math.round(a-this._amountField.width-10*this._pixelRatio)},App.ReportAccountButton.prototype.setModel=function(a){this._updated=!1,this._model=a,this.close(!0),this._nameField.setText(this._model.name),this._amountField.setText(App.StringUtils.formatNumber(Math.abs(this._model.balance),2,",")),this._render()},App.ReportAccountButton.prototype.getModel=function(){return this._model},App.ReportAccountButton.prototype._update=function(){this._updated=!0;for(var a=0,b=this._categoryList.length,c=this._model.balance,d=this._model.categories,e=null,f=null;b>a;a++)this._buttonPool.release(this._categoryList.removeItemAt(0));for(a=0,b=d.length;b>a;)e=d[a++],f=this._buttonPool.allocate(),f.setModel(e,c),this._categoryList.add(f);this._categoryList.updateLayout()},App.ReportAccountButton.prototype._closeButtons=function(a){for(var b=0,c=this._categoryList.children.length,d=null;c>b;)d=this._categoryList.getChildAt(b++),d!==this._interactiveButton&&d.isOpen()&&d.close(a)},App.ReportAccountButton.prototype.onClick=function(a){var b=a.getLocalPosition(this).y,c=App.TransitionState;return b<=this._height?(this._transitionState===c.CLOSED||this._transitionState===c.CLOSING?this.open():(this._transitionState===c.OPEN||this._transitionState===c.OPENING)&&this.close(!1,!0),null):b>this._height&&(this._interactiveButton=this._categoryList.getItemUnderPoint(a),this._interactiveButton)?(this._interactiveButton.onClick(b),this._closeButtons(),this._interactiveButton):null},App.ReportAccountButton.prototype.open=function(){this._updated||this._update(),this._interactiveButton=null,this._closeButtons(!0),App.ExpandButton.prototype.open.call(this,!0)},App.ReportAccountButton.prototype.updateLayout=function(){this._categoryList.updateLayout(),this._updateBounds(!0),this._updateMask()},App.ReportAccountButton.prototype.isInTransition=function(){var a=App.ExpandButton.prototype.isInTransition.call(this),b=0,c=this._categoryList.children.length;if(this.isOpen())for(;c>b;)if(this._categoryList.getChildAt(b++).isInTransition()){a=!0;break}return a},App.ReportChartHighlight=function(a,b,c,d){PIXI.Graphics.call(this),this._width=b,this._height=c,this._center=a,this._thickness=d,this._oldStart=0,this._oldEnd=0,this._oldSteps=0,this._start=0,this._end=0,this._steps=10,this._color=0},App.ReportChartHighlight.prototype=Object.create(PIXI.Graphics.prototype),App.ReportChartHighlight.prototype.change=function(a){this._oldStart=this._start,this._oldEnd=this._end,this._oldSteps=this._steps,a?(this._start=a.startAngle,this._end=a.endAngle,this._steps=a.steps,this._color="0x"+a.color):(this._start=0,this._end=0,this._steps=10)},App.ReportChartHighlight.prototype.update=function(a){var b=this._oldStart+(this._start-this._oldStart)*a,c=this._oldEnd+(this._end-this._oldEnd)*a,d=this._end===this._start?1-a:1,e=Math.round(this._oldSteps+(this._steps-this._oldSteps)*a);App.GraphicUtils.drawArc(this,this._center,this._width,this._height,this._thickness,b,c,e,0,0,0,this._color,d)},App.ReportChartSegment=function(a){PIXI.Graphics.call(this),this.allocated=!1,this.poolIndex=a,this._model=null,this.color=0,this.fraction=0,this.startAngle=0,this.endAngle=0,this.steps=10,this.fullyRendered=!1},App.ReportChartSegment.prototype=Object.create(PIXI.Graphics.prototype),App.ReportChartSegment.prototype.setModel=function(a,b,c){this._model=a,this.color=this._model.color,this.fraction=this._model.balance/b,this.startAngle=360*Math.abs(c/b),this.endAngle=this.startAngle+360*this.fraction,this.steps=Math.ceil(60*this.fraction),this.fullyRendered=!1,this.clear()},App.ReportChartSegment.prototype.rendersModel=function(a){return this._model===a},App.ReportChart=function(a,b,c,d){var e=App.ModelLocator,f=App.ModelName,g=e.getProxy(f.EVENT_LISTENER_POOL);PIXI.Graphics.call(this),this.boundingBox=new App.Rectangle(0,0,b,c),this._model=a,this._eventsRegistered=!1,this._ticker=e.getProxy(f.TICKER),this._segmentTween=new App.TweenProxy(1,App.Easing.outExpo,0,g),this._highlightTween=new App.TweenProxy(1,App.Easing.outExpo,0,g),this._segmentPool=new App.ObjectPool(App.ReportChartSegment,5),this._segments=null,this._showSegments=void 0,this._hideSegments=void 0,this._highlightSegment=void 0,this._center=new PIXI.Point(Math.round(b/2),Math.round(c/2)),this._thickness=Math.round(.07*b*d),this._chartSize=b-Math.round(5*d*2),this._highlight=this.addChild(new App.ReportChartHighlight(this._center,b,c,Math.round(3*d)))},App.ReportChart.prototype=Object.create(PIXI.Graphics.prototype),App.ReportChart.prototype.update=function(){var a=0,b=this._model.length(),c=0,d=0,e=0,f=0,g=App.LifeCycleState.DELETED,h=null,i=null,j=null,k=null,l=null;if(this._showSegments=null,this._hideSegments=null,this._highlight.change(null),this._highlight.update(1),this._segments)for(var m in this._segments)for(h=this._segments[m];h.length;)i=h.pop(),this.removeChild(i),this._segmentPool.release(i);else this._segments=Object.create(null);for(a=0;b>a;)if(j=this._model.getItemAt(a++),e=j.balance,j.lifeCycleState!==g&&!isNaN(e)&&0!==e)for(this._segments[j.id]||(this._segments[j.id]=[]),h=this._segments[j.id],f=0,k=null,l=j.categories,c=0,d=l.length;d>c;)k&&(f+=k.balance),k=l[c++],i=this._segmentPool.allocate(),i.setModel(k,e,f),h.push(i),this.addChild(i)},App.ReportChart.prototype.showSegments=function(a){if(this._showSegments){if(this._showSegments===this._segments[a.id])return;this._hideSegments=this._showSegments}else this._hideSegments=null;this._showSegments=this._segments[a.id];for(var b=0,c=this._showSegments.length;c>b;)this._showSegments[b++].fullyRendered=!1;this._registerEventListeners(),this._segmentTween.restart()},App.ReportChart.prototype.highlightSegment=function(a){if(this._showSegments){var b=this._getSegmentByCategory(a);if(b===this._highlightSegment)return;this._highlightSegment=b,this._highlight.change(b),this._registerEventListeners(),this._highlightTween.restart()}},App.ReportChart.prototype._getSegmentByCategory=function(a){for(var b=0,c=this._showSegments.length;c>b;b++)if(this._showSegments[b].rendersModel(a))return this._showSegments[b];return null},App.ReportChart.prototype._registerEventListeners=function(){this._eventsRegistered||(this._eventsRegistered=!0,this._ticker.addEventListener(App.EventType.TICK,this,this._onTick),this._segmentTween.addEventListener(App.EventType.COMPLETE,this,this._onSegmentTweenComplete),this._highlightTween.addEventListener(App.EventType.COMPLETE,this,this._onHighlightTweenComplete))},App.ReportChart.prototype._unRegisterEventListeners=function(){this._ticker.removeEventListener(App.EventType.TICK,this,this._onTick),this._segmentTween.removeEventListener(App.EventType.COMPLETE,this,this._onSegmentTweenComplete),this._highlightTween.removeEventListener(App.EventType.COMPLETE,this,this._onHighlightTweenComplete),this._eventsRegistered=!1},App.ReportChart.prototype._onTick=function(){this._segmentTween.isRunning()&&this._updateSegmentTween(),this._highlightTween.isRunning()&&this._highlight.update(this._highlightTween.progress)},App.ReportChart.prototype._updateSegmentTween=function(){var a=App.GraphicUtils,b=this._segmentTween.progress,c=360*b,d=this._chartSize,e=0,f=this._showSegments.length,g=0,h=null;if(this._showSegments)for(;f>e;e++)h=this._showSegments[e],c>=h.startAngle&&!h.fullyRendered&&(g=c,g>=h.endAngle&&(g=h.endAngle,h.fullyRendered=!0),a.drawArc(h,this._center,d,d,this._thickness,h.startAngle,g,h.steps,0,0,0,"0x"+h.color,1));if(this._hideSegments)for(b=1-b,d=this._chartSize*b,e=0,f=this._hideSegments.length;f>e;e++)h=this._hideSegments[e],a.drawArc(h,this._center,d,d,this._thickness,h.startAngle,h.endAngle,20,0,0,0,"0x"+h.color,b)},App.ReportChart.prototype._onSegmentTweenComplete=function(){this._segmentTween.isRunning()||this._highlightTween.isRunning()||this._unRegisterEventListeners(),this._updateSegmentTween()},App.ReportChart.prototype._onHighlightTweenComplete=function(){this._segmentTween.isRunning()||this._highlightTween.isRunning()||this._unRegisterEventListeners(),this._highlight.update(1)},App.ReportScreen=function(a){App.Screen.call(this,a,.4);var b=App.ScrollPolicy,c=App.FontStyle,d=App.ObjectPool,e=a.contentHeight,f=a.pixelRatio,g=Math.round(.3*e-20*f),h=Math.round(a.width-20*f),i=Math.round(.7*e),j=Math.round(40*f),k=App.ViewLocator.getViewSegment(App.ViewName.SKIN),l={width:h,height:j,pixelRatio:f,labelStyles:{name:c.get(20,c.WHITE,null,c.LIGHT_CONDENSED),amount:c.get(16,c.WHITE)},categoryButtonPool:new d(App.ReportCategoryButton,5,{width:h,height:j,pixelRatio:f,skin:k.NARROW_GREY_40,labelStyles:{name:c.get(18,c.BLUE),percent:c.get(14,c.GREY_DARK),amount:c.get(14,c.BLUE)},subCategoryButtonPool:new d(App.ReportSubCategoryButton,5,{width:h,height:j,pixelRatio:f,skin:k.NARROW_WHITE_40,labelStyles:{name:c.get(14,c.BLUE),percent:c.get(14,c.GREY_DARK),amount:c.get(14,c.BLUE)}})})};this._model=App.ModelLocator.getProxy(App.ModelName.ACCOUNTS),this._buttonPool=new d(App.ReportAccountButton,2,l),this._chart=this.addChild(new App.ReportChart(this._model,g,g,f)),this._buttonList=new App.TileList(App.Direction.Y,i),this._pane=this.addChild(new App.TilePane(b.OFF,b.AUTO,h,i,f,!0)),this._pane.setContent(this._buttonList),this._updateLayout(),this._interactiveButton=null,this._layoutDirty=!1},App.ReportScreen.prototype=Object.create(App.Screen.prototype),App.ReportScreen.prototype.enable=function(){App.Screen.prototype.enable.call(this),this._pane.enable()},App.ReportScreen.prototype.disable=function(){App.Screen.prototype.disable.call(this),this._layoutDirty=!1,this._pane.disable()},App.ReportScreen.prototype.update=function(){for(var a=0,b=this._buttonList.length,c=App.LifeCycleState.DELETED,d=null,e=null,f=0;b>a;a++)this._buttonPool.release(this._buttonList.removeItemAt(0));for(a=0,b=this._model.length();b>a;)d=this._model.getItemAt(a++),f=d.calculateBalance(),d.lifeCycleState===c||isNaN(f)||0===f||(e=this._buttonPool.allocate(),e.setModel(d),this._buttonList.add(e));this._buttonList.updateLayout(!0),this._pane.resize(),this._chart.update()},App.ReportScreen.prototype._onTweenComplete=function(){if(App.Screen.prototype._onTweenComplete.call(this),this._transitionState===App.TransitionState.SHOWN){var a=this._buttonList.getItemAt(0);a.isOpen()||a.open(),this._chart.showSegments(a.getModel()),this._layoutDirty=!0}},App.ReportScreen.prototype._updateLayout=function(){var a=this._layout.width,b=Math.round(10*this._layout.pixelRatio),c=this._chart.boundingBox;this._chart.x=Math.round((a-c.width)/2),this._chart.y=b,this._pane.x=b,this._pane.y=Math.round(.3*this._layout.contentHeight)},App.ReportScreen.prototype._onTick=function(){App.Screen.prototype._onTick.call(this),this._layoutDirty&&(this._layoutDirty=this._buttonsInTransition(),this._updateListLayout(!1))},App.ReportScreen.prototype._closeButtons=function(a){for(var b=0,c=this._buttonList.children.length,d=null;c>b;)d=this._buttonList.getChildAt(b++),d!==this._interactiveButton&&d.isOpen()&&d.close(a)},App.ReportScreen.prototype._onClick=function(){var a=this.stage.getTouchData(),b=!1,c=null;this._interactiveButton=this._buttonList.getItemUnderPoint(a),this._interactiveButton&&(b=this._interactiveButton.isOpen(),c=this._interactiveButton.onClick(a),c?this._chart.highlightSegment(c.isOpening()?c.getModel():null):(this._closeButtons(),this._chart.highlightSegment(null),b||this._chart.showSegments(this._interactiveButton.getModel())),this._pane.cancelScroll(),this._layoutDirty=!0)},App.ReportScreen.prototype._onHeaderClick=function(a){var b=App.HeaderAction,c=App.ModelLocator.getProxy(App.ModelName.CHANGE_SCREEN_DATA_POOL).allocate();a===b.ADD_TRANSACTION?App.Controller.dispatchEvent(App.EventType.CHANGE_TRANSACTION,{type:App.EventType.CREATE,nextCommand:new App.ChangeScreen,nextCommandData:c.update()}):a===b.MENU&&App.Controller.dispatchEvent(App.EventType.CHANGE_SCREEN,c.update(App.ScreenName.MENU,0,null,b.NONE,b.CANCEL,App.ScreenTitle.MENU))},App.ReportScreen.prototype._updateListLayout=function(){this._interactiveButton&&this._interactiveButton.updateLayout(),this._buttonList.updateLayout(!0),this._pane.resize()},App.ReportScreen.prototype._buttonsInTransition=function(){for(var a=0,b=this._buttonList.children.length,c=!1;b>a;)if(this._buttonList.getChildAt(a++).isInTransition()){c=!0;break}return c},App.CurrencyButton=function(a,b){App.SwipeButton.call(this,b.width,b.openOffset),this.allocated=!1,this.poolIndex=a,this.boundingBox=new PIXI.Rectangle(0,0,b.width,b.height),this._model=null,this._pixelRatio=b.pixelRatio,this._skin=this.addChild(new PIXI.Sprite(b.skin)),this._symbolLabel=this.addChild(new PIXI.Text("",b.symbolLabelStyle)),this._renderAll=!0,this._render()},App.CurrencyButton.prototype=Object.create(PIXI.DisplayObjectContainer.prototype),App.CurrencyButton.prototype._render=function(){this._renderAll&&(this._renderAll=!1,this._symbolLabel.x=Math.round(20*this._pixelRatio),this._symbolLabel.y=Math.round((this.boundingBox.height-this._symbolLabel.height)/2))},App.CurrencyButton.prototype.setModel=function(a){this._model=a,this._symbolLabel.setText(this._model.symbol)},App.CurrencyButton.prototype.onClick=function(){var a=App.EventType,b=App.ModelLocator.getProxy(App.ModelName.CHANGE_SCREEN_DATA_POOL).allocate().update(App.ScreenName.BACK);b.updateBackScreen=!0,App.Controller.dispatchEvent(a.CHANGE_TRANSACTION,{type:a.CHANGE,currencyQuote:this._model.symbol,nextCommand:new App.ChangeScreen,nextCommandData:b})},App.CurrencyScreen=function(a){App.Screen.call(this,a,.4);var b=App.ScrollPolicy,c=App.FontStyle,d=a.contentHeight,e=a.width,f=a.pixelRatio,g={width:e,height:Math.round(50*f),pixelRatio:f,skin:App.ViewLocator.getViewSegment(App.ViewName.SKIN).GREY_50,symbolLabelStyle:c.get(18,c.BLUE)};this._model=App.ModelLocator.getProxy(App.ModelName.CURRENCY_SYMBOLS),this._interactiveButton=null,this._buttonPool=new App.ObjectPool(App.CurrencyButton,4,g),this._buttonList=new App.VirtualList(this._buttonPool,App.Direction.Y,e,d,f),this._pane=this.addChild(new App.TilePane(b.OFF,b.AUTO,e,d,f,!1)),this._pane.setContent(this._buttonList),this._initialized=!1},App.CurrencyScreen.prototype=Object.create(App.Screen.prototype),App.CurrencyScreen.prototype.enable=function(){App.Screen.prototype.enable.call(this),this._pane.resetScroll(),this._pane.enable()},App.CurrencyScreen.prototype.disable=function(){App.Screen.prototype.disable.call(this),this._pane.disable()},App.CurrencyScreen.prototype.update=function(){this._initialized?(this._pane.resetScroll(),this._buttonList.reset()):(this._initialized=!0,this._buttonList.update(this._model.copySource()),this._pane.resize())},App.CurrencyScreen.prototype._onClick=function(){var a=this._buttonList.getItemUnderPoint(this.stage.getTouchData());a&&a.onClick()},App.CurrencyScreen.prototype._onHeaderClick=function(a){a===App.HeaderAction.CANCEL&&App.Controller.dispatchEvent(App.EventType.CHANGE_SCREEN,App.ModelLocator.getProxy(App.ModelName.CHANGE_SCREEN_DATA_POOL).allocate().update(App.ScreenName.BACK))},App.CurrencyPairButton=function(a,b){App.SwipeButton.call(this,b.width,b.openOffset),this.allocated=!1,this.poolIndex=a,this.boundingBox=new PIXI.Rectangle(0,0,b.width,b.height),this._model=null,this._pixelRatio=b.pixelRatio,this._background=this.addChild(new PIXI.Graphics),this._editLabel=this.addChild(new PIXI.Text("Edit",b.editLabelStyle)),this._swipeSurface=this.addChild(new PIXI.DisplayObjectContainer),this._skin=this._swipeSurface.addChild(new PIXI.Sprite(b.skin)),this._pairLabel=this._swipeSurface.addChild(new PIXI.Text("EUR/USD",b.pairLabelStyle)),this._rateLabel=this._swipeSurface.addChild(new PIXI.Text("@ 1.0",b.rateLabelStyle)),this._renderAll=!0,this._render()},App.CurrencyPairButton.prototype=Object.create(App.SwipeButton.prototype),App.CurrencyPairButton.prototype._render=function(){var a=this.boundingBox.width,b=this.boundingBox.height,c=this._pixelRatio,d=Math.round(15*c);App.GraphicUtils.drawRect(this._background,App.ColorTheme.RED,1,0,0,a,b),this._editLabel.x=Math.round(a-50*this._pixelRatio),this._editLabel.y=Math.round((b-this._editLabel.height)/2),this._pairLabel.x=d,this._pairLabel.y=Math.round((b-this._pairLabel.height)/2),this._rateLabel.x=Math.round(d+this._pairLabel.width+5*c),this._rateLabel.y=Math.round((b-this._rateLabel.height)/2)},App.CurrencyPairButton.prototype.setModel=function(a){this._model=a,this._pairLabel.setText(a.base+"/"+a.symbol),this._rateLabel.setText("@ "+a.rate)},App.CurrencyPairButton.prototype.onClick=function(a){this._isOpen&&a.getLocalPosition(this).x>=this._width-this._openOffset&&App.Controller.dispatchEvent(App.EventType.CHANGE_SCREEN,App.ModelLocator.getProxy(App.ModelName.CHANGE_SCREEN_DATA_POOL).allocate().update(App.ScreenName.EDIT_CURRENCY_RATE,App.ScreenMode.EDIT,this._model,0,0,App.ScreenTitle.EDIT_CURRENCY_RATE))},App.CurrencyPairButton.prototype._updateSwipePosition=function(a){this._swipeSurface.x=a},App.CurrencyPairButton.prototype._getSwipePosition=function(){return this._swipeSurface.x},App.CurrencyPairScreen=function(a){App.Screen.call(this,a,.4);var b=App.ScrollPolicy,c=App.FontStyle,d=a.pixelRatio,e=a.contentHeight-Math.round(60*d),f=a.width,g=App.ViewLocator.getViewSegment(App.ViewName.SKIN),h={width:f,height:Math.round(50*d),pixelRatio:d,skin:g.GREY_50,editLabelStyle:c.get(18,c.WHITE,null,c.LIGHT_CONDENSED),pairLabelStyle:c.get(18,c.BLUE),rateLabelStyle:c.get(18,c.BLUE,null,c.LIGHT_CONDENSED),openOffset:Math.round(80*d)};
this._model=App.ModelLocator.getProxy(App.ModelName.CURRENCY_PAIRS),this._interactiveButton=null,this._downloadButtonBackground=this.addChild(new PIXI.Sprite(g.GREY_60)),this._downloadButton=this.addChild(new App.Button("Update rates from internet",{width:Math.round(f-20*d),height:Math.round(40*d),pixelRatio:d,style:c.get(18,c.BLACK_LIGHT,null,c.LIGHT_CONDENSED),backgroundColor:App.ColorTheme.GREY_DARK})),this._buttonPool=new App.ObjectPool(App.CurrencyPairButton,4,h),this._buttonList=new App.VirtualList(this._buttonPool,App.Direction.Y,f,e,d),this._pane=this.addChild(new App.TilePane(b.OFF,b.AUTO,f,e,d,!0)),this._pane.setContent(this._buttonList),this._swipeEnabled=!0,this._initialized=!1},App.CurrencyPairScreen.prototype=Object.create(App.Screen.prototype),App.CurrencyPairScreen.prototype._render=function(){var a=Math.round(10*this._layout.pixelRatio),b=this._downloadButton.boundingBox.height+2*a;this._downloadButton.x=a,this._downloadButton.y=a,this._pane.y=b},App.CurrencyPairScreen.prototype.enable=function(){App.Screen.prototype.enable.call(this),this._pane.resetScroll(),this._pane.enable()},App.CurrencyPairScreen.prototype.disable=function(){App.Screen.prototype.disable.call(this),this._pane.disable()},App.CurrencyPairScreen.prototype.update=function(){this._initialized?(this._pane.resetScroll(),this._buttonList.reset()):(this._initialized=!0,this._render(),this._buttonList.update(this._model.copySource()),this._pane.resize())},App.CurrencyPairScreen.prototype._onTweenComplete=function(){App.Screen.prototype._onTweenComplete.call(this),this._transitionState===App.TransitionState.HIDDEN&&this._closeButtons(!0)},App.CurrencyPairScreen.prototype._swipeStart=function(a,b){var c=this._buttonList.getItemUnderPoint(this.stage.getTouchData());c&&(a||this._pane.cancelScroll(),this._interactiveButton=c,this._interactiveButton.swipeStart(b),this._closeButtons(!1))},App.CurrencyPairScreen.prototype._swipeEnd=function(){this._interactiveButton&&(this._interactiveButton.swipeEnd(),this._interactiveButton=null)},App.CurrencyPairScreen.prototype._closeButtons=function(a){for(var b=0,c=this._buttonList.children.length,d=null;c>b;)d=this._buttonList.getChildAt(b++),d!==this._interactiveButton&&d.close(a)},App.CurrencyPairScreen.prototype._onClick=function(){var a=this.stage.getTouchData(),b=this._buttonList.getItemUnderPoint(a);b&&b.onClick(a)},App.CurrencyPairScreen.prototype._onHeaderClick=function(a){var b=App.HeaderAction,c=App.ModelLocator.getProxy(App.ModelName.CHANGE_SCREEN_DATA_POOL).allocate();a===b.ADD_TRANSACTION?App.Controller.dispatchEvent(App.EventType.CHANGE_TRANSACTION,{type:App.EventType.CREATE,nextCommand:new App.ChangeScreen,nextCommandData:c.update()}):a===b.MENU&&App.Controller.dispatchEvent(App.EventType.CHANGE_SCREEN,c.update(App.ScreenName.MENU,0,null,b.NONE,b.CANCEL,App.ScreenTitle.MENU))},App.EditCurrencyPairScreen=function(a){App.Screen.call(this,a,.4);var b=App.FontStyle,c=a.pixelRatio,d=a.width;this._background=this.addChild(new PIXI.Graphics),this._pairLabel=this.addChild(new PIXI.Text("EUR / USD",App.FontStyle.get(24,App.FontStyle.BLUE))),this._input=this.addChild(new App.Input("",20,Math.round(a.width-this._pairLabel.width-Math.round(50*c)),Math.round(40*c),c)),this._downloadButton=this.addChild(new App.Button("Update rate from internet",{width:Math.round(d-20*c),height:Math.round(40*c),pixelRatio:c,style:b.get(18,b.BLACK_LIGHT,null,b.LIGHT_CONDENSED),backgroundColor:App.ColorTheme.GREY_DARK})),this._input.restrict(/\d{1,}(\.\d*){0,1}/g),this._render()},App.EditCurrencyPairScreen.prototype=Object.create(App.Screen.prototype),App.EditCurrencyPairScreen.prototype._render=function(){var a=App.GraphicUtils,b=App.ColorTheme,c=this._layout.pixelRatio,d=this._layout.width,e=Math.round(10*c),f=Math.round(60*c);this._pairLabel.x=2*e,this._pairLabel.y=Math.round(22*c),this._input.x=Math.round(d-e-this._input.width),this._input.y=e,this._downloadButton.x=e,this._downloadButton.y=f+e,a.drawRects(this._background,b.GREY,1,[0,0,d,2*f],!0,!1),a.drawRects(this._background,b.GREY_DARK,1,[e,f-1,d-2*e,1],!1,!1),a.drawRects(this._background,b.GREY_LIGHT,1,[e,f,d-2*e,1],!1,!0)},App.EditCurrencyPairScreen.prototype.enable=function(){App.Screen.prototype.enable.call(this),this._input.enable()},App.EditCurrencyPairScreen.prototype.disable=function(){App.Screen.prototype.disable.call(this),this._input.disable()},App.EditCurrencyPairScreen.prototype.update=function(a){this._model=a,this._pairLabel.setText(this._model.base+" / "+this._model.symbol),this._input.setValue(this._model.rate)},App.EditCurrencyPairScreen.prototype._onHeaderClick=function(a){var b=App.ModelLocator.getProxy(App.ModelName.CHANGE_SCREEN_DATA_POOL).allocate().update(App.ScreenName.BACK);b.updateBackScreen=!0,this._input.blur(),a===App.HeaderAction.CONFIRM?App.Controller.dispatchEvent(App.EventType.CHANGE_CURRENCY_PAIR,{currencyPair:this._model,rate:this._input.getValue(),nextCommand:new App.ChangeScreen,nextCommandData:b}):a===App.HeaderAction.CANCEL&&App.Controller.dispatchEvent(App.EventType.CHANGE_SCREEN,b)},App.MenuItem=function(a,b,c,d){PIXI.Graphics.call(this),this.boundingBox=new App.Rectangle(0,0,d.width,d.height),this._screenName=c,this._pixelRatio=d.pixelRatio,this._icon=PIXI.Sprite.fromFrame(b),this._iconResizeRatio=Math.round(22*d.pixelRatio)/this._icon.height,this._labelField=new PIXI.Text(a,d.style),this._render(),this.addChild(this._icon),this.addChild(this._labelField)},App.MenuItem.prototype=Object.create(PIXI.Graphics.prototype),App.MenuItem.prototype._render=function(){var a=App.ColorTheme,b=this.boundingBox.height;this._icon.scale.x=this._iconResizeRatio,this._icon.scale.y=this._iconResizeRatio,this._icon.x=Math.round(15*this._pixelRatio),this._icon.y=Math.round((b-this._icon.height)/2),this._icon.tint=a.WHITE,this._labelField.x=Math.round(60*this._pixelRatio),this._labelField.y=Math.round((b-this._labelField.height)/2),App.GraphicUtils.drawRect(this,a.BLUE,1,0,0,this.boundingBox.width,b)},App.MenuItem.prototype.getScreenName=function(){return this._screenName},App.Menu=function(a){App.Screen.call(this,a);var b=App.MenuItem,c=App.ScreenName,d=App.FontStyle,e=a.pixelRatio,f=a.width,g=d.get(20,d.WHITE,null,d.LIGHT_CONDENSED),h={width:f,height:Math.round(40*e),pixelRatio:e,style:g};this._addTransactionItem=new b("Add Transaction","transactions",c.ADD_TRANSACTION,{width:f,height:Math.round(50*e),pixelRatio:e,style:g}),this._accountsItem=new b("Accounts","account",c.ACCOUNT,h),this._reportItem=new b("Report","chart",c.REPORT,h),this._budgetItem=new b("Budgets","budget",-1,h),this._transactionsItem=new b("Transactions","transactions",c.TRANSACTIONS,h),this._currenciesItem=new b("Currency rates","currencies",c.CURRENCY_PAIRS,h),this._settignsItem=new b("Settings","settings-app",c.SETTINGS,h),this._container=new PIXI.Graphics,this._pane=new App.Pane(App.ScrollPolicy.OFF,App.ScrollPolicy.AUTO,f,a.contentHeight,e,!1),this._background=new PIXI.Graphics,this._items=[],this._render(),this.addChild(this._background),this._items.push(this._container.addChild(this._addTransactionItem)),this._items.push(this._container.addChild(this._accountsItem)),this._items.push(this._container.addChild(this._reportItem)),this._items.push(this._container.addChild(this._budgetItem)),this._items.push(this._container.addChild(this._transactionsItem)),this._items.push(this._container.addChild(this._currenciesItem)),this._items.push(this._container.addChild(this._settignsItem)),this._pane.setContent(this._container),this.addChild(this._pane)},App.Menu.prototype=Object.create(App.Screen.prototype),App.Menu.prototype._render=function(){var a=this._layout.pixelRatio,b=Math.round(2*a),c=Math.round(25*a),d=App.GraphicUtils,e=App.ColorTheme.BLUE_DARK;this._accountsItem.y=this._addTransactionItem.boundingBox.height+c,this._reportItem.y=this._accountsItem.y+this._accountsItem.boundingBox.height+b,this._budgetItem.y=this._reportItem.y+this._reportItem.boundingBox.height+b,this._transactionsItem.y=this._budgetItem.y+this._budgetItem.boundingBox.height+b,this._currenciesItem.y=this._transactionsItem.y+this._transactionsItem.boundingBox.height+c,this._settignsItem.y=this._currenciesItem.y+this._currenciesItem.boundingBox.height+b,d.drawRect(this._container,e,1,0,0,this._layout.width,this._settignsItem.y+this._settignsItem.boundingBox.height),d.drawRect(this._background,e,1,0,0,this._layout.width,this._layout.contentHeight)},App.Menu.prototype.enable=function(){this._enabled||(this._registerEventListeners(App.EventLevel.LEVEL_1),this._registerEventListeners(App.EventLevel.LEVEL_2),this._pane.resetScroll(),this._pane.enable(),this._enabled=!0)},App.Menu.prototype.disable=function(){App.Screen.prototype.disable.call(this),this._pane.disable()},App.Menu.prototype._onClick=function(){this._pane.cancelScroll();var a=App.ScreenName,b=App.ScreenTitle,c=App.HeaderAction,d=this._getItemByPosition(this.stage.getTouchData().getLocalPosition(this._container).y),e=d?d.getScreenName():a.BACK,f=App.ModelLocator.getProxy(App.ModelName.CHANGE_SCREEN_DATA_POOL).allocate().update(e,0,null,c.MENU,c.ADD_TRANSACTION);switch(e){case a.ADD_TRANSACTION:App.Controller.dispatchEvent(App.EventType.CHANGE_TRANSACTION,{type:App.EventType.CREATE,nextCommand:new App.ChangeScreen,nextCommandData:f.update()});break;case a.ACCOUNT:f.screenMode=App.ScreenMode.EDIT,f.headerName=b.ACCOUNTS,App.Controller.dispatchEvent(App.EventType.CHANGE_SCREEN,f);break;case a.REPORT:f.headerName=b.REPORT,App.Controller.dispatchEvent(App.EventType.CHANGE_SCREEN,f);break;case a.TRANSACTIONS:f.headerName=b.TRANSACTIONS,f.updateData=App.ModelLocator.getProxy(App.ModelName.TRANSACTIONS).copySource().reverse(),App.Controller.dispatchEvent(App.EventType.CHANGE_SCREEN,f);break;case a.CURRENCY_PAIRS:f.screenMode=App.ScreenMode.EDIT,f.headerName=b.CURRENCY_RATES,App.Controller.dispatchEvent(App.EventType.CHANGE_SCREEN,f);break;case a.SETTINGS:f.headerName=b.SETTINGS,App.Controller.dispatchEvent(App.EventType.CHANGE_SCREEN,f)}},App.Menu.prototype._getItemByPosition=function(a){for(var b=0,c=this._items.length,d=null;c>b;)if(d=this._items[b++],a>=d.y&&a<d.y+d.boundingBox.height)return d;return null},App.SettingScreen=function(a){App.Screen.call(this,a,.4);var b=App.TransactionOptionButton,c=App.FontStyle,d=App.ViewLocator.getViewSegment(App.ViewName.SKIN),e=a.pixelRatio,f=a.width,g=f-2*Math.round(10*e),h={pixelRatio:e,width:f,height:Math.round(50*e),skin:d.GREY_50,nameStyle:c.get(18,c.GREY_DARKER,null,c.LIGHT_CONDENSED),valueStyle:c.get(18,c.BLUE,"right"),valueDetailStyle:c.get(14,c.BLUE)};this._model=App.ModelLocator.getProxy(App.ModelName.SETTINGS),this._container=new PIXI.DisplayObjectContainer,this._list=this._container.addChild(new App.List(App.Direction.Y)),this._weekDayOption=this._list.add(new b("calendar","Start Of Week",h)),this._baseCurrencyOption=this._list.add(new b("currencies","Base Currency",h)),this._defaultCurrencyOption=this._list.add(new b("currencies","Default Currency",h)),this._defaultAccountOption=this._list.add(new b("account","Default Account",h)),this._defaultCategoryOption=this._list.add(new b("folder-app","Default Category",h)),this._defaultSubCategoryOption=this._list.add(new b("subcategory-app","Default SubCategory",h)),this._defaultMethodOption=this._list.add(new b("credit-card","Default Payment",h),!0),this._deleteBackground=this._container.addChild(new PIXI.Sprite(d.GREY_60)),this._deleteButton=this._container.addChild(new App.PopUpButton("Delete All Transactions","Are you sure you want to\ndelete all transactions?",{width:g,height:Math.round(40*e),pixelRatio:e,popUpLayout:{x:Math.round(10*e),y:0,width:Math.round(g-20*e),height:Math.round(a.height/2),overlayWidth:f,overlayHeight:0}})),this._pane=this.addChild(new App.Pane(App.ScrollPolicy.OFF,App.ScrollPolicy.AUTO,f,a.contentHeight,e,!0)),this._pane.setContent(this._container),this._updateLayout(),this._clickThreshold=10*e},App.SettingScreen.prototype=Object.create(App.Screen.prototype),App.SettingScreen.prototype._updateLayout=function(){var a=Math.round(10*this._layout.pixelRatio);this._deleteBackground.y=this._list.y+this._list.boundingBox.height,this._deleteButton.setPosition(a,this._deleteBackground.y+a),this._pane.resize()},App.SettingScreen.prototype.update=function(){this._weekDayOption.setValue("Monday"),this._baseCurrencyOption.setValue(this._model.baseCurrency),this._defaultCurrencyOption.setValue(this._model.defaultCurrencyQuote),this._defaultAccountOption.setValue(this._model.defaultAccount.name),this._defaultCategoryOption.setValue(this._model.defaultCategory.name),this._defaultSubCategoryOption.setValue(this._model.defaultSubCategory.name),this._defaultMethodOption.setValue(this._model.defaultPaymentMethod.name),this._deleteButton.hidePopUp(!0),this._pane.resetScroll()},App.SettingScreen.prototype.hide=function(){this._unRegisterDeleteButtonListeners(),App.Screen.prototype.hide.call(this)},App.SettingScreen.prototype.enable=function(){App.Screen.prototype.enable.call(this),this._pane.enable()},App.SettingScreen.prototype.disable=function(){App.Screen.prototype.disable.call(this),this._pane.disable()},App.SettingScreen.prototype._registerDeleteButtonListeners=function(){var a=App.EventType;this._deleteButton.addEventListener(a.CANCEL,this,this._onDeleteCancel),this._deleteButton.addEventListener(a.CONFIRM,this,this._onDeleteConfirm),this._deleteButton.addEventListener(a.COMPLETE,this,this._onHidePopUpComplete)},App.SettingScreen.prototype._unRegisterDeleteButtonListeners=function(){var a=App.EventType;this._deleteButton.removeEventListener(a.CANCEL,this,this._onDeleteCancel),this._deleteButton.removeEventListener(a.CONFIRM,this,this._onDeleteConfirm),this._deleteButton.removeEventListener(a.COMPLETE,this,this._onHidePopUpComplete)},App.SettingScreen.prototype._onDeleteCancel=function(){this._deleteButton.hidePopUp(),App.ViewLocator.getViewSegment(App.ViewName.HEADER).enableActions()},App.SettingScreen.prototype._onDeleteConfirm=function(){},App.SettingScreen.prototype._onHidePopUpComplete=function(){this._unRegisterDeleteButtonListeners(),this.enable(),this._registerEventListeners(App.EventLevel.LEVEL_2)},App.SettingScreen.prototype._onClick=function(){this._pane.cancelScroll();var a=this.stage.getTouchData(),b=a.getLocalPosition(this._container).y;if(this._list.hitTest(b)){var c=this._list.getItemUnderPoint(a);c===this._weekDayOption?this._onAccountOptionClick():c===this._baseCurrencyOption?this._onCategoryOptionClick():c===this._defaultCurrencyOption?this._onTimeOptionClick():c===this._defaultAccountOption?this._onMethodOptionClick():c===this._defaultCategoryOption?this._onCurrencyOptionClick():c===this._defaultSubCategoryOption?this._onCurrencyOptionClick():c===this._defaultMethodOption&&this._onCurrencyOptionClick()}else this._deleteButton.hitTest(b)&&(this.disable(),this._unRegisterEventListeners(App.EventLevel.LEVEL_1),App.ViewLocator.getViewSegment(App.ViewName.HEADER).disableActions(),this._registerDeleteButtonListeners(),this._deleteButton.setPopUpLayout(0,this._container.y+this._layout.headerHeight,0,this._layout.contentHeight>this._container.height?this._layout.contentHeight:this._container.height),this._deleteButton.showPopUp())},App.SettingScreen.prototype._onAccountOptionClick=function(){},App.SettingScreen.prototype._onCategoryOptionClick=function(){},App.SettingScreen.prototype._onTimeOptionClick=function(){},App.SettingScreen.prototype._onMethodOptionClick=function(){},App.SettingScreen.prototype._onCurrencyOptionClick=function(){},App.SettingScreen.prototype._onHeaderClick=function(a){var b=App.HeaderAction,c=App.ModelLocator.getProxy(App.ModelName.CHANGE_SCREEN_DATA_POOL).allocate();a===b.ADD_TRANSACTION?App.Controller.dispatchEvent(App.EventType.CHANGE_TRANSACTION,{type:App.EventType.CREATE,nextCommand:new App.ChangeScreen,nextCommandData:c.update()}):a===b.MENU&&App.Controller.dispatchEvent(App.EventType.CHANGE_SCREEN,c.update(App.ScreenName.MENU,0,null,b.NONE,b.CANCEL,App.ScreenTitle.MENU))},App.SettingScreen.prototype._getChangeTransactionData=function(a,b,c,d,e,f){return{type:App.EventType.CHANGE,amount:this._transactionInput.getValue(),transactionType:this._typeToggle.isSelected()?App.TransactionType.INCOME:App.TransactionType.EXPENSE,pending:this._pendingToggle.isSelected(),repeat:this._repeatToggle.isSelected(),method:this._methodOption.getValue(),note:this._noteInput.getValue(),nextCommand:new App.ChangeScreen,nextCommandData:App.ModelLocator.getProxy(App.ModelName.CHANGE_SCREEN_DATA_POOL).allocate().update(a,b,c,d,e,f)}},App.ApplicationView=function(a,b,c,d,e){PIXI.DisplayObjectContainer.call(this);var f=App.ModelLocator,g=App.ModelName,h=App.ViewLocator,i=App.ViewName,j=f.getProxy(g.EVENT_LISTENER_POOL);this._renderer=b,this._stage=a,this._layout={originalWidth:c,originalHeight:d,width:Math.round(c*e),height:Math.round(d*e),headerHeight:Math.round(50*e),contentHeight:Math.round((d-50)*e),pixelRatio:e},this._eventDispatcher=new App.EventDispatcher(j),this._background=new PIXI.Graphics,this._backgroundPattern=new PIXI.TilingSprite(App.ViewLocator.getViewSegment(App.ViewName.SKIN).GREY_PATTERN,this._layout.width,this._layout.height),this._screenStack=h.addViewSegment(i.SCREEN_STACK,new App.ViewStack([new App.AccountScreen(this._layout),new App.CategoryScreen(this._layout),new App.SelectTimeScreen(this._layout),new App.EditCategoryScreen(this._layout),new App.TransactionScreen(this._layout),new App.ReportScreen(this._layout),new App.AddTransactionScreen(this._layout),new App.EditScreen(this._layout),new App.CurrencyPairScreen(this._layout),new App.EditCurrencyPairScreen(this._layout),new App.CurrencyScreen(this._layout),new App.SettingScreen(this._layout),new App.Menu(this._layout)],!1,j)),this._header=h.addViewSegment(i.HEADER,new App.Header(this._layout)),this._init(),this.addChild(this._background),this.addChild(this._backgroundPattern),this.addChild(this._screenStack),this.addChild(this._header)},App.ApplicationView.prototype=Object.create(PIXI.DisplayObjectContainer.prototype),App.ApplicationView.prototype._init=function(){App.GraphicUtils.drawRect(this._background,App.ColorTheme.GREY,1,0,0,this._layout.width,this._layout.height),this._backgroundPattern.alpha=.4,this.scrollTo(0),this._registerEventListeners(),this._screenStack.y=this._layout.headerHeight},App.ApplicationView.prototype._registerEventListeners=function(){var a=App.EventType;this._screenStack.addEventListener(a.CHANGE,this,this._onScreenChange),App.ModelLocator.getProxy(App.ModelName.TICKER).addEventListener(a.TICK,this,this._onTick)},App.ApplicationView.prototype._onScreenChange=function(){this._screenStack.show(),this._screenStack.hide()},App.ApplicationView.prototype.scrollTo=function(a){document.documentElement&&document.documentElement.scrollTop?document.documentElement.scrollTop=a:document.body.scrollTop=a},App.ApplicationView.prototype._onTick=function(){this._renderer.render(this._stage)},App.ApplicationView.prototype._onResize=function(){},App.ApplicationView.prototype.addEventListener=function(a,b,c){this._eventDispatcher.addEventListener(a,b,c)},App.ApplicationView.prototype.removeEventListener=function(a,b,c){this._eventDispatcher.removeEventListener(a,b,c)},App.Easing={linear:function(a){return a},inQuad:function(a){return a*a},outQuad:function(a){return-(a-=1)*a+1},inOutQuad:function(a){return(a/=.5)<1?.5*a*a:-.5*(--a*(a-2)-1)},inCubic:function(a){return a*a*a},outCubic:function(a){return--a*a*a+1},inOutCubic:function(a){return(a/=.5)<1?.5*a*a*a:.5*((a-=2)*a*a+2)},inExpo:function(a){return 0===a?0:Math.pow(2,10*(a-1))},outExpo:function(a){return 1===a?1:1-Math.pow(2,-10*a)},inOutExpo:function(a){return 0===a?0:1===a?1:(a/=.5)<1?.5*Math.pow(2,10*(a-1)):.5*(-Math.pow(2,-10*--a)+2)},inElastic:function(a){var b=1.70158,c=0,d=1;return 0===a?0:1===a?1:(c||(c=.3),b=c/(2*Math.PI)*Math.asin(1/d),-(d*Math.pow(2,10*(a-=1))*Math.sin(2*(a-b)*Math.PI/c)))},outElastic:function(a){var b=1.70158,c=0,d=1;return 0===a?0:1===a?1:(c||(c=.3),b=c/(2*Math.PI)*Math.asin(1/d),d*Math.pow(2,-10*a)*Math.sin(2*(a-b)*Math.PI/c)+1)},inOutElastic:function(a){var b=1.70158,c=0,d=1;return 0===a?0:2===(a/=.5)?1:(c||(c=.3*1.5),b=c/(2*Math.PI)*Math.asin(1/d),1>a?-.5*d*Math.pow(2,10*(a-=1))*Math.sin(2*(a-b)*Math.PI/c):d*Math.pow(2,-10*(a-=1))*Math.sin(2*(a-b)*Math.PI/c)*.5+1)}},App.TweenProxy=function(a,b,c,d){App.EventDispatcher.call(this,d),this.progress=c||0,this._interval=-1,this._running=!1,this._reversed=!1,this._start=-1,this._end=-1,this._reversedEnd=-1,this._now=-1,this._duration=1e3*a||1e3,this._ease=b||App.Easing.linear,this._timeStamp=window.performance&&window.performance.now?window.performance:Date,this._intervalReference=this._tweenInterval.bind(this)},App.TweenProxy.prototype=Object.create(App.EventDispatcher.prototype),App.TweenProxy.prototype.setEase=function(a){this._ease=a},App.TweenProxy.prototype.start=function(a,b){b&&this.setEase(b),this._running?a&&(this._reversed?this._reversed=!1:(this._reversed=!0,this._reversedEnd=this._start+2*(this._now-this._start))):(this._running=!0,this._reversed=!1,this._tween())},App.TweenProxy.prototype.stop=function(){this._running=!1,clearInterval(this._interval),this._interval=-1},App.TweenProxy.prototype.restart=function(){this._running&&this.stop(),this.start()},App.TweenProxy.prototype.isRunning=function(){return this._running},App.TweenProxy.prototype._tween=function(){this._interval>0&&(clearInterval(this._interval),this._interval=-1),this.progress=0,this._start=this._timeStamp.now(),this._end=this._start+this._duration,this._interval=setInterval(this._intervalReference,1e3/120)},App.TweenProxy.prototype._tweenInterval=function(){this._now=this._timeStamp.now();var a=this._reversed?this._reversedEnd:this._end,b=(this._duration-(a-this._now))/this._duration;0>b?b=0:b>1&&(b=1),this.progress=this._ease(b),this._now>=a&&(this.progress=1,this.stop(),this.dispatchEvent(App.EventType.COMPLETE))},App.TweenProxy.prototype.destroy=function(){App.EventDispatcher.prototype.destroy.call(this),this.stop(),this._intervalReference=null,this._timeStamp=null,this._ease=null},App.Ticker=function(a){App.EventDispatcher.call(this,a),this._rafListener=this._raf.bind(this),this._isRunning=!1},App.Ticker.prototype=Object.create(App.EventDispatcher.prototype),App.Ticker.prototype.addEventListener=function(a,b,c){App.EventDispatcher.prototype.addEventListener.call(this,a,b,c),this._isRunning||(this._isRunning=!0,window.requestAnimationFrame(this._rafListener))},App.Ticker.prototype.removeEventListener=function(a,b,c){App.EventDispatcher.prototype.removeEventListener.call(this,a,b,c),0===this._listeners.length&&(this._isRunning=!1)},App.Ticker.prototype.removeAllListeners=function(){App.EventDispatcher.prototype.removeAllListeners.call(this),this._isRunning=!1},App.Ticker.prototype._raf=function(){this._isRunning&&(window.requestAnimationFrame(this._rafListener),this.dispatchEvent(App.EventType.TICK))},App.Controller={_eventListenerPool:null,_eventCommandMap:{},_commands:[],init:function(a,b){this._eventListenerPool=a;for(var c=0,d=b.length;d>c;)this._eventCommandMap[b[c++]]={constructor:b[c++]}},_onCommandComplete:function(a){this._destroyCommand(a)},_destroyCommand:function(a){for(var b=0,c=this._commands.length,d=null;c>b;)if(d=this._commands[b++],d===a){d.removeEventListener(App.EventType.COMPLETE,this,this._onCommandComplete),d.destroy(),this._commands.splice(b,1);break}},dispatchEvent:function(a,b,c){var d=this._eventCommandMap[a].constructor;if(d){var e=null;if(c)for(var f=0,g=this._commands.length;g>f;)e=this._commands[f++],e instanceof d&&!e.allowMultipleInstances&&this._destroyCommand(e);e=new d(this._eventListenerPool),this._commands.push(e),e.addEventListener(App.EventType.COMPLETE,this,this._onCommandComplete),e.execute(b)}}},App.Command=function(a,b){App.EventDispatcher.call(this,b),this.allowMultipleInstances=a},App.Command.prototype=Object.create(App.EventDispatcher.prototype),App.Command.prototype.execute=function(){},App.Command.prototype.destroy=function(){App.EventDispatcher.prototype.destroy.call(this)},App.SequenceCommand=function(a,b){App.Command.call(this,a,b),this._nextCommand=null,this._nextCommandData=null},App.SequenceCommand.prototype=Object.create(App.Command.prototype),App.SequenceCommand.prototype._executeNextCommand=function(a){this._nextCommand.addEventListener(App.EventType.COMPLETE,this,this._onNextCommandComplete),this._nextCommand.execute(a)},App.SequenceCommand.prototype._onNextCommandComplete=function(){this._nextCommand.removeEventListener(App.EventType.COMPLETE,this,this._onNextCommandComplete),this.dispatchEvent(App.EventType.COMPLETE,this)},App.SequenceCommand.prototype.destroy=function(){App.Command.prototype.destroy.call(this),this._nextCommand&&(this._nextCommand.destroy(),this._nextCommand=null),this._nextCommandData=null},App.LoadData=function(a){App.Command.call(this,!1,a),this._jsonLoader=null,this._fontLoadingInterval=-1,this._fontInfoElement=null,this._icons=null},App.LoadData.prototype=Object.create(App.Command.prototype),App.LoadData.prototype.execute=function(){this._loadAssets()},App.LoadData.prototype._loadAssets=function(){this._jsonLoader=new PIXI.JsonLoader("./data/icons-big.json"),this._jsonLoader.on("loaded",function(){this._icons=this._jsonLoader.json.frames,this._jsonLoader.removeAllListeners("loaded"),this._jsonLoader=null,this._loadFont()}.bind(this)),this._jsonLoader.load()},App.LoadData.prototype._loadFont=function(){this._fontInfoElement=document.getElementById("fontInfo");var a=App.FontStyle,b=this._fontInfoElement.offsetWidth,c=0;this._fontLoadingInterval=setInterval(function(){this._fontInfoElement.offsetWidth!==b&&(c++,1===c?(b=this._fontInfoElement.offsetWidth,this._fontInfoElement.style.fontFamily=a.LIGHT_CONDENSED):2===c&&(clearInterval(this._fontLoadingInterval),document.body.removeChild(this._fontInfoElement),this._loadData()))}.bind(this),100),this._fontInfoElement.style.fontFamily=a.CONDENSED},App.LoadData.prototype._loadData=function(){var a=new XMLHttpRequest;a.open("GET","./data/data.json",!0),a.onload=function(){a.status>=200&&a.status<400?this.dispatchEvent(App.EventType.COMPLETE,{userData:a.responseText,icons:this._icons}):console.log("error")}.bind(this),a.onerror=function(){console.log("on error"),this.dispatchEvent(App.EventType.COMPLETE)},a.send()},App.LoadData.prototype.destroy=function(){App.Command.prototype.destroy.call(this),this._jsonLoader=null,clearInterval(this._fontLoadingInterval),this._fontInfoElement=null},App.Initialize=function(){this._eventListenerPool=new App.ObjectPool(App.EventListener,10),App.Command.call(this,!1,this._eventListenerPool),this._loadDataCommand=new App.LoadData(this._eventListenerPool)},App.Initialize.prototype=Object.create(App.Command.prototype),App.Initialize.prototype.execute=function(){this._loadDataCommand.addEventListener(App.EventType.COMPLETE,this,this._onLoadDataComplete),this._loadDataCommand.execute()},App.Initialize.prototype._onLoadDataComplete=function(a){var b=App.HeaderAction,c=new App.ObjectPool(App.ChangeScreenData,5);this._loadDataCommand.destroy(),this._loadDataCommand=null,this._initModel(a,c),this._initController(),this._initView(),App.Controller.dispatchEvent(App.EventType.CHANGE_SCREEN,c.allocate().update(App.ScreenName.MENU,0,null,b.NONE,b.CANCEL,App.ScreenTitle.MENU)),this.dispatchEvent(App.EventType.COMPLETE)},App.Initialize.prototype._initModel=function(a,b){var c=App.ModelName,d=App.Collection,e=App.PaymentMethod,f=JSON.parse(a.userData),g=new App.CurrencyPairCollection(f.currencyPairs,this._eventListenerPool);App.ModelLocator.init([c.EVENT_LISTENER_POOL,this._eventListenerPool,c.TICKER,new App.Ticker(this._eventListenerPool),c.ICONS,Object.keys(a.icons).filter(function(a){return-1===a.indexOf("-app")}),c.PAYMENT_METHODS,new d([e.CASH,e.CREDIT_CARD],e,null,this._eventListenerPool),c.CURRENCY_PAIRS,g,c.CURRENCY_SYMBOLS,new d(this._getCurrencySymbols(g),App.CurrencySymbol,null,this._eventListenerPool),c.SETTINGS,new App.Settings(f.settings),c.SUB_CATEGORIES,new d(f.subCategories,App.SubCategory,null,this._eventListenerPool),c.CATEGORIES,new d(f.categories,App.Category,null,this._eventListenerPool),c.ACCOUNTS,new d(f.accounts,App.Account,null,this._eventListenerPool),c.TRANSACTIONS,new d(f.transactions,App.Transaction,null,this._eventListenerPool),c.CHANGE_SCREEN_DATA_POOL,b,c.SCREEN_HISTORY,new App.Stack])},App.Initialize.prototype._getCurrencySymbols=function(a){for(var b=[],c=null,d=0,e=a.length();e>d;)c=a.getItemAt(d++),-1===b.indexOf(c.symbol)&&b.push(c.symbol),-1===b.indexOf(c.base)&&b.push(c.base);return b},App.Initialize.prototype._initController=function(){var a=App.EventType;App.Controller.init(this._eventListenerPool,[a.CHANGE_SCREEN,App.ChangeScreen,a.CHANGE_TRANSACTION,App.ChangeTransaction,a.CHANGE_ACCOUNT,App.ChangeAccount,a.CHANGE_CATEGORY,App.ChangeCategory,a.CHANGE_SUB_CATEGORY,App.ChangeSubCategory,a.CHANGE_CURRENCY_PAIR,App.ChangeCurrencyPair])},App.Initialize.prototype._initView=function(){var a=document.getElementsByTagName("canvas")[0],b=a.getContext("2d"),c=window.devicePixelRatio||1,d=b.webkitBackingStorePixelRatio||b.mozBackingStorePixelRatio||b.msBackingStorePixelRatio||b.oBackingStorePixelRatio||b.backingStorePixelRatio||1,e=c/d>2?2:c/d,f=window.innerWidth,g=window.innerHeight,h=new PIXI.Stage(16777215),i=new PIXI.CanvasRenderer(f,g,{view:a,resolution:1,transparent:!1,autoResize:!1,clearBeforeRender:!1}),j=App.ViewLocator,k=App.ViewName;e>1&&(a.style.width=f+"px",a.style.height=g+"px",a.width=a.width*e,a.height=a.height*e,b.scale(e,e),h.interactionManager.setPixelRatio(e)),PIXI.CanvasTinter.tintMethod=PIXI.CanvasTinter.tintWithOverlay,b.lineCap="square",this._initButtonPools(j,k,Math.round(f*e),e),j.addViewSegment(k.APPLICATION_VIEW,h.addChild(new App.ApplicationView(h,i,f,g,e)))},App.Initialize.prototype._initButtonPools=function(a,b,c,d){var e=App.ObjectPool,f=App.FontStyle.init(d),g=new App.Skin(c,d),h={width:c,height:Math.round(40*d),pixelRatio:d,whiteSkin:g.WHITE_40,greySkin:g.GREY_40,nameLabelStyle:f.get(14,f.BLUE),editLabelStyle:f.get(16,f.WHITE,null,f.LIGHT_CONDENSED),openOffset:Math.round(80*d)},i={width:c,height:Math.round(70*d),pixelRatio:d,skin:g.GREY_70,nameStyle:f.get(24,f.BLUE),detailStyle:f.get(12,f.GREY_DARKER,null,f.LIGHT_CONDENSED),editStyle:f.get(18,f.WHITE,null,f.LIGHT_CONDENSED),openOffset:Math.round(80*d)},j={labelStyles:{edit:f.get(18,f.WHITE,null,f.LIGHT_CONDENSED),accountIncome:f.get(14,f.BLUE_LIGHT,null,f.LIGHT_CONDENSED),amountIncome:f.get(26,f.BLUE),currencyIncome:f.get(16,f.BLUE_DARK,null,f.LIGHT_CONDENSED),date:f.get(14,f.GREY_DARK),pending:f.get(12,f.WHITE,null,f.LIGHT_CONDENSED),accountPending:f.get(14,f.RED_DARK),amountPending:f.get(26,f.WHITE),currencyPending:f.get(16,f.WHITE,null,f.LIGHT_CONDENSED),datePending:f.get(14,f.WHITE,"right",f.LIGHT_CONDENSED)},greySkin:g.GREY_70,redSkin:g.RED_70,width:c,height:Math.round(70*d),pixelRatio:d,openOffset:Math.round(120*d)};a.init([b.SKIN,g,b.ACCOUNT_BUTTON_POOL,new e(App.AccountButton,2,i),b.SUB_CATEGORY_BUTTON_POOL,new e(App.SubCategoryButton,5,h),b.TRANSACTION_BUTTON_POOL,new e(App.TransactionButton,4,j)])},App.Initialize.prototype.destroy=function(){App.Command.prototype.destroy.call(this),this._loadDataCommand&&(this._loadDataCommand.destroy(),this._loadDataCommand=null),this._eventListenerPool=null},App.ChangeScreen=function(){App.Command.call(this,!1,App.ModelLocator.getProxy(App.ModelName.EVENT_LISTENER_POOL))},App.ChangeScreen.prototype=Object.create(App.Command.prototype),App.ChangeScreen.prototype.execute=function(a){var b=App.ViewLocator,c=App.ViewName,d=App.ModelLocator,e=App.ModelName,f=d.getProxy(e.CHANGE_SCREEN_DATA_POOL),g=d.getProxy(e.SCREEN_HISTORY),h=b.getViewSegment(c.SCREEN_STACK),i=null;if(a.screenName===App.ScreenName.BACK){for(var j=a.updateBackScreen,k=0,l=a.backSteps;l>k;k++)f.release(g.pop());f.release(a),a=g.peek(),i=h.getChildByIndex(a.screenName),j&&i.update(a.updateData,a.screenMode)}else a.headerLeftAction!==App.HeaderAction.CANCEL&&a.headerRightAction!==App.HeaderAction.CANCEL&&a.screenMode!==App.ScreenMode.SELECT&&this._clearHistory(g,f),i=h.getChildByIndex(a.screenName),i.update(a.updateData,a.screenMode),g.push(a);
b.getViewSegment(c.HEADER).change(a.headerLeftAction,a.headerRightAction,a.headerName),h.selectChild(i),this.dispatchEvent(App.EventType.COMPLETE,this)},App.ChangeScreen.prototype._clearHistory=function(a,b){for(var c=a.pop();c;)b.release(c),c=a.pop();a.clear()},App.ChangeTransaction=function(a){App.SequenceCommand.call(this,!1,a)},App.ChangeTransaction.prototype=Object.create(App.SequenceCommand.prototype),App.ChangeTransaction.prototype.execute=function(a){var b=App.EventType,c=App.ModelLocator,d=App.ModelName,e=c.getProxy(d.SETTINGS),f=c.getProxy(d.TRANSACTIONS),g=f.getCurrent(),h=a.type;this._nextCommand=a.nextCommand,this._nextCommandData=a.nextCommandData,h===b.CREATE?(g=new App.Transaction,f.addItem(g),f.setCurrent(g),a.nextCommandData.updateData=g):h===b.COPY?(g=a.transaction.copy(),f.addItem(g),f.setCurrent(g),a.nextCommandData.updateData=g):h===b.CHANGE?(this._setInputs(g,a,!1),this._setToggles(g,a),this._setCategories(g,a,e),this._setTime(g,a),this._setMethod(g,a,e),this._setCurrency(g,a,e)):h===b.CONFIRM?(this._updateCategoryBalance(h,g,a,e),this._setToggles(g,a),this._setInputs(g,a,!0),this._setMethod(g,a,e),g.currencyBase=e.baseCurrency,g.save(),f.setCurrent(null)):h===b.CANCEL?g.isSaved()?(g.revokeState(),f.setCurrent(null)):f.removeItem(g).destroy():h===b.DELETE&&(this._updateCategoryBalance(h,g,a,e),f.removeItem(g).destroy(),a.nextCommandData.updateData=f.copySource().reverse()),this._nextCommand?this._executeNextCommand(this._nextCommandData):this.dispatchEvent(b.COMPLETE,this)},App.ChangeTransaction.prototype._setInputs=function(a,b,c){a.amount=isNaN(parseFloat(b.amount))?a.amount:parseFloat(b.amount),a.note=b.note||a.note,c&&!a.amount&&(a.amount="0")},App.ChangeTransaction.prototype._setToggles=function(a,b){a.type=b.transactionType||a.type,"boolean"==typeof b.pending&&(a.pending=b.pending),"boolean"==typeof b.repeat&&(a.repeat=b.repeat)},App.ChangeTransaction.prototype._setCategories=function(a,b,c){b.account&&b.category&&b.subCategory&&(a.account=b.account,a.category=b.category,a.subCategory=b.subCategory,c.defaultAccount=b.account,c.defaultCategory=b.category,c.defaultSubCategory=b.subCategory)},App.ChangeTransaction.prototype._setTime=function(a,b){var c=b.date,d=b.time;c&&d&&(a.date.setFullYear(c.getFullYear(),c.getMonth(),c.getDate()),d.length>0&&a.date.setHours(parseInt(d.split(":")[0],10),parseInt(d.split(":")[1],10)))},App.ChangeTransaction.prototype._setMethod=function(a,b,c){if(b.method){var d=App.ModelLocator.getProxy(App.ModelName.PAYMENT_METHODS).find("name",b.method);a.method=d,c.defaultPaymentMethod=d}},App.ChangeTransaction.prototype._setCurrency=function(a,b,c){b.currencyQuote&&(a.currencyQuote=b.currencyQuote,c.defaultCurrencyQuote=b.currencyQuote)},App.ChangeTransaction.prototype._updateCategoryBalance=function(a,b,c,d){var e=App.ModelLocator.getProxy(App.ModelName.CURRENCY_PAIRS);a===App.EventType.CONFIRM?(b.isSaved()&&!b.savedPending&&this._updateSavedBalance(b,e),c.pending||this._updateCurrentBalance(b,e,c,d)):a===App.EventType.DELETE&&this._updateSavedBalance(b,e)},App.ChangeTransaction.prototype._updateSavedBalance=function(a,b){var c=App.TransactionType,d=a.savedSubCategory,e=a.savedCurrencyRate?a.savedCurrencyRate:b.findRate(a.savedCurrencyBase,a.savedCurrencyQuote),f=a.savedAmount/e;a.savedType===c.EXPENSE?d.balance=d.balance+f:a.savedType===c.INCOME&&(d.balance=d.balance-f)},App.ChangeTransaction.prototype._updateCurrentBalance=function(a,b,c,d){var e=App.TransactionType,f=a.subCategory,g=parseFloat(c.amount)/b.findRate(d.baseCurrency,a.currencyQuote);isNaN(g)||(c.transactionType===e.EXPENSE?f.balance=f.balance-g:c.transactionType===e.INCOME&&(f.balance=f.balance+g))},App.ChangeCategory=function(a){App.SequenceCommand.call(this,!1,a||App.ModelLocator.getProxy(App.ModelName.EVENT_LISTENER_POOL))},App.ChangeCategory.prototype=Object.create(App.SequenceCommand.prototype),App.ChangeCategory.prototype.execute=function(a){var b=App.EventType,c=a.category,d=a.type;this._nextCommand=a.nextCommand,this._nextCommandData=a.nextCommandData,d===b.CREATE?(c=new App.Category,c.account=a.account.id,this._nextCommandData.updateData=c):d===b.CHANGE?(c.name=a.name||c.name,c.icon=a.icon||c.icon,c.color=a.color||c.color,c.budget=a.budget||c.budget,this._registerSubCategories(c)):d===b.CONFIRM?(c.name=a.name,c.icon=a.icon,c.color=a.color,c.budget=a.budget,this._registerSubCategories(c),this._registerCategory(c)):d===b.CANCEL?this._cancelChanges(c):d===b.DELETE&&this._deleteCategory(c),this._nextCommand?this._executeNextCommand(this._nextCommandData):this.dispatchEvent(b.COMPLETE,this)},App.ChangeCategory.prototype._registerCategory=function(a){var b=App.ModelLocator,c=App.ModelName,d=b.getProxy(c.CATEGORIES);-1===d.indexOf(a)&&(d.addItem(a),b.getProxy(c.ACCOUNTS).find("id",a.account).addCategory(a))},App.ChangeCategory.prototype._registerSubCategories=function(a){for(var b=App.ModelLocator,c=App.ModelName,d=b.getProxy(c.SUB_CATEGORIES),e=a.subCategories,f=null,g=0,h=e.length;h>g;)f=e[g++],-1===d.indexOf(f)&&d.addItem(f)},App.ChangeCategory.prototype._cancelChanges=function(a){var b=App.ModelLocator.getProxy(App.ModelName.SUB_CATEGORIES),c=a.subCategories,d=0,e=c.length;a.revokeState();for(var f=a.subCategories;e>d;d++)-1===f.indexOf(c[d])&&b.indexOf(c[d])>-1&&b.removeItem(c[d]);for(d=0,e=f.length;e>d;)f[d++].revokeState()},App.ChangeCategory.prototype._deleteCategory=function(a){{var b=App.ModelLocator,c=App.ModelName,d=(b.getProxy(c.SUB_CATEGORIES),a.subCategories);d.length}b.getProxy(c.ACCOUNTS).find("id",a.account).removeCategory(a),a.destroy()},App.ChangeSubCategory=function(a){App.SequenceCommand.call(this,!1,a)},App.ChangeSubCategory.prototype=Object.create(App.SequenceCommand.prototype),App.ChangeSubCategory.prototype.execute=function(a){var b=App.EventType,c=a.subCategory,d=a.type;this._nextCommand=a.nextCommand,this._nextCommandData=a.nextCommandData,d===b.CREATE?(c=new App.SubCategory,c.category=a.category.id,this._nextCommandData.updateData={subCategory:c,category:a.category}):d===b.CHANGE?(c.name=a.name,a.category.addSubCategory(c)):d===b.DELETE&&a.category.removeSubCategory(c),this._nextCommand?this._executeNextCommand(this._nextCommandData):this.dispatchEvent(b.COMPLETE,this)},App.ChangeAccount=function(a){App.SequenceCommand.call(this,!1,a)},App.ChangeAccount.prototype=Object.create(App.SequenceCommand.prototype),App.ChangeAccount.prototype.execute=function(a){var b=App.EventType,c=a.account,d=a.type;if(this._nextCommand=a.nextCommand,this._nextCommandData=a.nextCommandData,d===b.CREATE)c=new App.Account,this._nextCommandData.updateData=c;else if(d===b.CHANGE){if(c.name=a.name,c.lifeCycleState===App.LifeCycleState.CREATED){var e=App.ModelLocator.getProxy(App.ModelName.ACCOUNTS);-1===e.indexOf(c)&&e.addItem(c),c.lifeCycleState=App.LifeCycleState.ACTIVE}}else d===b.DELETE&&(c.lifeCycleState=App.LifeCycleState.DELETED);this._nextCommand?this._executeNextCommand(this._nextCommandData):this.dispatchEvent(b.COMPLETE,this)},App.ChangeCurrencyPair=function(a){App.SequenceCommand.call(this,!1,a)},App.ChangeCurrencyPair.prototype=Object.create(App.SequenceCommand.prototype),App.ChangeCurrencyPair.prototype.execute=function(a){this._nextCommand=a.nextCommand,this._nextCommandData=a.nextCommandData,a.currencyPair.rate=parseFloat(a.rate),this._nextCommand?this._executeNextCommand(this._nextCommandData):this.dispatchEvent(App.EventType.COMPLETE,this)},function(){function a(){b.destroy(),b=null}var b=new App.Initialize;b.addEventListener(App.EventType.COMPLETE,this,a),b.execute()}();